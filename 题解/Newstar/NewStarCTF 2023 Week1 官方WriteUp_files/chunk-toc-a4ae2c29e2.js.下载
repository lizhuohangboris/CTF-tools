(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1310:function(e,t){e.exports='<?xml version="1.0" encoding="utf-8"?> <svg version=1.1 id=图层_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space=preserve> <g id=Artboard> <polygon id=Triangle-3-Copy-13 style=fill:#a5a5a5 points="8,5.5 3,9 3,2 \t"/> </g> </svg> '},1311:function(e,t){e.exports='<?xml version="1.0" encoding="utf-8"?> <svg data-name="Layer 1" xmlns=http://www.w3.org/2000/svg viewBox="0 0 15.6 15.6"> <path d="M9.2 7.8l6.4-6.4L14.2 0 7.8 6.4 1.4 0 0 1.4l6.4 6.4L0 14.2l1.4 1.4 6.4-6.4 6.4 6.4 1.4-1.4z" fill=#a5a5a5> </path> </svg> '},1381:function(e,t,n){},1382:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locationParams=t.SearchParams=t.LocationParams=t.Params=void 0,t.Params={CollapseTOC:"collapse_toc"};class o{constructor(e){"function"==typeof URL?this.params=new URL(e).searchParams:this.params=new i(e)}get(e){return this.params.get(e)}get shouldCollapseTableOfContent(){return null!==this.get(t.Params.CollapseTOC)}}t.LocationParams=o;class i{constructor(e){const t=i.getSearch(e);this.params=i.getParams(t)}get(e){return void 0!==this.params.get(e)?this.params.get(e):null}static getSearch(e){const t=document.createElement("a");return t.href=e,t.search}static getParams(e){const t=new Map,n=e.substring(1);return""===n?t:n.split("&").reduce((e,t)=>{const[n,o]=t.split("="),s=i.getDecodeString(n),a=i.getDecodeString(o);return""!==s&&e.set(s,a),e},t)}static getDecodeString(e){return e&&0!==e.length?decodeURIComponent(e):""}}t.SearchParams=i,t.locationParams=new o(location.href)},1396:function(e,t,n){"use strict";n.r(t);var o=n(64),i=n.n(o),s=n(65),a=n.n(s),l=n(4),r=n.n(l),c=n(0),d=n.n(c),u=n(37),h=n(1303),p=n.n(h),f=n(1304),g=n.n(f),m=n(1278),v=n.n(m),y=n(1279),C=n.n(y),w=n(1280),k=n.n(w),x=n(1281),b=n.n(x),S=n(324),T=n.n(S),L=n(39),E=n(402),P=n(400),O=n.n(P),R=n(1395),N=n(97),H=n.n(N),I=n(1310),M=n.n(I);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,o=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return k()(this,n)}}var q=function(e){C()(n,e);var t=B(n);function n(){return i()(this,n),t.apply(this,arguments)}return a()(n,[{key:"shouldComponentUpdate",value:function(e){return JSON.stringify(this.props)!==JSON.stringify(e)}},{key:"handleClick",value:function(e,t){this.props.onClick(e,t)}},{key:"render",value:function(){var e=this,t=this.props.guid,n=T()(this.props.className,"toc-entry",this.props.type,"heading-".concat(this.props.level),"header-indent-".concat(this.props.indent),{hasChildren:this.props.hasChildren,collapsed:this.props.collapsed});return d.a.createElement("li",{className:n,"data-index":this.props.index,"data-guid":t,"data-offset":this.props.offset,onClick:function(){return e.handleClick(e.props.element,e.props.offset)}},this.props.hasChildren&&d.a.createElement("span",{className:"icon-collapsed",dangerouslySetInnerHTML:{__html:M.a},onClick:this.props.handleCollapsed}),d.a.createElement("div",{className:"dic-text"},this.props.text))}}]),n}(d.a.Component);q.propTypes={className:O.a.string,guid:O.a.string,onClick:O.a.func,type:O.a.string,level:O.a.number,hasChildren:O.a.bool,collapsed:O.a.bool,indent:O.a.number,index:O.a.number,element:O.a.instanceOf(HTMLElement),offset:O.a.number,handleCollapsed:O.a.func,text:O.a.string};var W=n(1311),_=n.n(W);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,o=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return k()(this,n)}}var A=function(e){C()(n,e);var t=U(n);function n(e){var o;i()(this,n),o=t.call(this,e);var s=e.expandOnMount;return o.editorRoot=document.querySelector(".ql-editor"),o.content=null,o.lines=[],o.state={currentHeader:{},currentParent:[],list:[],listClass:[],scrollTop:0,titleLength:0,collapsed:!s},o.debounceSyncScrolling=Object(L.debounce)(o.syncScrolling.bind(v()(o)),200),o.debounceUpdatePosition=Object(L.debounce)(function(){window.innerWidth<1144?o.toggleTitleCollapsed(!0):o.props.updatePosition(o.state.collapsed)},1e3/60),o.handleCollapsed=o.handleCollapsed.bind(v()(o)),o.handleTitleCollapsed=o.handleTitleCollapsed.bind(v()(o)),o}return a()(n,[{key:"componentDidMount",value:function(){this.ps=new E.default(this.content),this.props.expandOnMount?this.updateAndShow():this.update(),window.addEventListener("resize",this.debounceUpdatePosition),this.props.editorScrollingContainer.addEventListener("scroll",this.debounceSyncScrolling)}},{key:"componentWillUnmount",value:function(){this.ps.destroy(),window.removeEventListener("resize",this.debounceUpdatePosition),this.props.editorScrollingContainer.removeEventListener("scroll",this.debounceSyncScrolling)}},{key:"scrollToHeader",value:function(e){var t=this.content;if(!e.offset)return t.scrollTop=0,void this.ps.update();var n=document.getElementById("new-directory").querySelectorAll(".toc-entry")[this.state.list.indexOf(e)];if(n&&!n.classList.contains("hide")){var o=n.offsetTop,i=t.scrollTop,s=t.scrollTop+t.offsetHeight;o<i&&(t.scrollTop=o),o>=s-n.offsetHeight&&(t.scrollTop=o-t.offsetHeight+n.offsetHeight),this.ps.update()}}},{key:"getHeaderLines",value:function(){var e=this,t=this.editorRoot.querySelectorAll('.ql-heading-title, [data-header], [class*="ql-heading-"]'),n=[],o=g()(t).reduce(function(t,o){if(o.classList.contains("ql-heading-subtitle"))return t;if(o.textContent.trim()){n.push(o);var i={element:o,level:e.getLevel(o),offset:o.offsetTop,text:o.textContent,collapsed:!1,type:""};if(o.classList.contains("ordered-item")){var s=o.dataset.listContent;i.text=s+i.text}o.classList.contains("bullet-item")&&(i.type=o.parentElement.dataset.listStyle),t.push(i)}return t},[]);return this.lines=n,o}},{key:"getLevel",value:function(e){return e.classList.contains("ql-heading-title")?4:(e.dataset.header?t=e.dataset.header:"LI"===e.tagName&&(t=Number(e.className.match(/ql-heading-(\d)/)[1])),4-t);var t}},{key:"renderList",value:function(){var e,t=this;if(0===this.state.list.length)e=d.a.createElement("li",{className:"dir-not-found"},"添加标题后会在这里自动生成目录。");else{var n={};e=this.state.list.map(function(e,o,i){if(!e.text)return null;for(var s=e.level,a=!1,l=o-1;i[l]&&i[l].level<=s;)l--;i[l]&&(i[l].collapsed||n[l])&&(a=!0,n[o]=!0);var r=!!i[o+1]&&e.level>i[o+1].level,c=T()({currentHeader:t.state.currentHeader.offset===e.offset,currentParent:!!Object(L.find)(t.state.currentParent,["offset",e.offset]),hide:a});return d.a.createElement(q,p()({},e,{key:o,index:o,parentIndex:l,className:c,hasChildren:r,onClick:t.handleEntryClick,handleCollapsed:t.handleCollapsed}))})}var o=T.a.apply(void 0,["doc-directory-list"].concat(g()(this.state.listClass),[{"has-more-title":this.state.titleLength>1,"has-only-title":this.state.titleLength<=1}]));return d.a.createElement("ul",{className:o},e)}},{key:"syncScrolling",value:function(){for(var e=this.editorRoot.offsetTop,t=this.props.editorScrollingContainer.scrollTop-e,n=this.state.list,o=this.state.list.reduce(function(e,n){return e.offset>t?e:n.offset<=t?n:e},{offset:0}),i=[],s=n.indexOf(o)-1,a=o.level;n[s]&&a<4;){for(;n[s]&&n[s].level<=a;)s--;n[s]&&(a=n[s].level,i.push(n[s]))}this.setState({currentHeader:o,currentParent:i}),this.scrollToHeader(o)}},{key:"update",value:function(){var e=this.getHeaderLines(),t=0,n=e.reduce(function(e,n){var o="has-heading-"+n.level;return o.indexOf("4")>-1&&(t+=1),-1===e.indexOf(o)&&e.push(o),e},[]);return Object(L.isEqual)(this.state.list,e)||this.setState({list:e,listClass:n,titleLength:t}),e}},{key:"updateAndShow",value:function(){if(0!==this.update().length)return this.toggleTitleCollapsed(!1),!0}},{key:"handleEntryClick",value:function(e){H.a.emit(N.Events.BEFORE_TARGET,e),Object(u.target)(e),u.sa.track(4,"点击目录按钮")}},{key:"handleCollapsed",value:function(e){e.stopPropagation();var t=this.state.list,n=e.target.closest(".toc-entry"),o=n.getAttribute("data-index"),i=!n.classList.contains("collapsed");t[o].collapsed=i,this.setState({list:t}),i?u.sa.track(4,"点击目录项展开"):u.sa.track(4,"点击目录项折叠")}},{key:"toggleTitleCollapsed",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.state.collapsed;this.setState({collapsed:t},function(){e.props.updatePosition(e.state.collapsed),e.props.onToggle(t)})}},{key:"handleTitleCollapsed",value:function(){this.toggleTitleCollapsed()}},{key:"render",value:function(){var e=this;return d.a.createElement("div",{id:"new-directory",className:"table-of-content"},d.a.createElement(R.a,{title:"显示目录",placement:"right"},d.a.createElement("div",{className:"doc-directory-menu",onClick:this.handleTitleCollapsed},d.a.createElement("div",{className:"doc-directory-menu-line"}),d.a.createElement("div",{className:"doc-directory-menu-line"}),d.a.createElement("div",{className:"doc-directory-menu-line"}))),d.a.createElement("div",{className:"new-doc-directory"},d.a.createElement("div",{className:"doc-directory-title"},d.a.createElement("span",null,"目录"),d.a.createElement("span",{className:"doc-directory-close",dangerouslySetInnerHTML:{__html:_.a},onClick:this.handleTitleCollapsed})),d.a.createElement("div",{className:"doc-directory-content",ref:function(t){return e.content=t}},this.renderList())))}}]),n}(d.a.Component);A.propTypes={expandOnMount:O.a.bool,updatePosition:O.a.func,editorScrollingContainer:O.a.instanceOf(HTMLElement),onToggle:O.a.func};n(1381);var j=n(1382);n.d(t,"default",function(){return z});var z=function(){function e(){i()(this,e),this.updatePosition=this.updatePosition.bind(this),this.refresh=this.refresh.bind(this),this.onToggle=this.onToggle.bind(this),this.ref=null,this.editorScrollingContainer=document.getElementById("editor-scroller"),this.editorContainer=document.getElementById("editor"),this.render()}return a()(e,[{key:"render",value:function(){var e=this,t=!j.locationParams.shouldCollapseTableOfContent;this.root=document.createElement("div"),this.root.classList.add("ql-table-of-content"),this.onToggle(!t),this.editorContainer.append(this.root),this.updatePosition(!0),this.componentInstance=r.a.render(d.a.createElement(A,{plugin:this,updatePosition:this.updatePosition,editorScrollingContainer:this.editorScrollingContainer,onToggle:this.onToggle,expandOnMount:t,ref:function(t){return e.ref=t}}),this.root)}},{key:"isShow",get:function(){return!this.componentInstance.state.collapsed}},{key:"show",value:function(){this.componentInstance.toggleTitleCollapsed(!1),u.sa.track(4,"点击目录整体打开")}},{key:"hide",value:function(){this.componentInstance.toggleTitleCollapsed(!0),u.sa.track(4,"点击目录整体折叠")}},{key:"toggle",value:function(){this.isShow?this.hide():this.show()}},{key:"destroy",value:function(){this.root.innerHTML=""}},{key:"updatePosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.root,n=this.editorScrollingContainer.getBoundingClientRect().top,o=this.editorContainer.offsetLeft;t.style.top="".concat(n,"px"),t.style.height=window.innerWidth<1280?"calc(100% - ".concat(n+this.scrollbarHeight,"px)"):"calc(100% - ".concat(n,"px)"),this.patchSpaceRight(),window.innerWidth>1460?(t.style.width="315px",t.style.left=null,t.style.marginLeft="-315px",t.style.background=null):window.innerWidth>1280?(t.style.width="".concat(o,"px"),t.style.left=0,t.style.marginLeft="auto",t.style.background=null):(t.style.width="".concat(o-6,"px"),this.patchSpaceRight(6),t.style.left=0,t.style.marginLeft="auto",!0===e?(t.style.background="initial",t.style.zIndex=""):(t.style.background="#F7F7F7",t.style.zIndex=100))}},{key:"patchSpaceRight",value:function(e){if(this.ref&&this.ref.content){var t=this.ref.content;t.style.paddingRight=e?"".concat(parseFloat(window.getComputedStyle(t).paddingRight)-e,"px"):""}}},{key:"scrollbarWidth",get:function(){return window.outerWidth-window.innerWidth||this.editorScrollingContainer.offsetWidth-this.editorScrollingContainer.scrollWidth}},{key:"scrollbarHeight",get:function(){var e=this.editorScrollingContainer.getBoundingClientRect().bottom;return window.innerHeight-e}},{key:"refresh",value:function(){this.componentInstance&&this.componentInstance.update()}},{key:"onToggle",value:function(e){this.root.classList.toggle("close",e)}}]),e}()}}]);