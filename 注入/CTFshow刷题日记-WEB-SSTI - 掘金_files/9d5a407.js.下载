(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{1092:function(e,t,o){},1440:function(e,t,o){e.exports=o.p+"b9d0c7badde6e5569e2390ee4a8cbd24.svg"},1441:function(e,t,o){e.exports=o.p+"c12d6646efb2245fa4e88f0e1a9565b7.svg"},1442:function(e,t,o){e.exports=o.p+"336af4d1fafabcca3b770c8ad7a50781.svg"},1443:function(e,t,o){e.exports=o.p+"e371749f308e0d99430a6a4943eef946.svg"},1444:function(e,t,o){e.exports=o.p+"3d482c7a948bac826e155953b2a28a9e.svg"},1445:function(e,t,o){"use strict";o(1092)},1994:function(e,t,o){"use strict";o.r(t);o(18),o(16),o(13),o(6),o(15);var n=o(0),c=(o(19),o(5)),l=o(3),r=o(56),d=o(7),v=o(245),_=o(29),f=o(1175),y=o(104),m=o(884),h=o(904),w=o(167),O=o(23),C=o(313),T=o(4),j=o(885),P=o(53),k=o(868),R=o(187),S=o(964);function E(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}function F(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?E(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):E(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var x=Object(l.b)({components:{CollectPopupList:f.a,Icon:r.Icon,Tooltip:r.Tooltip},inject:["getRecommendScoreInfo","getFromPage"],props:{entry:{type:Object},fromPage:{type:String,default:""}},emits:["clickComment"],setup:function(e,t){var o,n=t.root,r=Object(l.l)(!0),d=Object(l.r)(),v=Object(l.l)(!1),f=Object(h.a)().dynamicDataReady,y=Object(l.a)((function(){return d.state.view.column.author})),w=Object(l.a)((function(){var e,t,o;return(null===(t=null===(e=d.state.auth)||void 0===e?void 0:e.user)||void 0===t?void 0:t.id)?null===(o=d.state.auth)||void 0===o?void 0:o.user:void 0})),T=Object(l.l)(!0),j=n.$getBean("eventBus");j.on(j.eventType.HEADER_NAV_VISIBILITY_CHANGE,(function(e){r.value=Boolean(e)}));var P=Object(m.a)({itemType:O.c.UserType,teaFollowType:k.b.other}),R=P.doFollow,E=P.traceFollowShow,F=Object(S.a)({getIsFollow:function(){return y.value.followed},getUid:function(){return y.value.id},getRecommendCurUserReq:function(){var t,o,n;return{item_id:null===(t=e.entry)||void 0===t?void 0:t.id,item_type:_.g.IdType.ArticleIdType,category_id:null===(n=null===(o=e.entry)||void 0===o?void 0:o.category)||void 0===n?void 0:n.category_id,author_id:y.value.id}},teaGuideType:4}),x=F.isUserFollowPopupShow,U=F.followContentVisible,I=F.closeUserFollowPopup,A=F.FOLLOW_USER_TIP_TEXT;Object(l.s)(x,(function(e){e&&(r.value=e,d.dispatch(C.c,4))}));var D,$=Object(l.a)((function(){var e;return!!w.value&&!(!y.value.id||y.value.id!==(null===(e=w.value)||void 0===e?void 0:e.id))})),L=Object(l.a)((function(){var t,o;return(null===(o=null===(t=e.entry)||void 0===t?void 0:t.author_user_info)||void 0===o?void 0:o.avatar_large)||""}));return Object(l.h)((function(){U(!0)})),Object(l.i)((function(){o&&window.clearTimeout(o)})),{closeUserFollowPopup:I,isUserFollowPopupShow:x,FOLLOW_USER_TIP_TEXT:A,onFollowBtnShow:function(e){e&&E()},author:y,visible:r,avatarUrl:L,isMe:$,isOpenButtonVisible:T,clickFollow:(D=Object(c.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y.value.followed){e.next=2;break}return e.abrupt("return");case 2:return v.value=!0,o&&window.clearTimeout(o),o=window.setTimeout((function(){v.value=!1}),3e3),e.next=7,R(y.value.id,O.c.UserType);case 7:(null==(t=e.sent)?void 0:t.isSuccess)&&d.dispatch(C.b);case 9:case"end":return e.stop()}}),e)}))),function(){return D.apply(this,arguments)}),clickUser:function(){window.open("/user/".concat(y.value.id),"_blank")},userAction:v,dynamicDataReady:f}},data:function(){return{likeLock:Object(j.a)(),isCollectPopupVisible:!1}},computed:{collectText:function(){return"".concat(this.entry.collected?"已":"","收藏")},currentUser:function(){var e;return(null===(e=this.$store.state.auth)||void 0===e?void 0:e.user)||{}}},methods:{togglePraise:function(){var e=this;this.likeLock.do((function(){return e.$ensureAuthorized({loginGuideFrom:y.b.like_login}).then((function(){return e.$ensureBindPhone({bindLabel:w.b.interact})})).then((function(){var t,o,n,c,l,r,d,v,_,f,y;e.$TEA("item_like_click",F(F({event_page:P.a.articleDetail,req_id:null===(t=e.entry)||void 0===t?void 0:t.req_id,boost_type:null===(n=null===(o=e.entry)||void 0===o?void 0:o.extra)||void 0===n?void 0:n.boost_type,category_id:null===(l=null===(c=e.entry)||void 0===c?void 0:c.category)||void 0===l?void 0:l.category_id,from_page:Object(P.b)(e.fromPage),from_page_type:Object(P.c)(),item_id:null===(r=e.entry)||void 0===r?void 0:r.article_id,item_type:2,item_author_id:null===(v=null===(d=e.entry)||void 0===d?void 0:d.author_user_info)||void 0===v?void 0:v.user_id,from_item_id:null===(_=e.entry)||void 0===_?void 0:_.article_id,from_item_type:2,action:(null===(f=e.entry)||void 0===f?void 0:f.liked)?1:2},Object(R.c)(e.entry)),null===(y=e.getRecommendScoreInfo)||void 0===y?void 0:y.call(e)))})).then((function(){return e.$store.dispatch(T.TOGGLE_LIKE_ENTRY,e.entry).catch((function(t){e.$error("操作失败, 请稍后重试"),console.error(t)}))})).catch((function(e){console.error(e)}))}))},linkToMobileCollection:function(){var e,t,o,n,c,l,_=this,f=null===(e=this.entry)||void 0===e?void 0:e.article_id;this.$TEA("collection_click",F({item_id:f,category_id:null===(o=null===(t=this.entry)||void 0===t?void 0:t.category)||void 0===o?void 0:o.category_id,item_author_id:null===(c=null===(n=this.entry)||void 0===n?void 0:n.author_user_info)||void 0===c?void 0:c.user_id,enter_from:"bottom_bar"},null===(l=this.getRecommendScoreInfo)||void 0===l?void 0:l.call(this))),this.$ensureAuthorized({loginGuideFrom:y.b.collect_login}).then((function(){var e,t;if(_.entry.collected){var o=F({item_id:_.entry.article_id,category_id:_.entry.category_id,item_author_id:_.entry.author_user_id,from_page:Object(P.b)(_.fromPage),collection_list_ids:"",action:"0"},null===(e=_.getRecommendScoreInfo)||void 0===e?void 0:e.call(_));return _.$TEA("collection_list_save",o),void v.c.DeleteArticleFromCollection({article_id:f}).then((function(e){(null==e?void 0:e.err_no)===d.ERROR_NO.OK&&(r.Message.success("取消收藏"),_.handleCollect(!1))}))}if(_.currentUser.is_collect_fast){var n=F({item_id:_.entry.article_id,category_id:_.entry.category_id,item_author_id:_.entry.author_user_id,collection_list_ids:"",action:"1",from_page:Object(P.b)(_.fromPage)},null===(t=_.getRecommendScoreInfo)||void 0===t?void 0:t.call(_));return _.$TEA("collection_list_save",n),_.collectPopoverVisible=!0,void v.c.AddArticleToCollection({article_id:f,is_collect_fast:!0}).then((function(e){(null==e?void 0:e.err_no)===d.ERROR_NO.OK&&(_.handleCollect(!0),r.Message.success("收藏成功"))})).catch((function(e){r.Message.error(null==e?void 0:e.message)}))}_.isCollectPopupVisible=!_.isCollectPopupVisible})).catch((function(e){console.log(e)}))},handleCollect:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$store.commit("view/column/UPDATE_STATE",{entry:F(F({},this.entry),{},{collected:e})})},onCollectSuccess:function(e,t){var o=this;this.isCollectPopupVisible=!1,this.handleCollect(!0),t.map((function(e){var t,n=F({item_id:o.entry.article_id,category_id:o.entry.category_id,item_author_id:o.entry.author_user_id,collection_list_ids:e,action:"1",from_page:Object(P.b)(o.fromPage)},null===(t=o.getRecommendScoreInfo)||void 0===t?void 0:t.call(o));o.$TEA("collection_list_save",n)}))}}}),U=(o(1445),o(28)),component=Object(U.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"action-box-wrap",class:{hidden:!e.visible}},[n("div",{staticClass:"action-box"},[n("div",{staticClass:"action-left"},[n("div",{staticClass:"action",class:{active:e.entry.liked},on:{click:e.togglePraise}},[n("div",{staticClass:"action-title-box"},[e.dynamicDataReady&&e.entry.liked?[n("img",{attrs:{src:o(1440)}})]:[n("img",{attrs:{src:o(1441)}})],e._v(" "),n("span",{staticClass:"action-title"},[e.dynamicDataReady?[e.entry.likedCount?n("span",[e._v("\n                "+e._s(e._f("formatTenThousand")(e.entry.likedCount))+"\n              ")]):n("span",[e._v("点赞")])]:e._e()],2)],2)]),e._v(" "),n("div",{staticClass:"action",on:{click:function(t){return e.$emit("clickComment")}}},[n("div",{staticClass:"action-title-box"},[n("img",{attrs:{src:o(1442)}}),e._v(" "),n("span",{staticClass:"action-title"},[e.dynamicDataReady?[e.entry.commentsCount?[e._v("\n                "+e._s(e._f("formatTenThousand")(e.entry.commentsCount))+"\n              ")]:[e._v("评论")]]:e._e()],2)])]),e._v(" "),n("div",{staticClass:"action",on:{click:e.linkToMobileCollection}},[n("div",{staticClass:"action-title-box"},[e.dynamicDataReady&&e.entry.collected?n("img",{attrs:{src:o(1443)}}):n("img",{attrs:{src:o(1444)}}),e._v(" "),n("span",{staticClass:"action-title"},[e._v("\n            "+e._s(e.dynamicDataReady?e.collectText:"")+"\n          ")])])])]),e._v(" "),n("div",{staticClass:"split"}),e._v(" "),n("div",{staticClass:"action-user"},[n("client-only",[n("Tooltip",{attrs:{placement:"top",theme:"dark","z-index":100,content:"","append-to-body":!1},scopedSlots:e._u([{key:"content",fn:function(){return[n("span",[e._v(e._s(e.FOLLOW_USER_TIP_TEXT))]),e._v(" "),n("Icon",{staticStyle:{cursor:"pointer",color:"var(--juejin-font-3)","margin-left":"10px"},attrs:{type:"close"},on:{click:e.closeUserFollowPopup}})]},proxy:!0}]),model:{value:e.isUserFollowPopupShow,callback:function(t){e.isUserFollowPopupShow=t},expression:"isUserFollowPopupShow"}},[e._v(" "),n("Avatar",{staticClass:"action-user-avatar",attrs:{url:e.avatarUrl,size:32},nativeOn:{click:function(t){return t.stopPropagation(),e.clickUser(t)}}},[e.isMe?e._e():n("div",{staticClass:"follow-area",class:{"user-action":e.userAction},on:{click:function(t){return t.stopPropagation(),e.clickFollow(t)}}},[e.author.followed?n("div",{staticClass:"follow-success"},[n("Icon",{attrs:{type:"check"}})],1):n("div",{directives:[{name:"visible-change",rawName:"v-visible-change.once",value:e.onFollowBtnShow,expression:"onFollowBtnShow",modifiers:{once:!0}}],staticClass:"follow-text"},[e._v("\n                关注\n              ")])])])],1)],1)],1),e._v(" "),n("CollectPopupList",{attrs:{visible:e.isCollectPopupVisible,"article-id":e.entry&&e.entry.article_id||"","is-edit":e.entry.collected},on:{close:function(t){e.isCollectPopupVisible=!1},success:e.onCollectSuccess}})],1)])}),[],!1,null,"935cc2c6",null);t.default=component.exports}}]);
//# sourceMappingURL=9d5a407.js.map